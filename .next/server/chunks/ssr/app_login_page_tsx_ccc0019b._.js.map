{"version":3,"sources":["../../../../app/login/page.tsx"],"sourcesContent":["'use client'\n\nimport { useState } from 'react'\nimport { useRouter } from 'next/navigation'\nimport Link from 'next/link'\n\nconst DEMO_ACCOUNTS = [\n  { email: 'admin@demo.com', password: 'demo123', label: 'Admin' },\n  { email: 'manager@demo.com', password: 'demo123', label: 'IT Manager' },\n  { email: 'agent@demo.com', password: 'demo123', label: 'Agent' },\n  { email: 'user@demo.com', password: 'demo123', label: 'End User' },\n]\n\nexport default function LoginPage() {\n  const router = useRouter()\n  const [email, setEmail] = useState('')\n  const [password, setPassword] = useState('')\n  const [error, setError] = useState('')\n  const [loading, setLoading] = useState(false)\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault()\n    setError('')\n    setLoading(true)\n\n    try {\n      const response = await fetch('/api/v1/auth/login', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({ email, password }),\n      })\n\n      let data\n      try {\n        data = await response.json()\n      } catch (parseError) {\n        setError('Invalid response from server')\n        setLoading(false)\n        return\n      }\n\n      if (!response.ok || !data.success) {\n        setError(data.error?.message || `Login failed: ${response.statusText || 'Unknown error'}`)\n        setLoading(false)\n        return\n      }\n\n      // Validate response structure\n      if (!data.data?.accessToken || !data.data?.refreshToken || !data.data?.user) {\n        setError('Invalid response structure from server')\n        setLoading(false)\n        return\n      }\n\n      // Store tokens\n      try {\n        localStorage.setItem('accessToken', data.data.accessToken)\n        localStorage.setItem('refreshToken', data.data.refreshToken)\n        localStorage.setItem('user', JSON.stringify(data.data.user))\n      } catch (storageError) {\n        setError('Failed to save login credentials')\n        setLoading(false)\n        return\n      }\n\n      // Reset loading state before redirect\n      setLoading(false)\n      \n      // Use window.location for full page reload to ensure middleware doesn't block\n      window.location.href = '/dashboard'\n    } catch (err: any) {\n      console.error('Login error:', err)\n      setError(err.message || 'An unexpected error occurred. Please try again.')\n      setLoading(false)\n    }\n  }\n\n  const handleDemoAccount = (demoEmail: string, demoPassword: string) => {\n    setEmail(demoEmail)\n    setPassword(demoPassword)\n  }\n\n  return (\n    <div style={{ minHeight: '100vh', display: 'flex', alignItems: 'center', justifyContent: 'center', padding: '1rem' }}>\n      <div className=\"card\" style={{ width: '100%', maxWidth: '400px' }}>\n        <h1 style={{ fontSize: '2rem', fontWeight: 'bold', marginBottom: '0.5rem', textAlign: 'center' }}>\n          ITSM Helpdesk\n        </h1>\n        <p style={{ textAlign: 'center', color: 'var(--text-secondary)', marginBottom: '2rem' }}>\n          Sign in to your account\n        </p>\n\n        {error && (\n          <div style={{\n            padding: '0.75rem',\n            backgroundColor: 'rgba(239, 68, 68, 0.1)',\n            border: '1px solid var(--error)',\n            borderRadius: '0.5rem',\n            marginBottom: '1rem',\n            color: 'var(--error)',\n          }}>\n            {error}\n          </div>\n        )}\n\n        <form onSubmit={handleSubmit}>\n          <div style={{ marginBottom: '1rem' }}>\n            <label className=\"label\" htmlFor=\"email\">\n              Email\n            </label>\n            <input\n              id=\"email\"\n              type=\"email\"\n              className=\"input\"\n              value={email}\n              onChange={(e) => setEmail(e.target.value)}\n              required\n              disabled={loading}\n            />\n          </div>\n\n          <div style={{ marginBottom: '1.5rem' }}>\n            <label className=\"label\" htmlFor=\"password\">\n              Password\n            </label>\n            <input\n              id=\"password\"\n              type=\"password\"\n              className=\"input\"\n              value={password}\n              onChange={(e) => setPassword(e.target.value)}\n              required\n              disabled={loading}\n            />\n          </div>\n\n          <button\n            type=\"submit\"\n            className=\"btn btn-primary\"\n            style={{ width: '100%', marginBottom: '1rem' }}\n            disabled={loading}\n          >\n            {loading ? 'Signing in...' : 'Sign in'}\n          </button>\n        </form>\n\n        <div style={{ marginTop: '1.5rem', marginBottom: '1rem' }}>\n          <p style={{ textAlign: 'center', color: 'var(--text-secondary)', fontSize: '0.875rem', marginBottom: '0.75rem' }}>\n            Demo Accounts (Click to auto-fill):\n          </p>\n          <div style={{ display: 'flex', flexDirection: 'column', gap: '0.5rem' }}>\n            {DEMO_ACCOUNTS.map((account) => (\n              <button\n                key={account.email}\n                type=\"button\"\n                className=\"btn btn-secondary\"\n                onClick={() => handleDemoAccount(account.email, account.password)}\n                style={{ fontSize: '0.875rem', padding: '0.5rem 1rem' }}\n              >\n                {account.label}\n              </button>\n            ))}\n          </div>\n        </div>\n\n        <div style={{ textAlign: 'center', marginTop: '1.5rem' }}>\n          <Link href=\"/register\" style={{ color: 'var(--accent-primary)', fontSize: '0.875rem' }}>\n            Don't have an account? Sign up\n          </Link>\n        </div>\n\n        <div style={{ textAlign: 'center', marginTop: '0.5rem' }}>\n          <Link href=\"/reset-password\" style={{ color: 'var(--text-secondary)', fontSize: '0.875rem' }}>\n            Forgot password?\n          </Link>\n        </div>\n      </div>\n    </div>\n  )\n}\n\n"],"names":[],"mappings":"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"}