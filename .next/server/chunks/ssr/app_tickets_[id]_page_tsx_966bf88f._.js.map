{"version":3,"sources":["../../../../app/tickets/%5Bid%5D/page.tsx"],"sourcesContent":["'use client'\n\nimport { useEffect, useState } from 'react'\nimport { useParams } from 'next/navigation'\n\ninterface Ticket {\n  id: string\n  ticketNumber: string\n  subject: string\n  description: string\n  status: string\n  priority: string\n  createdAt: string\n  requester: {\n    id: string\n    email: string\n    firstName: string | null\n    lastName: string | null\n  } | null\n  requesterEmail?: string | null\n  requesterName?: string | null\n  assignee: {\n    id: string\n    email: string\n    firstName: string | null\n    lastName: string | null\n  } | null\n  tenant?: {\n    id: string\n    name: string\n    slug: string\n  } | null\n  category?: string | null\n  customFields?: Record<string, any> | null\n  escalatedToRoleId?: string | null\n  escalatedToSystemRole?: string | null\n  escalatedAt?: string | null\n  escalatedBy?: string | null\n  escalationNote?: string | null\n  escalatedByUser?: {\n    id: string\n    email: string\n    firstName: string | null\n    lastName: string | null\n  } | null\n  escalatedToCustomRole?: {\n    id: string\n    name: string\n    displayName: string\n  } | null\n  comments: Array<{\n    id: string\n    body: string\n    createdAt: string\n    author: { \n      id: string\n      email: string\n      firstName: string | null\n      lastName: string | null\n    }\n  }>\n}\n\ninterface EscalationRole {\n  type: 'system' | 'custom'\n  id: string\n  name: string\n  displayName: string\n}\n\nexport default function TicketDetailPage() {\n  const params = useParams()\n  const ticketId = params?.id as string\n\n  const [ticket, setTicket] = useState<Ticket | null>(null)\n  const [loading, setLoading] = useState(true)\n  const [error, setError] = useState('')\n  const [comment, setComment] = useState('')\n  const [saving, setSaving] = useState(false)\n  const [updatingStatus, setUpdatingStatus] = useState(false)\n  const [user, setUser] = useState<any>(null)\n  const [showEscalationModal, setShowEscalationModal] = useState(false)\n  const [availableRoles, setAvailableRoles] = useState<EscalationRole[]>([])\n  const [loadingRoles, setLoadingRoles] = useState(false)\n  const [escalationData, setEscalationData] = useState({\n    escalatedToRoleId: '',\n    escalatedToSystemRole: '',\n    escalationNote: '',\n  })\n  const [escalating, setEscalating] = useState(false)\n\n  useEffect(() => {\n    const storedUser = localStorage.getItem('user')\n    if (storedUser) {\n      try {\n        setUser(JSON.parse(storedUser))\n      } catch (e) {\n        // Invalid user data\n      }\n    }\n  }, [])\n\n  useEffect(() => {\n    const fetchTicket = async () => {\n      try {\n        const token = localStorage.getItem('accessToken')\n        const res = await fetch(`/api/v1/tickets/${ticketId}`, {\n          headers: token ? { Authorization: `Bearer ${token}` } : {},\n        })\n        const data = await res.json()\n        if (!data.success) {\n          setError('Failed to load ticket')\n          return\n        }\n        setTicket(data.data)\n      } catch (err) {\n        setError('Failed to load ticket')\n      } finally {\n        setLoading(false)\n      }\n    }\n    if (ticketId) fetchTicket()\n  }, [ticketId])\n\n  const submitComment = async () => {\n    if (!comment.trim()) return\n    setSaving(true)\n    setError('')\n    try {\n      const token = localStorage.getItem('accessToken')\n      const res = await fetch(`/api/v1/tickets/${ticketId}`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          ...(token ? { Authorization: `Bearer ${token}` } : {}),\n        },\n        body: JSON.stringify({ body: comment }),\n      })\n      const data = await res.json()\n      if (!data.success) {\n        setError(data.error?.message || 'Failed to add comment')\n        setSaving(false)\n        return\n      }\n      setTicket((prev) =>\n        prev\n          ? { ...prev, comments: [...prev.comments, { ...data.data, author: data.data.author }] }\n          : prev\n      )\n      setComment('')\n    } catch (err) {\n      setError('Failed to add comment')\n    } finally {\n      setSaving(false)\n    }\n  }\n\n  const updateStatus = async (newStatus: string) => {\n    setUpdatingStatus(true)\n    setError('')\n    try {\n      const token = localStorage.getItem('accessToken')\n      const res = await fetch(`/api/v1/tickets/${ticketId}`, {\n        method: 'PATCH',\n        headers: {\n          'Content-Type': 'application/json',\n          ...(token ? { Authorization: `Bearer ${token}` } : {}),\n        },\n        body: JSON.stringify({ status: newStatus }),\n      })\n      const data = await res.json()\n      if (!data.success) {\n        setError(data.error?.message || 'Failed to update status')\n        setUpdatingStatus(false)\n        return\n      }\n      setTicket((prev) => (prev ? { ...prev, status: data.data.status } : null))\n    } catch (err) {\n      setError('Failed to update status')\n    } finally {\n      setUpdatingStatus(false)\n    }\n  }\n\n  const isAgentOrManager = user?.roles?.some((r: string) => \n    ['AGENT', 'IT_MANAGER', 'ADMIN'].includes(r) || r.startsWith('CUSTOM:')\n  )\n\n  const canEscalate = isAgentOrManager\n\n  const loadAvailableRoles = async () => {\n    setLoadingRoles(true)\n    try {\n      const token = localStorage.getItem('accessToken')\n      const res = await fetch(`/api/v1/tickets/${ticketId}/escalate`, {\n        headers: token ? { Authorization: `Bearer ${token}` } : {},\n      })\n      const data = await res.json()\n      if (data.success) {\n        setAvailableRoles(data.data.availableRoles)\n      }\n    } catch (err) {\n      console.error('Failed to load escalation roles:', err)\n    } finally {\n      setLoadingRoles(false)\n    }\n  }\n\n  const handleEscalate = async () => {\n    if (!escalationData.escalatedToRoleId && !escalationData.escalatedToSystemRole) {\n      setError('Please select a role to escalate to')\n      return\n    }\n\n    setEscalating(true)\n    setError('')\n    try {\n      const token = localStorage.getItem('accessToken')\n      const res = await fetch(`/api/v1/tickets/${ticketId}/escalate`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          ...(token ? { Authorization: `Bearer ${token}` } : {}),\n        },\n        body: JSON.stringify({\n          escalatedToRoleId: escalationData.escalatedToRoleId || undefined,\n          escalatedToSystemRole: escalationData.escalatedToSystemRole || undefined,\n          escalationNote: escalationData.escalationNote || undefined,\n        }),\n      })\n      const data = await res.json()\n      if (!data.success) {\n        setError(data.error?.message || 'Failed to escalate ticket')\n        setEscalating(false)\n        return\n      }\n      // Refresh ticket data\n      const ticketRes = await fetch(`/api/v1/tickets/${ticketId}`, {\n        headers: token ? { Authorization: `Bearer ${token}` } : {},\n      })\n      const ticketData = await ticketRes.json()\n      if (ticketData.success) {\n        setTicket(ticketData.data)\n      }\n      setShowEscalationModal(false)\n      setEscalationData({ escalatedToRoleId: '', escalatedToSystemRole: '', escalationNote: '' })\n    } catch (err) {\n      setError('Failed to escalate ticket')\n    } finally {\n      setEscalating(false)\n    }\n  }\n\n  useEffect(() => {\n    if (showEscalationModal && canEscalate) {\n      loadAvailableRoles()\n    }\n  }, [showEscalationModal, canEscalate])\n\n  if (loading) return <div className=\"container\" style={{ padding: '2rem' }}>Loading ticket...</div>\n  if (error) return <div className=\"container\" style={{ padding: '2rem', color: 'var(--error)' }}>{error}</div>\n  if (!ticket) return null\n\n  const statusOptions = ['NEW', 'IN_PROGRESS', 'RESOLVED', 'CLOSED']\n\n  return (\n    <div className=\"container\" style={{ padding: '2rem', display: 'grid', gap: '1.5rem' }}>\n      <div className=\"card\">\n        <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '0.5rem' }}>\n          <span style={{ fontWeight: 600 }}>{ticket.ticketNumber}</span>\n          <span style={{ color: 'var(--text-secondary)' }}>{new Date(ticket.createdAt).toLocaleString()}</span>\n        </div>\n        <h1 style={{ marginBottom: '0.5rem' }}>{ticket.subject}</h1>\n        <p style={{ color: 'var(--text-secondary)', marginBottom: '0.75rem' }}>{ticket.description}</p>\n        \n        {/* Submitter Information */}\n        <div style={{ \n          padding: '1rem', \n          backgroundColor: 'var(--bg-tertiary)', \n          borderRadius: '8px', \n          marginBottom: '1rem' \n        }}>\n          <h3 style={{ marginBottom: '0.5rem', fontSize: '0.875rem', fontWeight: 600 }}>Submitted By</h3>\n          <div style={{ display: 'grid', gap: '0.25rem', fontSize: '0.875rem' }}>\n            <div>\n              <strong>Name:</strong> {ticket.requester\n                ? (ticket.requester.firstName && ticket.requester.lastName\n                    ? `${ticket.requester.firstName} ${ticket.requester.lastName}`\n                    : 'Not provided')\n                : (ticket.requesterName || 'Not provided')}\n            </div>\n            <div>\n              <strong>Email:</strong> {ticket.requester?.email || ticket.requesterEmail || 'Not provided'}\n            </div>\n            {ticket.tenant && (\n              <div>\n                <strong>Tenant:</strong> {ticket.tenant.name}\n              </div>\n            )}\n            {ticket.category && (\n              <div>\n                <strong>Category:</strong> {ticket.category}\n              </div>\n            )}\n          </div>\n        </div>\n\n        {/* Escalation Information */}\n        {ticket.escalatedAt && (\n          <div style={{\n            padding: '1rem',\n            backgroundColor: 'rgba(251, 191, 36, 0.1)',\n            border: '1px solid rgba(251, 191, 36, 0.3)',\n            borderRadius: '8px',\n            marginBottom: '1rem',\n          }}>\n            <h3 style={{ marginBottom: '0.5rem', fontSize: '0.875rem', fontWeight: 600, color: 'var(--warning)' }}>\n              âš  Escalated\n            </h3>\n            <div style={{ display: 'grid', gap: '0.25rem', fontSize: '0.875rem' }}>\n              <div>\n                <strong>Escalated to:</strong>{' '}\n                {ticket.escalatedToCustomRole\n                  ? ticket.escalatedToCustomRole.displayName\n                  : ticket.escalatedToSystemRole?.replace('_', ' ') || 'Unknown'}\n              </div>\n              {ticket.escalatedByUser && (\n                <div>\n                  <strong>Escalated by:</strong>{' '}\n                  {ticket.escalatedByUser.firstName && ticket.escalatedByUser.lastName\n                    ? `${ticket.escalatedByUser.firstName} ${ticket.escalatedByUser.lastName}`\n                    : ticket.escalatedByUser.email}\n                </div>\n              )}\n              <div>\n                <strong>Escalated at:</strong> {new Date(ticket.escalatedAt).toLocaleString()}\n              </div>\n              {ticket.escalationNote && (\n                <div>\n                  <strong>Note:</strong> {ticket.escalationNote}\n                </div>\n              )}\n            </div>\n          </div>\n        )}\n\n        {/* Status and Priority */}\n        <div style={{ display: 'flex', gap: '1rem', alignItems: 'center', flexWrap: 'wrap' }}>\n          <div style={{ display: 'flex', gap: '0.5rem', alignItems: 'center' }}>\n            <strong>Status:</strong>\n            {isAgentOrManager ? (\n              <select\n                value={ticket.status}\n                onChange={(e) => updateStatus(e.target.value)}\n                disabled={updatingStatus}\n                style={{\n                  padding: '0.5rem',\n                  borderRadius: '4px',\n                  border: '1px solid var(--border-color)',\n                  backgroundColor: 'var(--bg-primary)',\n                  color: 'var(--text-primary)',\n                  cursor: updatingStatus ? 'not-allowed' : 'pointer',\n                }}\n              >\n                {statusOptions.map((status) => (\n                  <option key={status} value={status}>\n                    {status.replace('_', ' ')}\n                  </option>\n                ))}\n              </select>\n            ) : (\n              <span style={{ color: 'var(--text-secondary)' }}>\n                {ticket.status.replace('_', ' ')}\n              </span>\n            )}\n          </div>\n          <div>\n            <strong>Priority:</strong> <span style={{ color: 'var(--text-secondary)' }}>{ticket.priority}</span>\n          </div>\n          {ticket.assignee && (\n            <div>\n              <strong>Assigned to:</strong>{' '}\n              <span style={{ color: 'var(--text-secondary)' }}>\n                {ticket.assignee.firstName && ticket.assignee.lastName\n                  ? `${ticket.assignee.firstName} ${ticket.assignee.lastName}`\n                  : ticket.assignee.email}\n              </span>\n            </div>\n          )}\n          {canEscalate && !ticket.escalatedAt && (\n            <button\n              onClick={() => setShowEscalationModal(true)}\n              style={{\n                padding: '0.5rem 1rem',\n                backgroundColor: 'rgba(251, 191, 36, 0.1)',\n                color: 'var(--warning)',\n                border: '1px solid rgba(251, 191, 36, 0.3)',\n                borderRadius: '6px',\n                cursor: 'pointer',\n                fontSize: '0.875rem',\n                fontWeight: 600,\n              }}\n            >\n              Escalate Ticket\n            </button>\n          )}\n        </div>\n        {error && <p style={{ color: 'var(--error)', marginTop: '0.5rem' }}>{error}</p>}\n      </div>\n\n      <div className=\"card\">\n        <h3 style={{ marginBottom: '0.75rem' }}>Comments</h3>\n        <div style={{ display: 'grid', gap: '0.5rem', marginBottom: '1rem' }}>\n          {ticket.comments.length === 0 && <p style={{ color: 'var(--text-secondary)' }}>No comments yet.</p>}\n          {ticket.comments.map((c) => (\n            <div key={c.id} style={{ border: '1px solid var(--border-color)', borderRadius: '0.5rem', padding: '0.75rem' }}>\n              <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '0.25rem' }}>\n                <span style={{ fontWeight: 500 }}>{c.author?.email ?? 'Unknown'}</span>\n                <span style={{ color: 'var(--text-tertiary)', fontSize: '0.85rem' }}>\n                  {new Date(c.createdAt).toLocaleString()}\n                </span>\n              </div>\n              <p>{c.body}</p>\n            </div>\n          ))}\n        </div>\n\n        <div style={{ display: 'grid', gap: '0.5rem' }}>\n          <textarea\n            className=\"input\"\n            rows={3}\n            placeholder=\"Add a comment\"\n            value={comment}\n            onChange={(e) => setComment(e.target.value)}\n            disabled={saving}\n          />\n          <button className=\"btn btn-primary\" onClick={submitComment} disabled={saving}>\n            {saving ? 'Adding...' : 'Add Comment'}\n          </button>\n          {error && <p style={{ color: 'var(--error)' }}>{error}</p>}\n        </div>\n      </div>\n\n      {/* Escalation Modal */}\n      {showEscalationModal && (\n        <div\n          style={{\n            position: 'fixed',\n            top: 0,\n            left: 0,\n            right: 0,\n            bottom: 0,\n            backgroundColor: 'rgba(0, 0, 0, 0.5)',\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center',\n            zIndex: 1000,\n          }}\n          onClick={() => !escalating && setShowEscalationModal(false)}\n        >\n          <div\n            style={{\n              backgroundColor: 'var(--bg-primary)',\n              borderRadius: '8px',\n              padding: '2rem',\n              maxWidth: '500px',\n              width: '90%',\n              maxHeight: '90vh',\n              overflowY: 'auto',\n            }}\n            onClick={(e) => e.stopPropagation()}\n          >\n            <h2 style={{ marginTop: 0, marginBottom: '1.5rem' }}>Escalate Ticket</h2>\n            <div style={{ display: 'grid', gap: '1rem' }}>\n              <div>\n                <label style={{ display: 'block', marginBottom: '0.5rem', fontWeight: 500 }}>\n                  Escalate to Role <span style={{ color: 'var(--error)' }}>*</span>\n                </label>\n                {loadingRoles ? (\n                  <p style={{ color: 'var(--text-secondary)' }}>Loading roles...</p>\n                ) : (\n                  <select\n                    className=\"input\"\n                    value={escalationData.escalatedToSystemRole || escalationData.escalatedToRoleId}\n                    onChange={(e) => {\n                      const selectedRole = availableRoles.find(r => \n                        (r.type === 'system' ? r.id : r.id) === e.target.value\n                      )\n                      if (selectedRole) {\n                        if (selectedRole.type === 'system') {\n                          setEscalationData({\n                            ...escalationData,\n                            escalatedToSystemRole: selectedRole.id,\n                            escalatedToRoleId: '',\n                          })\n                        } else {\n                          setEscalationData({\n                            ...escalationData,\n                            escalatedToRoleId: selectedRole.id,\n                            escalatedToSystemRole: '',\n                          })\n                        }\n                      }\n                    }}\n                    required\n                    disabled={escalating}\n                  >\n                    <option value=\"\">Select a role...</option>\n                    {availableRoles.map((role) => (\n                      <option key={`${role.type}-${role.id}`} value={role.id}>\n                        {role.displayName} {role.type === 'custom' ? '(Custom)' : ''}\n                      </option>\n                    ))}\n                  </select>\n                )}\n              </div>\n\n              <div>\n                <label style={{ display: 'block', marginBottom: '0.5rem', fontWeight: 500 }}>\n                  Escalation Note (Optional)\n                </label>\n                <textarea\n                  className=\"input\"\n                  rows={3}\n                  placeholder=\"Add a note about why this ticket is being escalated...\"\n                  value={escalationData.escalationNote}\n                  onChange={(e) => setEscalationData({ ...escalationData, escalationNote: e.target.value })}\n                  disabled={escalating}\n                />\n              </div>\n\n              <div style={{ display: 'flex', gap: '1rem', justifyContent: 'flex-end', marginTop: '1rem' }}>\n                <button\n                  type=\"button\"\n                  onClick={() => setShowEscalationModal(false)}\n                  disabled={escalating}\n                  style={{\n                    padding: '0.75rem 1.5rem',\n                    backgroundColor: 'var(--bg-secondary)',\n                    border: '1px solid var(--border-color)',\n                    borderRadius: '6px',\n                    cursor: escalating ? 'not-allowed' : 'pointer',\n                    fontSize: '0.875rem',\n                  }}\n                >\n                  Cancel\n                </button>\n                <button\n                  type=\"button\"\n                  className=\"btn btn-primary\"\n                  onClick={handleEscalate}\n                  disabled={escalating || (!escalationData.escalatedToRoleId && !escalationData.escalatedToSystemRole)}\n                  style={{\n                    backgroundColor: escalating ? 'var(--text-secondary)' : 'var(--warning)',\n                  }}\n                >\n                  {escalating ? 'Escalating...' : 'Escalate Ticket'}\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  )\n}\n\n"],"names":[],"mappings":"wDAEA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OAmEe,SAAS,IACtB,IAAM,EAAS,CAAA,EAAA,EAAA,SAAA,AAAS,IAClB,EAAW,GAAQ,GAEnB,CAAC,EAAQ,EAAU,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAgB,MAC9C,CAAC,EAAS,EAAW,CAAG,CAAA,EAAA,EAAA,QAAQ,AAAR,GAAS,GACjC,CAAC,EAAO,EAAS,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IAC7B,CAAC,EAAS,EAAW,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IACjC,CAAC,EAAQ,EAAU,CAAG,CAAA,EAAA,EAAA,QAAQ,AAAR,GAAS,GAC/B,CAAC,EAAgB,EAAkB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GAC/C,CAAC,EAAM,EAAQ,CAAG,CAAA,EAAA,EAAA,QAAQ,AAAR,EAAc,MAChC,CAAC,EAAqB,EAAuB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GACzD,CAAC,EAAgB,EAAkB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAmB,EAAE,EACnE,CAAC,EAAc,EAAgB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GAC3C,CAAC,EAAgB,EAAkB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,CACnD,kBAAmB,GACnB,sBAAuB,GACvB,eAAgB,EAClB,GACM,CAAC,EAAY,EAAc,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GAE7C,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KACR,IAAM,EAAa,aAAa,OAAO,CAAC,QACxC,GAAI,EACF,GAAI,CACF,EAAQ,IAFI,CAEC,KAAK,CAAC,GACrB,CAAE,MAAO,EAAG,CAEZ,CAEJ,EAAG,EAAE,EAEL,CAAA,EAAA,EAAA,SAAS,AAAT,EAAU,KACR,IAAM,EAAc,UAClB,GAAI,CACF,IAAM,EAAQ,aAAa,OAAO,CAAC,eAC7B,EAAM,MAAM,MAAM,CAAC,gBAAgB,EAAE,EAAA,CAAU,CAAE,CACrD,QAAS,EAAQ,CAAE,cAAe,CAAC,OAAO,EAAE,EAAA,CAAO,AAAC,EAAI,CAAC,CAC3D,GACM,EAAO,MAAM,EAAI,IAAI,GAC3B,GAAI,CAAC,EAAK,OAAO,CAAE,YACjB,EAAS,yBAGX,EAAU,EAAK,IAAI,CACrB,CAAE,MAAO,EAAK,CACZ,EAAS,wBACX,QAAU,CACR,GAAW,EACb,CACF,EACI,GAAU,GAChB,EAAG,CAAC,EAAS,EAEb,IAAM,EAAgB,UACpB,GAAK,CAAD,CAAS,IAAI,IAAI,AACrB,GAAU,GACV,EAAS,IACT,GAAI,CACF,IAAM,EAAQ,aAAa,OAAO,CAAC,eAC7B,EAAM,MAAM,MAAM,CAAC,gBAAgB,EAAE,EAAA,CAAU,CAAE,CACrD,OAAQ,OACR,QAAS,CACP,eAAgB,mBAChB,GAAI,EAAQ,CAAE,cAAe,CAAC,OAAO,EAAE,EAAA,CAAO,AAAC,EAAI,CAAC,CAAC,AACvD,EACA,KAAM,KAAK,SAAS,CAAC,CAAE,KAAM,CAAQ,EACvC,GACM,EAAO,MAAM,EAAI,IAAI,GAC3B,GAAI,CAAC,EAAK,OAAO,CAAE,CACjB,EAAS,EAAK,KAAK,EAAE,SAAW,yBAChC,GAAU,GACV,MACF,CACA,EAAU,AAAC,GACT,EACI,CAAE,GAAG,CAAI,CAAE,SAAU,IAAI,EAAK,QAAQ,CAAE,CAAE,GAAG,EAAK,IAAI,CAAE,OAAQ,EAAK,IAAI,CAAC,MAAO,AAAD,EAAG,AAAC,EACpF,GAEN,EAAW,GACb,CAAE,MAAO,EAAK,CACZ,EAAS,wBACX,QAAU,CACR,GAAU,EACZ,EACF,EAEM,EAAe,MAAO,IAC1B,GAAkB,GAClB,EAAS,IACT,GAAI,CACF,IAAM,EAAQ,aAAa,OAAO,CAAC,eAC7B,EAAM,MAAM,MAAM,CAAC,gBAAgB,EAAE,EAAA,CAAU,CAAE,CACrD,OAAQ,QACR,QAAS,CACP,eAAgB,mBAChB,GAAI,EAAQ,CAAE,cAAe,CAAC,OAAO,EAAE,EAAA,CAAO,AAAC,EAAI,CAAC,CAAC,AACvD,EACA,KAAM,KAAK,SAAS,CAAC,CAAE,OAAQ,CAAU,EAC3C,GACM,EAAO,MAAM,EAAI,IAAI,GAC3B,GAAI,CAAC,EAAK,OAAO,CAAE,CACjB,EAAS,EAAK,KAAK,EAAE,SAAW,2BAChC,GAAkB,GAClB,MACF,CACA,EAAU,AAAC,GAAU,EAAO,CAAE,GAAG,CAAI,CAAE,OAAQ,EAAK,IAAI,CAAC,MAAM,AAAC,EAAI,KACtE,CAAE,MAAO,EAAK,CACZ,EAAS,0BACX,QAAU,CACR,GAAkB,EACpB,CACF,EAEM,EAAmB,GAAM,OAAO,KAAK,AAAC,GAC1C,CAAC,QAAS,aAAc,QAAQ,CAAC,QAAQ,CAAC,IAAM,EAAE,UAAU,CAAC,YAKzD,EAAqB,UACzB,GAAgB,GAChB,GAAI,CACF,IAAM,EAAQ,aAAa,OAAO,CAAC,eAC7B,EAAM,MAAM,MAAM,CAAC,gBAAgB,EAAE,EAAS,SAAS,CAAC,CAAE,CAC9D,QAAS,EAAQ,CAAE,cAAe,CAAC,OAAO,EAAE,EAAA,CAAO,AAAC,EAAI,CAAC,CAC3D,GACM,EAAO,MAAM,EAAI,IAAI,EACvB,GAAK,OAAO,EAAE,AAChB,EAAkB,EAAK,IAAI,CAAC,cAAc,CAE9C,CAAE,MAAO,EAAK,CACZ,QAAQ,KAAK,CAAC,mCAAoC,EACpD,QAAU,CACR,GAAgB,EAClB,CACF,EAEM,EAAiB,UACrB,GAAI,CAAC,EAAe,iBAAiB,EAAI,CAAC,EAAe,qBAAqB,CAAE,YAC9E,EAAS,uCAIX,GAAc,GACd,EAAS,IACT,GAAI,CACF,IAAM,EAAQ,aAAa,OAAO,CAAC,eAC7B,EAAM,MAAM,MAAM,CAAC,gBAAgB,EAAE,EAAS,SAAS,CAAC,CAAE,CAC9D,OAAQ,OACR,QAAS,CACP,eAAgB,mBAChB,GAAI,EAAQ,CAAE,cAAe,CAAC,OAAO,EAAE,EAAA,CAAO,AAAC,EAAI,CAAC,CAAC,AACvD,EACA,KAAM,KAAK,SAAS,CAAC,CACnB,kBAAmB,EAAe,iBAAiB,OAAI,EACvD,sBAAuB,EAAe,qBAAqB,OAAI,EAC/D,eAAgB,EAAe,cAAc,OAAI,CACnD,EACF,GACM,EAAO,MAAM,EAAI,IAAI,GAC3B,GAAI,CAAC,EAAK,OAAO,CAAE,CACjB,EAAS,EAAK,KAAK,EAAE,SAAW,6BAChC,GAAc,GACd,MACF,CAEA,IAAM,EAAY,MAAM,MAAM,CAAC,gBAAgB,EAAE,EAAA,CAAU,CAAE,CAC3D,QAAS,EAAQ,CAAE,cAAe,CAAC,OAAO,EAAE,EAAA,CAAO,AAAC,EAAI,CAAC,CAC3D,GACM,EAAa,MAAM,EAAU,IAAI,GACnC,EAAW,OAAO,EAAE,AACtB,EAAU,EAAW,IAAI,EAE3B,GAAuB,GACvB,EAAkB,CAAE,kBAAmB,GAAI,sBAAuB,GAAI,eAAgB,EAAG,EAC3F,CAAE,MAAO,EAAK,CACZ,EAAS,4BACX,QAAU,CACR,GAAc,EAChB,CACF,QAQA,CANA,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KACJ,MACF,GAEJ,EAAG,CAAC,IAAiC,EAEjC,GAAgB,CAAA,CALS,CAKT,EAAA,CAAP,EAAO,EAAC,KALqB,CAKrB,CAAI,UAAU,YAAY,MAAO,CAAE,QAAS,MAAO,WAAG,sBACvE,EAAc,CAAA,EAAA,EAAP,AAAO,GAAA,EAAC,MAAA,CAAI,UAAU,YAAY,MAAO,CAAE,QAAS,OAAQ,MAAO,cAAe,WAAI,IAC5F,EAKH,CAAA,EAAA,EAAA,CALW,GAKX,EAAC,MAAA,CAAI,UAAU,YAAY,MAAO,CAAE,QAAS,OAAQ,QAAS,OAAQ,IAAK,QAAS,YAClF,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,iBACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,MAAO,CAAE,QAAS,OAAQ,eAAgB,gBAAiB,aAAc,QAAS,YACrF,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,MAAO,CAAE,WAAY,GAAI,WAAI,EAAO,YAAY,GACtD,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,MAAO,CAAE,MAAO,uBAAwB,WAAI,IAAI,KAAK,EAAO,SAAS,EAAE,cAAc,QAE7F,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,MAAO,CAAE,aAAc,QAAS,WAAI,EAAO,OAAO,GACtD,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,MAAO,CAAE,MAAO,wBAAyB,aAAc,SAAU,WAAI,EAAO,WAAW,GAG1F,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,MAAO,CACV,QAAS,OACT,gBAAiB,qBACjB,aAAc,MACd,aAAc,MAChB,YACE,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,MAAO,CAAE,aAAc,SAAU,SAAU,WAAY,WAAY,GAAI,WAAG,iBAC9E,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,MAAO,CAAE,QAAS,OAAQ,IAAK,UAAW,SAAU,UAAW,YAClE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,UAAO,UAAc,IAAE,EAAO,SAAS,CACnC,EAAO,SAAS,CAAC,SAAS,EAAI,EAAO,SAAS,CAAC,QAAQ,CACpD,CAAA,EAAG,EAAO,SAAS,CAAC,SAAS,CAAC,CAAC,EAAE,EAAO,SAAS,CAAC,QAAQ,CAAA,CAAE,CAC5D,eACH,EAAO,aAAa,EAAI,kBAE/B,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,UAAO,WAAe,IAAE,EAAO,SAAS,EAAE,OAAS,EAAO,cAAc,EAAI,kBAE9E,EAAO,MAAM,EACZ,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,UAAO,YAAgB,IAAE,EAAO,MAAM,CAAC,IAAI,IAG/C,EAAO,QAAQ,EACd,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,UAAO,cAAkB,IAAE,EAAO,QAAQ,UAOlD,EAAO,WAAW,EACjB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,MAAO,CACV,QAAS,OACT,gBAAiB,0BACjB,OAAQ,oCACR,aAAc,MACd,aAAc,MAChB,YACE,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,MAAO,CAAE,aAAc,SAAU,SAAU,WAAY,WAAY,IAAK,MAAO,gBAAiB,WAAG,gBAGvG,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,MAAO,CAAE,QAAS,OAAQ,IAAK,UAAW,SAAU,UAAW,YAClE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,UAAO,kBAAuB,IAC9B,EAAO,qBAAqB,CACzB,EAAO,qBAAqB,CAAC,WAAW,CACxC,EAAO,qBAAqB,EAAE,QAAQ,IAAK,MAAQ,aAExD,EAAO,eAAe,EACrB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,UAAO,kBAAuB,IAC9B,EAAO,eAAe,CAAC,SAAS,EAAI,EAAO,eAAe,CAAC,QAAQ,CAChE,CAAA,EAAG,EAAO,eAAe,CAAC,SAAS,CAAC,CAAC,EAAE,EAAO,eAAe,CAAC,QAAQ,CAAA,CAAE,CACxE,EAAO,eAAe,CAAC,KAAK,IAGpC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,UAAO,kBAAsB,IAAE,IAAI,KAAK,EAAO,WAAW,EAAE,cAAc,MAE5E,EAAO,cAAc,EACpB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,UAAO,UAAc,IAAE,EAAO,cAAc,UAQvD,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,MAAO,CAAE,QAAS,OAAQ,IAAK,OAAQ,WAAY,SAAU,SAAU,MAAO,YACjF,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,MAAO,CAAE,QAAS,OAAQ,IAAK,SAAU,WAAY,QAAS,YACjE,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,UAAO,YACP,EACC,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,MAAO,EAAO,MAAM,CACpB,SAAU,AAAC,GAAM,EAAa,EAAE,MAAM,CAAC,KAAK,EAC5C,SAAU,EACV,MAAO,CACL,QAAS,SACT,aAAc,MACd,OAAQ,gCACR,gBAAiB,oBACjB,MAAO,sBACP,OAAQ,EAAiB,cAAgB,SAC3C,WAnGQ,AAqGP,CArGQ,MAAO,cAAe,WAAY,SAAS,CAqGrC,GAAG,CAAE,AAAD,GACjB,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAoB,MAAO,WACzB,EAAO,OAAO,CAAC,IAAK,MADV,MAMjB,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,MAAO,CAAE,MAAO,uBAAwB,WAC3C,EAAO,MAAM,CAAC,OAAO,CAAC,IAAK,UAIlC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,UAAO,cAAkB,IAAC,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,MAAO,CAAE,MAAO,uBAAwB,WAAI,EAAO,QAAQ,MAE7F,EAAO,QAAQ,EACd,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,UAAO,iBAAsB,IAC9B,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,MAAO,CAAE,MAAO,uBAAwB,WAC3C,EAAO,QAAQ,CAAC,SAAS,EAAI,EAAO,QAAQ,CAAC,QAAQ,CAClD,CAAA,EAAG,EAAO,QAAQ,CAAC,SAAS,CAAC,CAAC,EAAE,EAAO,QAAQ,CAAC,QAAQ,CAAA,CAAE,CAC1D,EAAO,QAAQ,CAAC,KAAK,MAI9B,AAzMW,GAyMI,CAAC,EAAO,WAAW,EACjC,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,QAAS,IAAM,GAAuB,GACtC,MAAO,CACL,QAAS,cACT,gBAAiB,0BACjB,MAAO,iBACP,OAAQ,oCACR,aAAc,MACd,OAAQ,UACR,SAAU,WACV,WAAY,GACd,WACD,uBAKJ,GAAS,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,MAAO,CAAE,MAAO,eAAgB,UAAW,QAAS,WAAI,OAGvE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,iBACb,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,MAAO,CAAE,aAAc,SAAU,WAAG,aACxC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,MAAO,CAAE,QAAS,OAAQ,IAAK,SAAU,aAAc,MAAO,YACrC,IAA3B,EAAO,QAAQ,CAAC,MAAM,EAAU,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,MAAO,CAAE,MAAO,uBAAwB,WAAG,qBAC9E,EAAO,QAAQ,CAAC,GAAG,CAAC,AAAC,GACpB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAe,MAAO,CAAE,OAAQ,gCAAiC,aAAc,SAAU,QAAS,SAAU,YAC3G,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,MAAO,CAAE,QAAS,OAAQ,eAAgB,gBAAiB,aAAc,SAAU,YACtF,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,MAAO,CAAE,WAAY,GAAI,WAAI,EAAE,MAAM,EAAE,OAAS,YACtD,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,MAAO,CAAE,MAAO,uBAAwB,SAAU,SAAU,WAC/D,IAAI,KAAK,EAAE,SAAS,EAAE,cAAc,QAGzC,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,UAAG,EAAE,IAAI,KAPF,EAAE,EAAE,MAYlB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,MAAO,CAAE,QAAS,OAAQ,IAAK,QAAS,YAC3C,CAAA,EAAA,EAAA,GAAA,EAAC,WAAA,CACC,UAAU,QACV,KAAM,EACN,YAAY,gBACZ,MAAO,EACP,SAAU,AAAC,GAAM,EAAW,EAAE,MAAM,CAAC,KAAK,EAC1C,SAAU,IAEZ,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,UAAU,kBAAkB,QAAS,EAAe,SAAU,WACnE,EAAS,YAAc,gBAEzB,GAAS,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,MAAO,CAAE,MAAO,cAAe,WAAI,UAKnD,GACC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CACC,MAAO,CACL,SAAU,QACV,IAAK,EACL,KAAM,EACN,MAAO,EACP,OAAQ,EACR,gBAAiB,qBACjB,QAAS,OACT,WAAY,SACZ,eAAgB,SAChB,OAAQ,GACV,EACA,QAAS,IAAM,CAAC,GAAc,EAAuB,aAErD,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CACC,MAAO,CACL,gBAAiB,oBACjB,aAAc,MACd,QAAS,OACT,SAAU,QACV,MAAO,MACP,UAAW,OACX,UAAW,MACb,EACA,QAAU,AAAD,GAAO,EAAE,eAAe,aAEjC,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,MAAO,CAAE,UAAW,EAAG,aAAc,QAAS,WAAG,oBACrD,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,MAAO,CAAE,QAAS,OAAQ,IAAK,MAAO,YACzC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,IAAA,EAAC,QAAA,CAAM,MAAO,CAAE,QAAS,QAAS,aAAc,SAAU,WAAY,GAAI,YAAG,oBAC1D,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,MAAO,CAAE,MAAO,cAAe,WAAG,SAE1D,EACC,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,MAAO,CAAE,MAAO,uBAAwB,WAAG,qBAE9C,CAAA,EAAA,EAAA,IAAA,EAAC,SAAA,CACC,UAAU,QACV,MAAO,EAAe,qBAAqB,EAAI,EAAe,iBAAiB,CAC/E,SAAU,AAAC,IACT,IAAM,EAAe,EAAe,IAAI,CAAC,IACvC,AAAC,EAAE,IAAI,CAAgB,EAAE,EAAb,AAAe,GAAG,AAAU,EAAE,AAAV,EAAE,IAAc,CAAC,KAAA,AAAK,GAEpD,IACwB,UADV,AACoB,CAAhC,EAAa,IAAI,CACnB,EAAkB,CAChB,GAAG,CAAc,CACjB,sBAAuB,EAAa,EAAE,CACtC,kBAAmB,EACrB,GAEA,EAAkB,CAChB,GAAG,CAAc,CACjB,kBAAmB,EAAa,EAAE,CAClC,sBAAuB,EACzB,GAGN,EACA,QAAQ,CAAA,CAAA,EACR,SAAU,YAEV,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,YAAG,qBAChB,EAAe,GAAG,CAAC,AAAC,GACnB,CAAA,EAAA,EAAA,IAAA,EAAC,SAAA,CAAuC,MAAO,EAAK,EAAE,WACnD,EAAK,WAAW,CAAC,IAAgB,WAAd,EAAK,IAAI,CAAgB,WAAa,KAD/C,CAAA,EAAG,EAAK,IAAI,CAAC,CAAC,EAAE,EAAK,EAAE,CAAA,CAAE,SAQ9C,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,MAAO,CAAE,QAAS,QAAS,aAAc,SAAU,WAAY,GAAI,WAAG,+BAG7E,CAAA,EAAA,EAAA,GAAA,EAAC,WAAA,CACC,UAAU,QACV,KAAM,EACN,YAAY,yDACZ,MAAO,EAAe,cAAc,CACpC,SAAU,AAAC,GAAM,EAAkB,CAAE,GAAG,CAAc,CAAE,eAAgB,EAAE,MAAM,CAAC,KAAK,AAAC,GACvF,SAAU,OAId,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,MAAO,CAAE,QAAS,OAAQ,IAAK,OAAQ,eAAgB,WAAY,UAAW,MAAO,YACxF,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,KAAK,SACL,QAAS,IAAM,GAAuB,GACtC,SAAU,EACV,MAAO,CACL,QAAS,iBACT,gBAAiB,sBACjB,OAAQ,gCACR,aAAc,MACd,OAAQ,EAAa,cAAgB,UACrC,SAAU,UACZ,WACD,WAGD,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,KAAK,SACL,UAAU,kBACV,QAAS,EACT,SAAU,GAAe,CAAC,EAAe,iBAAiB,EAAI,CAAC,EAAe,qBAAqB,CACnG,MAAO,CACL,gBAAiB,EAAa,wBAA0B,gBAC1D,WAEC,EAAa,gBAAkB,kCAvS5B,IAgTtB"}