{"version":3,"sources":["../../../../app/organization/settings/page.tsx"],"sourcesContent":["'use client'\n\nimport { useEffect, useState } from 'react'\nimport { useRouter } from 'next/navigation'\n\ninterface Organization {\n  id: string\n  name: string\n  slug: string\n  logo?: string\n  description?: string\n  isActive: boolean\n}\n\nexport default function OrganizationSettingsPage() {\n  const router = useRouter()\n  const [organization, setOrganization] = useState<Organization | null>(null)\n  const [loading, setLoading] = useState(true)\n  const [saving, setSaving] = useState(false)\n  const [error, setError] = useState('')\n  const [success, setSuccess] = useState('')\n  const [logoFile, setLogoFile] = useState<File | null>(null)\n  const [logoPreview, setLogoPreview] = useState<string | null>(null)\n\n  useEffect(() => {\n    fetchOrganization()\n  }, [])\n\n  const fetchOrganization = async () => {\n    try {\n      const token = localStorage.getItem('accessToken')\n      const response = await fetch('/api/v1/organizations/me', {\n        headers: {\n          Authorization: `Bearer ${token}`,\n        },\n      })\n\n      if (!response.ok) {\n        throw new Error('Failed to fetch organization')\n      }\n\n      const data = await response.json()\n      setOrganization(data.organization)\n      if (data.organization?.logo) {\n        setLogoPreview(data.organization.logo)\n      }\n    } catch (err: any) {\n      setError(err.message)\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const handleLogoChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0]\n    if (file) {\n      setLogoFile(file)\n      const reader = new FileReader()\n      reader.onloadend = () => {\n        setLogoPreview(reader.result as string)\n      }\n      reader.readAsDataURL(file)\n    }\n  }\n\n  const handleUploadLogo = async () => {\n    if (!logoFile || !organization) return\n\n    setSaving(true)\n    setError('')\n    setSuccess('')\n\n    try {\n      const token = localStorage.getItem('accessToken')\n      const formData = new FormData()\n      formData.append('file', logoFile)\n      formData.append('organizationId', organization.id)\n\n      const response = await fetch('/api/v1/organizations/upload-logo', {\n        method: 'POST',\n        headers: {\n          Authorization: `Bearer ${token}`,\n        },\n        body: formData,\n      })\n\n      const data = await response.json()\n\n      if (!response.ok) {\n        throw new Error(data.error || 'Failed to upload logo')\n      }\n\n      setSuccess('Logo uploaded successfully')\n      setLogoFile(null)\n      if (data.logoUrl) {\n        setLogoPreview(data.logoUrl)\n        setOrganization({ ...organization, logo: data.logoUrl })\n      }\n    } catch (err: any) {\n      setError(err.message)\n    } finally {\n      setSaving(false)\n    }\n  }\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault()\n    if (!organization) return\n\n    setSaving(true)\n    setError('')\n    setSuccess('')\n\n    try {\n      const token = localStorage.getItem('accessToken')\n      const response = await fetch(`/api/v1/global/organizations/${organization.id}`, {\n        method: 'PUT',\n        headers: {\n          'Content-Type': 'application/json',\n          Authorization: `Bearer ${token}`,\n        },\n        body: JSON.stringify({\n          name: organization.name,\n          description: organization.description,\n        }),\n      })\n\n      const data = await response.json()\n\n      if (!response.ok) {\n        throw new Error(data.error || 'Failed to update organization')\n      }\n\n      setSuccess('Organization updated successfully')\n      setOrganization(data)\n    } catch (err: any) {\n      setError(err.message)\n    } finally {\n      setSaving(false)\n    }\n  }\n\n  if (loading) {\n    return <div>Loading organization settings...</div>\n  }\n\n  if (!organization) {\n    return <div>Organization not found</div>\n  }\n\n  return (\n    <div style={{ padding: '2rem', maxWidth: '800px', margin: '0 auto' }}>\n      <h1 style={{ marginBottom: '2rem' }}>Organization Settings</h1>\n\n      {error && (\n        <div\n          style={{\n            padding: '0.75rem',\n            backgroundColor: 'rgba(239, 68, 68, 0.1)',\n            border: '1px solid var(--error)',\n            borderRadius: '0.5rem',\n            marginBottom: '1rem',\n            color: 'var(--error)',\n          }}\n        >\n          {error}\n        </div>\n      )}\n\n      {success && (\n        <div\n          style={{\n            padding: '0.75rem',\n            backgroundColor: 'rgba(34, 197, 94, 0.1)',\n            border: '1px solid var(--success)',\n            borderRadius: '0.5rem',\n            marginBottom: '1rem',\n            color: 'var(--success)',\n          }}\n        >\n          {success}\n        </div>\n      )}\n\n      <div className=\"card\" style={{ padding: '2rem', marginBottom: '2rem' }}>\n        <h2 style={{ marginBottom: '1.5rem' }}>Logo</h2>\n        <div style={{ display: 'flex', gap: '1.5rem', alignItems: 'flex-start' }}>\n          {logoPreview && (\n            <img\n              src={logoPreview}\n              alt=\"Organization logo\"\n              style={{ width: '120px', height: '120px', objectFit: 'contain', borderRadius: '0.5rem', border: '1px solid var(--border)' }}\n            />\n          )}\n          <div style={{ flex: 1 }}>\n            <input\n              type=\"file\"\n              accept=\"image/*\"\n              onChange={handleLogoChange}\n              style={{ marginBottom: '1rem' }}\n              disabled={saving}\n            />\n            {logoFile && (\n              <button\n                type=\"button\"\n                className=\"btn btn-primary\"\n                onClick={handleUploadLogo}\n                disabled={saving}\n              >\n                {saving ? 'Uploading...' : 'Upload Logo'}\n              </button>\n            )}\n          </div>\n        </div>\n      </div>\n\n      <div className=\"card\" style={{ padding: '2rem' }}>\n        <h2 style={{ marginBottom: '1.5rem' }}>Organization Details</h2>\n        <form onSubmit={handleSubmit}>\n          <div style={{ marginBottom: '1rem' }}>\n            <label className=\"label\" htmlFor=\"name\">\n              Organization Name\n            </label>\n            <input\n              id=\"name\"\n              type=\"text\"\n              className=\"input\"\n              value={organization.name}\n              onChange={(e) => setOrganization({ ...organization, name: e.target.value })}\n              required\n              disabled={saving}\n            />\n          </div>\n\n          <div style={{ marginBottom: '1rem' }}>\n            <label className=\"label\" htmlFor=\"slug\">\n              Slug\n            </label>\n            <input\n              id=\"slug\"\n              type=\"text\"\n              className=\"input\"\n              value={organization.slug}\n              disabled\n              style={{ backgroundColor: 'var(--bg-secondary)', color: 'var(--text-secondary)' }}\n            />\n            <p style={{ fontSize: '0.875rem', color: 'var(--text-secondary)', marginTop: '0.25rem' }}>\n              Slug cannot be changed after creation\n            </p>\n          </div>\n\n          <div style={{ marginBottom: '1.5rem' }}>\n            <label className=\"label\" htmlFor=\"description\">\n              Description\n            </label>\n            <textarea\n              id=\"description\"\n              className=\"input\"\n              value={organization.description || ''}\n              onChange={(e) => setOrganization({ ...organization, description: e.target.value })}\n              rows={4}\n              disabled={saving}\n            />\n          </div>\n\n          <button type=\"submit\" className=\"btn btn-primary\" disabled={saving}>\n            {saving ? 'Saving...' : 'Save Changes'}\n          </button>\n        </form>\n      </div>\n    </div>\n  )\n}\n\n"],"names":[],"mappings":"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"}