module.exports=[20731,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(38246),e=a.i(36216);let f=c.forwardRef(function({title:a,titleId:b,...d},e){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:e,"aria-labelledby":b},d),a?c.createElement("title",{id:b},a):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.325.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 0 1 1.37.49l1.296 2.247a1.125 1.125 0 0 1-.26 1.431l-1.003.827c-.293.241-.438.613-.43.992a7.723 7.723 0 0 1 0 .255c-.008.378.137.75.43.991l1.004.827c.424.35.534.955.26 1.43l-1.298 2.247a1.125 1.125 0 0 1-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.47 6.47 0 0 1-.22.128c-.331.183-.581.495-.644.869l-.213 1.281c-.09.543-.56.94-1.11.94h-2.594c-.55 0-1.019-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 0 1-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 0 1-1.369-.49l-1.297-2.247a1.125 1.125 0 0 1 .26-1.431l1.004-.827c.292-.24.437-.613.43-.991a6.932 6.932 0 0 1 0-.255c.007-.38-.138-.751-.43-.992l-1.004-.827a1.125 1.125 0 0 1-.26-1.43l1.297-2.247a1.125 1.125 0 0 1 1.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.086.22-.128.332-.183.582-.495.644-.869l.214-1.28Z"}),c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}))});var g=a.i(89329);let h=[{id:"metrics",label:"Metrics Cards"},{id:"ticketsByPriority",label:"Tickets by Priority"},{id:"ticketsByStatus",label:"Tickets by Status"},{id:"assignedTickets",label:"My Assigned Tickets",roles:["AGENT","IT_MANAGER"]},{id:"kbArticles",label:"Recent Knowledge Base Articles",roles:["AGENT","IT_MANAGER"]},{id:"quickLinks",label:"Quick Links"}];function i(){let[a,i]=(0,c.useState)(null),[j,k]=(0,c.useState)(null),[l,m]=(0,c.useState)(!0),[n,o]=(0,c.useState)([]),[p,q]=(0,c.useState)(!1),[r,s]=(0,c.useState)([]),[t,u]=(0,c.useState)(!1),[v,w]=(0,c.useState)(null),[x,y]=(0,c.useState)("createdAt"),[z,A]=(0,c.useState)("desc"),[B,C]=(0,c.useState)(!1),[D,E]=(0,c.useState)({});(0,c.useEffect)(()=>{let a=localStorage.getItem("user");if(a)try{let b=JSON.parse(a);w(b);let c=`dashboardSettings_${b.id}`,d=localStorage.getItem(c);if(d)try{let a=JSON.parse(d);E(a)}catch(a){console.error("Failed to parse dashboard settings")}else{let a={};h.forEach(c=>{(!c.roles||c.roles.some(a=>b.roles?.includes(a)))&&(a[c.id]=!0)}),E(a),localStorage.setItem(c,JSON.stringify(a))}}catch(a){console.error("Failed to parse user data")}F()},[]);let F=async()=>{try{m(!0);let a=localStorage.getItem("accessToken"),[b,c]=await Promise.all([fetch("/api/v1/analytics/metrics",{headers:a?{Authorization:`Bearer ${a}`}:{}}),fetch("/api/v1/analytics/mttr",{headers:a?{Authorization:`Bearer ${a}`}:{}})]),d=await b.json(),e=await c.json();d.success&&i(d.data.metrics),e.success&&k(e.data.mttr)}catch(a){console.error("Failed to load dashboard data:",a)}finally{m(!1)}},G=async()=>{try{q(!0);let a=localStorage.getItem("accessToken"),b=new URLSearchParams;b.append("onlyAssignedToMe","true"),b.append("excludeStatuses","CLOSED,RESOLVED"),b.append("limit","20"),b.append("sortBy",x),b.append("sortOrder",z);let c=await fetch(`/api/v1/tickets?${b.toString()}`,{headers:a?{Authorization:`Bearer ${a}`}:{}}),d=await c.json();d.success&&o(d.data||[])}catch(a){console.error("Failed to load assigned tickets:",a)}finally{q(!1)}};(0,c.useEffect)(()=>{v&&v.roles?.some(a=>["AGENT","IT_MANAGER"].includes(a))&&(G(),H())},[v,x,z]);let H=async()=>{try{u(!0);let a=localStorage.getItem("accessToken"),b=await fetch("/api/v1/kb?limit=5",{headers:a?{Authorization:`Bearer ${a}`}:{}}),c=await b.json();c.success&&Array.isArray(c.data)&&s(c.data.slice(0,5))}catch(a){console.error("Failed to load KB articles:",a)}finally{u(!1)}},I=async(a,b)=>{let c=localStorage.getItem("accessToken");try{let d=await fetch(`/api/v1/tickets/${a}`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${c}`},body:JSON.stringify({status:b})}),e=await d.json();if(!e.success)throw Error(e.error?.message||"Failed to update status");"CLOSED"===b||"RESOLVED"===b?o(b=>b.filter(b=>b.id!==a)):o(c=>c.map(c=>c.id===a?{...c,status:b}:c))}catch(a){throw console.error("Failed to update ticket status:",a),a}},J=async a=>{try{let b=localStorage.getItem("accessToken"),c=await fetch(`/api/v1/analytics/export?type=${a}&format=csv`,{headers:b?{Authorization:`Bearer ${b}`}:{}}),d=await c.blob(),e=window.URL.createObjectURL(d),f=document.createElement("a");f.href=e,f.download=`${a}-report-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(f),f.click(),window.URL.revokeObjectURL(e),document.body.removeChild(f)}catch(a){console.error("Failed to export report:",a)}},K=a=>!1!==D[a],L=v?.roles?.some(a=>["AGENT","IT_MANAGER"].includes(a));return l?(0,b.jsx)("div",{style:{padding:"2rem"},children:"Loading dashboard..."}):(0,b.jsxs)("div",{style:{padding:"2rem",maxWidth:"1400px",margin:"0 auto"},children:[(0,b.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"2rem"},children:[(0,b.jsx)("h1",{style:{margin:0},children:"Dashboard"}),(0,b.jsxs)("div",{style:{display:"flex",gap:"1rem",alignItems:"center"},children:[(0,b.jsx)("button",{onClick:()=>C(!0),style:{padding:"0.5rem",backgroundColor:"transparent",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},title:"Dashboard Settings",children:(0,b.jsx)(f,{style:{width:"20px",height:"20px"}})}),(0,b.jsx)("button",{onClick:()=>J("tickets"),style:{padding:"0.5rem 1rem",backgroundColor:"var(--accent-primary)",color:"white",border:"none",borderRadius:"6px",cursor:"pointer"},children:"Export Tickets CSV"}),(0,b.jsx)(d.default,{href:"/reports",style:{padding:"0.5rem 1rem",backgroundColor:"var(--accent-primary)",color:"white",textDecoration:"none",borderRadius:"6px"},children:"View Reports"})]})]}),a&&K("metrics")&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem",marginBottom:"2rem"},children:[(0,b.jsxs)("div",{style:{padding:"1.5rem",border:"1px solid var(--border-color)",borderRadius:"8px",backgroundColor:"var(--bg-secondary)"},children:[(0,b.jsx)("h3",{style:{marginTop:0,marginBottom:"0.5rem",fontSize:"0.875rem",color:"var(--text-secondary)"},children:"Total Tickets"}),(0,b.jsx)("div",{style:{fontSize:"2rem",fontWeight:"bold"},children:a.totalTickets})]}),(0,b.jsxs)("div",{style:{padding:"1.5rem",border:"1px solid var(--border-color)",borderRadius:"8px",backgroundColor:"var(--bg-secondary)"},children:[(0,b.jsx)("h3",{style:{marginTop:0,marginBottom:"0.5rem",fontSize:"0.875rem",color:"var(--text-secondary)"},children:"Open Tickets"}),(0,b.jsx)("div",{style:{fontSize:"2rem",fontWeight:"bold",color:"orange"},children:a.openTickets})]}),(0,b.jsxs)("div",{style:{padding:"1.5rem",border:"1px solid var(--border-color)",borderRadius:"8px",backgroundColor:"var(--bg-secondary)"},children:[(0,b.jsx)("h3",{style:{marginTop:0,marginBottom:"0.5rem",fontSize:"0.875rem",color:"var(--text-secondary)"},children:"Resolved Tickets"}),(0,b.jsx)("div",{style:{fontSize:"2rem",fontWeight:"bold",color:"green"},children:a.resolvedTickets})]}),null!==j&&(0,b.jsxs)("div",{style:{padding:"1.5rem",border:"1px solid var(--border-color)",borderRadius:"8px",backgroundColor:"var(--bg-secondary)"},children:[(0,b.jsx)("h3",{style:{marginTop:0,marginBottom:"0.5rem",fontSize:"0.875rem",color:"var(--text-secondary)"},children:"MTTR (Minutes)"}),(0,b.jsx)("div",{style:{fontSize:"2rem",fontWeight:"bold"},children:j})]}),(0,b.jsxs)("div",{style:{padding:"1.5rem",border:"1px solid var(--border-color)",borderRadius:"8px",backgroundColor:"var(--bg-secondary)"},children:[(0,b.jsx)("h3",{style:{marginTop:0,marginBottom:"0.5rem",fontSize:"0.875rem",color:"var(--text-secondary)"},children:"Avg Resolution Time"}),(0,b.jsxs)("div",{style:{fontSize:"2rem",fontWeight:"bold"},children:[a.averageResolutionTime," min"]})]})]}),(K("ticketsByPriority")||K("ticketsByStatus"))&&(0,b.jsxs)("div",{style:{display:"grid",gridTemplateColumns:K("ticketsByPriority")&&K("ticketsByStatus")?"1fr 1fr":"1fr",gap:"2rem",marginBottom:"2rem"},children:[K("ticketsByPriority")&&(0,b.jsxs)("div",{style:{padding:"1.5rem",border:"1px solid var(--border-color)",borderRadius:"8px",backgroundColor:"var(--bg-secondary)"},children:[(0,b.jsx)("h2",{style:{marginTop:0,marginBottom:"1rem"},children:"Tickets by Priority"}),(0,b.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:Object.entries(a.ticketsByPriority).map(([a,c])=>(0,b.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,b.jsxs)("span",{children:[a,":"]}),(0,b.jsx)("strong",{children:c})]},a))})]}),K("ticketsByStatus")&&(0,b.jsxs)("div",{style:{padding:"1.5rem",border:"1px solid var(--border-color)",borderRadius:"8px",backgroundColor:"var(--bg-secondary)"},children:[(0,b.jsx)("h2",{style:{marginTop:0,marginBottom:"1rem"},children:"Tickets by Status"}),(0,b.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:Object.entries(a.ticketsByStatus).map(([a,c])=>(0,b.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,b.jsxs)("span",{children:[a,":"]}),(0,b.jsx)("strong",{children:c})]},a))})]})]})]}),L&&K("assignedTickets")&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{style:{marginBottom:"2rem"},children:[(0,b.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[(0,b.jsx)("h2",{style:{margin:0},children:"My Assigned Tickets"}),(0,b.jsx)(d.default,{href:"/tickets",className:"btn btn-secondary",style:{fontSize:"0.875rem"},children:"View All Tickets"})]}),p?(0,b.jsx)("div",{style:{padding:"2rem",textAlign:"center"},children:"Loading tickets..."}):(0,b.jsx)(e.default,{tickets:n,onStatusChange:I,showQuickActions:!0,onRefresh:G,disableClientSort:!0,onSortChange:(a,b)=>{y(a),A(b)},currentSortField:x,currentSortOrder:z})]}),K("kbArticles")&&(0,b.jsxs)("div",{style:{marginBottom:"2rem"},children:[(0,b.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[(0,b.jsx)("h2",{style:{margin:0},children:"Recent Knowledge Base Articles"}),(0,b.jsx)(d.default,{href:"/kb",className:"btn btn-secondary",style:{fontSize:"0.875rem"},children:"View All Articles"})]}),t?(0,b.jsx)("div",{style:{padding:"2rem",textAlign:"center"},children:"Loading articles..."}):r.length>0?(0,b.jsx)("div",{className:"card",style:{padding:0},children:(0,b.jsx)("div",{style:{display:"flex",flexDirection:"column"},children:r.map(a=>(0,b.jsxs)(d.default,{href:`/kb/${a.slug}`,style:{padding:"1rem",borderBottom:"1px solid var(--border-color)",textDecoration:"none",color:"inherit",display:"block"},children:[(0,b.jsx)("h3",{style:{margin:0,marginBottom:"0.5rem",fontSize:"1rem"},children:a.title}),(0,b.jsxs)("div",{style:{fontSize:"0.875rem",color:"var(--text-secondary)"},children:["Updated: ",new Date(a.updatedAt).toLocaleDateString()]})]},a.id))})}):(0,b.jsx)("div",{className:"card",style:{padding:"2rem",textAlign:"center",color:"var(--text-secondary)"},children:"No knowledge base articles found."})]})]}),K("quickLinks")&&(0,b.jsxs)("div",{style:{marginTop:"2rem"},children:[(0,b.jsx)("h2",{style:{marginBottom:"1rem"},children:"Quick Links"}),(0,b.jsxs)("div",{style:{display:"flex",gap:"1rem",flexWrap:"wrap"},children:[(0,b.jsx)(d.default,{href:"/tickets",style:{padding:"0.75rem 1.5rem",backgroundColor:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"6px",textDecoration:"none",color:"var(--text-primary)"},children:"View Tickets"}),(0,b.jsx)(d.default,{href:"/assets",style:{padding:"0.75rem 1.5rem",backgroundColor:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"6px",textDecoration:"none",color:"var(--text-primary)"},children:"View Assets"}),(0,b.jsx)(d.default,{href:"/kb",style:{padding:"0.75rem 1.5rem",backgroundColor:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"6px",textDecoration:"none",color:"var(--text-primary)"},children:"Knowledge Base"})]})]}),B&&(0,b.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},onClick:()=>C(!1),children:(0,b.jsxs)("div",{style:{backgroundColor:"var(--bg-primary)",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"2rem",maxWidth:"500px",width:"90%",maxHeight:"80vh",overflow:"auto"},onClick:a=>a.stopPropagation(),children:[(0,b.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.5rem"},children:[(0,b.jsx)("h2",{style:{margin:0},children:"Dashboard Settings"}),(0,b.jsx)("button",{onClick:()=>C(!1),style:{background:"none",border:"none",cursor:"pointer",color:"var(--text-primary)",padding:"0.25rem",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,b.jsx)(g.XMarkIcon,{style:{width:"24px",height:"24px"}})})]}),(0,b.jsx)("p",{style:{marginBottom:"1.5rem",color:"var(--text-secondary)",fontSize:"0.875rem"},children:"Select which sections to display on your dashboard:"}),(0,b.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"1rem",marginBottom:"1.5rem"},children:(!v?[]:h.filter(a=>!a.roles||a.roles.some(a=>v.roles?.includes(a)))).map(a=>(0,b.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:"0.75rem",padding:"0.75rem",border:"1px solid var(--border-color)",borderRadius:"6px",cursor:"pointer"},children:[(0,b.jsx)("input",{type:"checkbox",checked:K(a.id),onChange:()=>{var b;return b=a.id,void E(a=>({...a,[b]:!a[b]}))},style:{width:"18px",height:"18px",cursor:"pointer"}}),(0,b.jsx)("span",{children:a.label})]},a.id))}),(0,b.jsxs)("div",{style:{display:"flex",gap:"1rem",justifyContent:"flex-end"},children:[(0,b.jsx)("button",{onClick:()=>C(!1),style:{padding:"0.5rem 1rem",backgroundColor:"var(--bg-secondary)",color:"var(--text-primary)",border:"1px solid var(--border-color)",borderRadius:"6px",cursor:"pointer"},children:"Cancel"}),(0,b.jsx)("button",{onClick:()=>{if(v?.id){let a=`dashboardSettings_${v.id}`;localStorage.setItem(a,JSON.stringify(D)),C(!1)}},style:{padding:"0.5rem 1rem",backgroundColor:"var(--accent-primary)",color:"white",border:"none",borderRadius:"6px",cursor:"pointer"},children:"Save"})]})]})})]})}a.s(["default",()=>i],20731)}];

//# sourceMappingURL=app_dashboard_page_tsx_42ef5b16._.js.map