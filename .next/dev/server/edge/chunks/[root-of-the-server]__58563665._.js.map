{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 15, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/ (unsupported edge import 'stream')"],"sourcesContent":["__turbopack_context__.n(__import_unsupported(`stream`));\n"],"names":[],"mappings":"AAAA,sBAAsB,CAAC,CAAC,qBAAqB,CAAC,MAAM,CAAC"}},
    {"offset": {"line": 25, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/ (unsupported edge import 'crypto')"],"sourcesContent":["__turbopack_context__.n(__import_unsupported(`crypto`));\n"],"names":[],"mappings":"AAAA,sBAAsB,CAAC,CAAC,qBAAqB,CAAC,MAAM,CAAC"}},
    {"offset": {"line": 30, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/lib/jwt.ts"],"sourcesContent":["import jwt from 'jsonwebtoken'\n\nconst JWT_SECRET = process.env.JWT_SECRET || 'default-secret-change-in-production'\nconst JWT_EXPIRES_IN = process.env.JWT_EXPIRES_IN || '3d'\nconst JWT_REFRESH_SECRET = process.env.JWT_REFRESH_SECRET || 'default-refresh-secret-change-in-production'\nconst JWT_REFRESH_EXPIRES_IN = process.env.JWT_REFRESH_EXPIRES_IN || '30d'\n\nexport interface TokenPayload {\n  userId: string\n  email: string\n  roles: string[]\n}\n\nexport interface RefreshTokenPayload {\n  userId: string\n  email: string\n}\n\nexport function signToken(payload: TokenPayload): string {\n  return jwt.sign(payload, JWT_SECRET, {\n    expiresIn: JWT_EXPIRES_IN,\n    algorithm: 'HS256',\n  })\n}\n\nexport function verifyToken(token: string): TokenPayload {\n  try {\n    const decoded = jwt.verify(token, JWT_SECRET, {\n      algorithms: ['HS256'],\n    }) as TokenPayload\n    return decoded\n  } catch (error) {\n    throw new Error('Invalid or expired token')\n  }\n}\n\nexport function signRefreshToken(payload: RefreshTokenPayload): string {\n  return jwt.sign(payload, JWT_REFRESH_SECRET, {\n    expiresIn: JWT_REFRESH_EXPIRES_IN,\n    algorithm: 'HS256',\n  })\n}\n\nexport function verifyRefreshToken(token: string): RefreshTokenPayload {\n  try {\n    const decoded = jwt.verify(token, JWT_REFRESH_SECRET, {\n      algorithms: ['HS256'],\n    }) as RefreshTokenPayload\n    return decoded\n  } catch (error) {\n    throw new Error('Invalid or expired refresh token')\n  }\n}\n\n"],"names":[],"mappings":";;;;;;;;;;AAAA;;AAEA,MAAM,aAAa,QAAQ,GAAG,CAAC,UAAU,IAAI;AAC7C,MAAM,iBAAiB,QAAQ,GAAG,CAAC,cAAc,IAAI;AACrD,MAAM,qBAAqB,QAAQ,GAAG,CAAC,kBAAkB,IAAI;AAC7D,MAAM,yBAAyB,QAAQ,GAAG,CAAC,sBAAsB,IAAI;AAa9D,SAAS,UAAU,OAAqB;IAC7C,OAAO,wJAAG,CAAC,IAAI,CAAC,SAAS,YAAY;QACnC,WAAW;QACX,WAAW;IACb;AACF;AAEO,SAAS,YAAY,KAAa;IACvC,IAAI;QACF,MAAM,UAAU,wJAAG,CAAC,MAAM,CAAC,OAAO,YAAY;YAC5C,YAAY;gBAAC;aAAQ;QACvB;QACA,OAAO;IACT,EAAE,OAAO,OAAO;QACd,MAAM,IAAI,MAAM;IAClB;AACF;AAEO,SAAS,iBAAiB,OAA4B;IAC3D,OAAO,wJAAG,CAAC,IAAI,CAAC,SAAS,oBAAoB;QAC3C,WAAW;QACX,WAAW;IACb;AACF;AAEO,SAAS,mBAAmB,KAAa;IAC9C,IAAI;QACF,MAAM,UAAU,wJAAG,CAAC,MAAM,CAAC,OAAO,oBAAoB;YACpD,YAAY;gBAAC;aAAQ;QACvB;QACA,OAAO;IACT,EAAE,OAAO,OAAO;QACd,MAAM,IAAI,MAAM;IAClB;AACF"}},
    {"offset": {"line": 86, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/middleware.ts"],"sourcesContent":["import { NextResponse } from 'next/server'\nimport type { NextRequest } from 'next/server'\nimport { verifyToken } from '@/lib/jwt'\n\n// Routes that don't require authentication\nconst publicRoutes = ['/login', '/register', '/api/v1/auth']\n\n// Routes that require authentication\nconst protectedRoutes = ['/dashboard', '/tickets', '/kb', '/assets', '/changes', '/admin']\n\nexport function middleware(request: NextRequest) {\n  const { pathname } = request.nextUrl\n\n  // Allow public routes\n  if (publicRoutes.some((route) => pathname.startsWith(route))) {\n    return NextResponse.next()\n  }\n\n  // Check if route is protected\n  const isProtectedRoute = protectedRoutes.some((route) => pathname.startsWith(route))\n\n  if (isProtectedRoute) {\n    // For page routes (not API), allow through - client-side will handle auth\n    // The pages themselves will check for tokens in localStorage\n    if (!pathname.startsWith('/api/')) {\n      return NextResponse.next()\n    }\n\n    // For API routes, check Authorization header\n    const authHeader = request.headers.get('authorization')\n\n    if (!authHeader || !authHeader.startsWith('Bearer ')) {\n      return NextResponse.json(\n        { success: false, error: { code: 'UNAUTHORIZED', message: 'Authentication required' } },\n        { status: 401 }\n      )\n    }\n\n    try {\n      const token = authHeader.substring(7)\n      verifyToken(token)\n      return NextResponse.next()\n    } catch (error) {\n      return NextResponse.json(\n        { success: false, error: { code: 'UNAUTHORIZED', message: 'Invalid or expired token' } },\n        { status: 401 }\n      )\n    }\n  }\n\n  return NextResponse.next()\n}\n\nexport const config = {\n  matcher: [\n    /*\n     * Match all request paths except for the ones starting with:\n     * - _next/static (static files)\n     * - _next/image (image optimization files)\n     * - favicon.ico (favicon file)\n     * - public folder\n     */\n    '/((?!_next/static|_next/image|favicon.ico|.*\\\\.(?:svg|png|jpg|jpeg|gif|webp)$).*)',\n  ],\n}\n\n"],"names":[],"mappings":";;;;;;AAAA;AAAA;AAEA;;;AAEA,2CAA2C;AAC3C,MAAM,eAAe;IAAC;IAAU;IAAa;CAAe;AAE5D,qCAAqC;AACrC,MAAM,kBAAkB;IAAC;IAAc;IAAY;IAAO;IAAW;IAAY;CAAS;AAEnF,SAAS,WAAW,OAAoB;IAC7C,MAAM,EAAE,QAAQ,EAAE,GAAG,QAAQ,OAAO;IAEpC,sBAAsB;IACtB,IAAI,aAAa,IAAI,CAAC,CAAC,QAAU,SAAS,UAAU,CAAC,SAAS;QAC5D,OAAO,gMAAY,CAAC,IAAI;IAC1B;IAEA,8BAA8B;IAC9B,MAAM,mBAAmB,gBAAgB,IAAI,CAAC,CAAC,QAAU,SAAS,UAAU,CAAC;IAE7E,IAAI,kBAAkB;QACpB,0EAA0E;QAC1E,6DAA6D;QAC7D,IAAI,CAAC,SAAS,UAAU,CAAC,UAAU;YACjC,OAAO,gMAAY,CAAC,IAAI;QAC1B;QAEA,6CAA6C;QAC7C,MAAM,aAAa,QAAQ,OAAO,CAAC,GAAG,CAAC;QAEvC,IAAI,CAAC,cAAc,CAAC,WAAW,UAAU,CAAC,YAAY;YACpD,OAAO,gMAAY,CAAC,IAAI,CACtB;gBAAE,SAAS;gBAAO,OAAO;oBAAE,MAAM;oBAAgB,SAAS;gBAA0B;YAAE,GACtF;gBAAE,QAAQ;YAAI;QAElB;QAEA,IAAI;YACF,MAAM,QAAQ,WAAW,SAAS,CAAC;YACnC,IAAA,iIAAW,EAAC;YACZ,OAAO,gMAAY,CAAC,IAAI;QAC1B,EAAE,OAAO,OAAO;YACd,OAAO,gMAAY,CAAC,IAAI,CACtB;gBAAE,SAAS;gBAAO,OAAO;oBAAE,MAAM;oBAAgB,SAAS;gBAA2B;YAAE,GACvF;gBAAE,QAAQ;YAAI;QAElB;IACF;IAEA,OAAO,gMAAY,CAAC,IAAI;AAC1B;AAEO,MAAM,SAAS;IACpB,SAAS;QACP;;;;;;KAMC,GACD;KACD;AACH"}}]
}