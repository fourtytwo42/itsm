{"version":3,"sources":["../../../../app/manager/tenants/new/page.tsx"],"sourcesContent":["'use client'\n\nimport { useState, useRef } from 'react'\nimport { useRouter } from 'next/navigation'\n\nexport default function ManagerNewTenantPage() {\n  const router = useRouter()\n  const fileInputRef = useRef<HTMLInputElement>(null)\n  const [loading, setLoading] = useState(false)\n  const [uploadingLogo, setUploadingLogo] = useState(false)\n  const [error, setError] = useState('')\n  const [logoPreview, setLogoPreview] = useState<string | null>(null)\n  const [formData, setFormData] = useState({\n    name: '',\n    slug: '',\n    description: '',\n    logo: '',\n    requiresLogin: false,\n    isActive: true,\n  })\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault()\n    setLoading(true)\n    setError('')\n\n    try {\n      const token = localStorage.getItem('accessToken')\n      const response = await fetch('/api/v1/manager/tenants', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          Authorization: `Bearer ${token}`,\n        },\n        body: JSON.stringify(formData),\n      })\n\n      const data = await response.json()\n\n      if (data.success) {\n        router.push(`/manager/tenants/${data.data.tenant.id || data.data.id}`)\n      } else {\n        setError(data.error?.message || 'Failed to create tenant')\n      }\n    } catch (err) {\n      setError('An unexpected error occurred')\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  // Auto-generate slug from name\n  const handleNameChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const name = e.target.value\n    setFormData({\n      ...formData,\n      name,\n      slug: name\n        .toLowerCase()\n        .replace(/[^a-z0-9]+/g, '-')\n        .replace(/^-+|-+$/g, ''),\n    })\n  }\n\n  const handleLogoUpload = async (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0]\n    if (!file) return\n\n    // Validate file type\n    const validTypes = ['image/jpeg', 'image/jpg', 'image/png', 'image/gif', 'image/webp']\n    if (!validTypes.includes(file.type)) {\n      setError('Invalid file type. Only images (JPEG, PNG, GIF, WebP) are allowed.')\n      return\n    }\n\n    // Validate file size (max 5MB)\n    const maxSize = 5 * 1024 * 1024 // 5MB\n    if (file.size > maxSize) {\n      setError('File size exceeds 5MB limit.')\n      return\n    }\n\n    // Show preview\n    const reader = new FileReader()\n    reader.onload = (e) => {\n      setLogoPreview(e.target?.result as string)\n    }\n    reader.readAsDataURL(file)\n\n    // Upload file\n    setUploadingLogo(true)\n    setError('')\n    try {\n      const uploadFormData = new FormData()\n      uploadFormData.append('file', file)\n\n      const token = localStorage.getItem('accessToken')\n      const response = await fetch('/api/v1/admin/tenants/upload-logo', {\n        method: 'POST',\n        headers: {\n          Authorization: `Bearer ${token}`,\n        },\n        body: uploadFormData,\n      })\n\n      const data = await response.json()\n\n      if (data.success) {\n        setFormData({ ...formData, logo: data.data.url })\n      } else {\n        setError(data.error?.message || 'Failed to upload logo')\n        setLogoPreview(null)\n      }\n    } catch (err) {\n      setError('Failed to upload logo')\n      setLogoPreview(null)\n    } finally {\n      setUploadingLogo(false)\n    }\n  }\n\n  const handleRemoveLogo = () => {\n    setLogoPreview(null)\n    setFormData({ ...formData, logo: '' })\n    if (fileInputRef.current) {\n      fileInputRef.current.value = ''\n    }\n  }\n\n  return (\n    <div style={{ padding: '2rem', maxWidth: '800px', margin: '0 auto' }}>\n      <h1 style={{ fontSize: '2rem', marginBottom: '2rem' }}>Create New Tenant</h1>\n\n      {error && (\n        <div\n          style={{\n            padding: '1rem',\n            backgroundColor: 'rgba(239, 68, 68, 0.1)',\n            color: 'var(--error)',\n            borderRadius: '8px',\n            marginBottom: '1.5rem',\n          }}\n        >\n          {error}\n        </div>\n      )}\n\n      <form onSubmit={handleSubmit} style={{ display: 'grid', gap: '1.5rem' }}>\n        <div>\n          <label style={{ display: 'block', marginBottom: '0.5rem', fontWeight: 500 }}>\n            Tenant Name *\n          </label>\n          <input\n            type=\"text\"\n            required\n            value={formData.name}\n            onChange={handleNameChange}\n            style={{\n              width: '100%',\n              padding: '0.75rem',\n              borderRadius: '8px',\n              border: '1px solid var(--border-color)',\n              backgroundColor: 'var(--bg-primary)',\n              color: 'var(--text-primary)',\n            }}\n          />\n        </div>\n\n        <div>\n          <label style={{ display: 'block', marginBottom: '0.5rem', fontWeight: 500 }}>\n            Slug *\n          </label>\n          <input\n            type=\"text\"\n            required\n            value={formData.slug}\n            onChange={(e) => setFormData({ ...formData, slug: e.target.value })}\n            pattern=\"[a-z0-9-]+\"\n            style={{\n              width: '100%',\n              padding: '0.75rem',\n              borderRadius: '8px',\n              border: '1px solid var(--border-color)',\n              backgroundColor: 'var(--bg-primary)',\n              color: 'var(--text-primary)',\n            }}\n          />\n          <p style={{ fontSize: '0.75rem', color: 'var(--text-secondary)', marginTop: '0.25rem' }}>\n            URL-friendly identifier (lowercase letters, numbers, and hyphens only)\n          </p>\n        </div>\n\n        <div>\n          <label style={{ display: 'block', marginBottom: '0.5rem', fontWeight: 500 }}>\n            Description\n          </label>\n          <textarea\n            value={formData.description}\n            onChange={(e) => setFormData({ ...formData, description: e.target.value })}\n            rows={4}\n            style={{\n              width: '100%',\n              padding: '0.75rem',\n              borderRadius: '8px',\n              border: '1px solid var(--border-color)',\n              backgroundColor: 'var(--bg-primary)',\n              color: 'var(--text-primary)',\n            }}\n          />\n        </div>\n\n        <div>\n          <label style={{ display: 'block', marginBottom: '0.5rem', fontWeight: 500 }}>\n            Logo\n          </label>\n          <input\n            ref={fileInputRef}\n            type=\"file\"\n            accept=\"image/jpeg,image/jpg,image/png,image/gif,image/webp\"\n            onChange={handleLogoUpload}\n            disabled={uploadingLogo}\n            style={{\n              width: '100%',\n              padding: '0.75rem',\n              borderRadius: '8px',\n              border: '1px solid var(--border-color)',\n              backgroundColor: 'var(--bg-primary)',\n              color: 'var(--text-primary)',\n              cursor: uploadingLogo ? 'not-allowed' : 'pointer',\n              opacity: uploadingLogo ? 0.6 : 1,\n            }}\n          />\n          <p style={{ fontSize: '0.75rem', color: 'var(--text-secondary)', marginTop: '0.25rem' }}>\n            Upload an image file (JPEG, PNG, GIF, WebP). Max size: 5MB\n          </p>\n          \n          {logoPreview && (\n            <div style={{ marginTop: '1rem', position: 'relative', display: 'inline-block' }}>\n              <img\n                src={logoPreview}\n                alt=\"Logo preview\"\n                style={{\n                  maxWidth: '200px',\n                  maxHeight: '200px',\n                  borderRadius: '8px',\n                  border: '1px solid var(--border-color)',\n                  padding: '0.5rem',\n                  backgroundColor: 'var(--bg-secondary)',\n                }}\n              />\n              <button\n                type=\"button\"\n                onClick={handleRemoveLogo}\n                style={{\n                  position: 'absolute',\n                  top: '0.5rem',\n                  right: '0.5rem',\n                  padding: '0.25rem 0.5rem',\n                  backgroundColor: 'rgba(239, 68, 68, 0.9)',\n                  color: 'white',\n                  border: 'none',\n                  borderRadius: '4px',\n                  cursor: 'pointer',\n                  fontSize: '0.75rem',\n                }}\n              >\n                Remove\n              </button>\n            </div>\n          )}\n        </div>\n\n        <div style={{ display: 'flex', gap: '2rem' }}>\n          <label style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', cursor: 'pointer' }}>\n            <input\n              type=\"checkbox\"\n              checked={formData.requiresLogin}\n              onChange={(e) => setFormData({ ...formData, requiresLogin: e.target.checked })}\n              style={{ width: '18px', height: '18px' }}\n            />\n            <span>Require login to submit tickets</span>\n          </label>\n        </div>\n\n        <div style={{ display: 'flex', gap: '2rem' }}>\n          <label style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', cursor: 'pointer' }}>\n            <input\n              type=\"checkbox\"\n              checked={formData.isActive}\n              onChange={(e) => setFormData({ ...formData, isActive: e.target.checked })}\n              style={{ width: '18px', height: '18px' }}\n            />\n            <span>Active</span>\n          </label>\n        </div>\n\n        <div style={{ display: 'flex', gap: '1rem', marginTop: '1rem' }}>\n          <button\n            type=\"submit\"\n            disabled={loading}\n            style={{\n              padding: '0.75rem 1.5rem',\n              backgroundColor: 'var(--accent-primary)',\n              color: 'white',\n              border: 'none',\n              borderRadius: '8px',\n              cursor: loading ? 'not-allowed' : 'pointer',\n              fontSize: '0.875rem',\n              fontWeight: 600,\n              opacity: loading ? 0.6 : 1,\n            }}\n          >\n            {loading ? 'Creating...' : 'Create Tenant'}\n          </button>\n          <button\n            type=\"button\"\n            onClick={() => router.back()}\n            style={{\n              padding: '0.75rem 1.5rem',\n              backgroundColor: 'var(--bg-tertiary)',\n              color: 'var(--text-primary)',\n              border: 'none',\n              borderRadius: '8px',\n              cursor: 'pointer',\n              fontSize: '0.875rem',\n            }}\n          >\n            Cancel\n          </button>\n        </div>\n      </form>\n    </div>\n  )\n}\n\n"],"names":[],"mappings":"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"}