module.exports=[4947,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(38246),f=a.i(35143),g=a.i(81115);function h(){(0,d.useRouter)();let a=(0,d.useParams)(),h=a?.id,i=(0,c.useRef)(null),[j,k]=(0,c.useState)(null),[l,m]=(0,c.useState)(!0),[n,o]=(0,c.useState)(!1),[p,q]=(0,c.useState)(!1),[r,s]=(0,c.useState)(""),[t,u]=(0,c.useState)(null),[v,w]=(0,c.useState)("basic"),[x,y]=(0,c.useState)([]),[z,A]=(0,c.useState)([]),[B,C]=(0,c.useState)([]),[D,E]=(0,c.useState)(""),[F,G]=(0,c.useState)([]),[H,I]=(0,c.useState)(""),[J,K]=(0,c.useState)(""),[L,M]=(0,c.useState)(!1),[N,O]=(0,c.useState)(!1),[P,Q]=(0,c.useState)({name:"",slug:"",description:"",logo:"",requiresLogin:!1,isActive:!0});(0,c.useEffect)(()=>{R(),S(),T()},[h]);let R=async()=>{try{m(!0);let a=localStorage.getItem("accessToken"),b=await fetch(`/api/v1/admin/tenants/${h}`,{headers:a?{Authorization:`Bearer ${a}`}:{}}),c=await b.json();if(c.success){if(k(c.data),Q({name:c.data.name,slug:c.data.slug,description:c.data.description||"",logo:c.data.logo||"",requiresLogin:c.data.requiresLogin,isActive:c.data.isActive}),C(c.data.categories.map(a=>a.category)),G(c.data.kbArticles.map(a=>a.article.id)),c.data.logo){let a=c.data.logo.startsWith("http")?c.data.logo:`${window.location.origin}${c.data.logo}`;u(a)}}else s(c.error?.message||"Failed to load tenant")}catch(a){s("An unexpected error occurred")}finally{m(!1)}},S=async()=>{try{let a=localStorage.getItem("accessToken"),b=await fetch("/api/v1/kb",{headers:a?{Authorization:`Bearer ${a}`}:{}}),c=await b.json();c.success&&y(c.data)}catch(a){}},T=async()=>{try{let a=localStorage.getItem("accessToken"),b=await fetch("/api/v1/admin/users",{headers:a?{Authorization:`Bearer ${a}`}:{}}),c=await b.json();c.success&&A(c.data.users||[])}catch(a){}},U=async a=>{let b=a.target.files?.[0];if(!b)return;if(!["image/jpeg","image/jpg","image/png","image/gif","image/webp"].includes(b.type))return void s("Invalid file type. Only images (JPEG, PNG, GIF, WebP) are allowed.");if(b.size>5242880)return void s("File size exceeds 5MB limit.");let c=new FileReader;c.onload=a=>{u(a.target?.result)},c.readAsDataURL(b),q(!0),s("");try{let a=new FormData;a.append("file",b);let c=localStorage.getItem("accessToken"),d=await fetch("/api/v1/admin/tenants/upload-logo",{method:"POST",headers:{Authorization:`Bearer ${c}`},body:a}),e=await d.json();e.success?Q({...P,logo:e.data.url}):(s(e.error?.message||"Failed to upload logo"),u(null))}catch(a){s("Failed to upload logo"),u(null)}finally{q(!1)}},V=async a=>{a.preventDefault(),o(!0),s("");try{let a=localStorage.getItem("accessToken"),b=await fetch(`/api/v1/admin/tenants/${h}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify(P)}),c=await b.json();c.success?(s(""),await Promise.all([W(),X()]),R()):s(c.error?.message||"Failed to update tenant")}catch(a){s("An unexpected error occurred")}finally{o(!1)}},W=async()=>{try{let a=localStorage.getItem("accessToken");await fetch(`/api/v1/admin/tenants/${h}/categories`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify({categories:B})})}catch(a){}},X=async()=>{try{let a=localStorage.getItem("accessToken");await fetch(`/api/v1/admin/tenants/${h}/kb-articles`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify({articleIds:F})})}catch(a){}},Y=()=>{D.trim()&&!B.includes(D.trim())&&(C([...B,D.trim()]),E(""))},Z=async()=>{try{await navigator.clipboard.writeText(""),O(!0),setTimeout(()=>O(!1),2e3)}catch(a){console.error("Failed to copy:",a)}},$=async()=>{if(H)try{let a=localStorage.getItem("accessToken"),b=await fetch(`/api/v1/admin/tenants/${h}/assignments`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify({userId:H,category:L?null:J||null})}),c=await b.json();c.success?(I(""),K(""),M(!1),R()):s(c.error?.message||"Failed to add assignment")}catch(a){s("An unexpected error occurred")}},_=async a=>{try{let b=localStorage.getItem("accessToken");(await fetch(`/api/v1/admin/tenants/${h}/assignments?assignmentId=${a}`,{method:"DELETE",headers:{Authorization:`Bearer ${b}`}})).ok&&R()}catch(a){s("Failed to remove assignment")}};return l?(0,b.jsx)("div",{style:{padding:"2rem"},children:(0,b.jsx)("p",{children:"Loading tenant..."})}):j?(0,b.jsxs)("div",{style:{padding:"2rem",maxWidth:"1400px",margin:"0 auto"},children:[(0,b.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"2rem"},children:[(0,b.jsxs)("h1",{style:{fontSize:"2rem",margin:0},children:["Edit Tenant: ",j.name]}),(0,b.jsx)(e.default,{href:"/admin/tenants",style:{padding:"0.75rem 1.5rem",backgroundColor:"var(--bg-tertiary)",color:"var(--text-primary)",textDecoration:"none",borderRadius:"8px"},children:"Back to Tenants"})]}),r&&(0,b.jsx)("div",{style:{padding:"1rem",backgroundColor:"rgba(239, 68, 68, 0.1)",color:"var(--error)",borderRadius:"8px",marginBottom:"1.5rem"},children:r}),(0,b.jsx)("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"2rem",borderBottom:"1px solid var(--border-color)"},children:["basic","categories","kb","fields","assignments"].map(a=>(0,b.jsx)("button",{onClick:()=>w(a),style:{padding:"0.75rem 1.5rem",backgroundColor:v===a?"var(--bg-tertiary)":"transparent",color:"var(--text-primary)",border:"none",borderBottom:v===a?"2px solid var(--accent-primary)":"2px solid transparent",cursor:"pointer",textTransform:"capitalize"},children:"kb"===a?"KB Articles":a},a))}),"basic"===v&&(0,b.jsxs)("form",{onSubmit:V,style:{display:"grid",gap:"1.5rem"},children:[j&&(0,b.jsxs)("div",{style:{padding:"1.5rem",backgroundColor:"var(--bg-secondary)",borderRadius:"8px",border:"1px solid var(--border-color)"},children:[(0,b.jsx)("label",{style:{display:"block",marginBottom:"0.75rem",fontWeight:600,fontSize:"0.875rem"},children:"Public URL (Share with customers)"}),(0,b.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,b.jsx)("code",{style:{flex:1,padding:"0.75rem",backgroundColor:"var(--bg-primary)",borderRadius:"6px",fontSize:"0.875rem",fontFamily:"monospace",color:"var(--accent-primary)",border:"1px solid var(--border-color)",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},title:"",children:""}),(0,b.jsx)("button",{type:"button",onClick:Z,style:{padding:"0.75rem 1rem",backgroundColor:N?"var(--success)":"var(--accent-primary)",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.875rem",fontWeight:500,transition:"background-color 0.2s"},title:"Copy URL",children:N?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(g.CheckIcon,{style:{width:"16px",height:"16px"}}),"Copied!"]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(f.DocumentDuplicateIcon,{style:{width:"16px",height:"16px"}}),"Copy"]})}),(0,b.jsx)("a",{href:`/tenant/${j.slug}`,target:"_blank",rel:"noopener noreferrer",style:{padding:"0.75rem 1rem",backgroundColor:"var(--bg-tertiary)",color:"var(--text-primary)",textDecoration:"none",borderRadius:"6px",fontSize:"0.875rem",fontWeight:500,border:"1px solid var(--border-color)"},title:"Open in new tab",children:"Open"})]}),(0,b.jsx)("p",{style:{marginTop:"0.75rem",fontSize:"0.75rem",color:"var(--text-secondary)"},children:"Customers can use this URL to submit tickets, view knowledge base articles, and chat with AI support."})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:500},children:"Tenant Name *"}),(0,b.jsx)("input",{type:"text",required:!0,value:P.name,onChange:a=>Q({...P,name:a.target.value}),style:{width:"100%",padding:"0.75rem",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--bg-primary)",color:"var(--text-primary)"}})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:500},children:"Slug *"}),(0,b.jsx)("input",{type:"text",required:!0,value:P.slug,onChange:a=>Q({...P,slug:a.target.value}),pattern:"[a-z0-9-]+",style:{width:"100%",padding:"0.75rem",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--bg-primary)",color:"var(--text-primary)"}})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:500},children:"Description"}),(0,b.jsx)("textarea",{value:P.description,onChange:a=>Q({...P,description:a.target.value}),rows:4,style:{width:"100%",padding:"0.75rem",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--bg-primary)",color:"var(--text-primary)"}})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:500},children:"Logo"}),(0,b.jsx)("input",{ref:i,type:"file",accept:"image/jpeg,image/jpg,image/png,image/gif,image/webp",onChange:U,disabled:p,style:{width:"100%",padding:"0.75rem",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--bg-primary)",color:"var(--text-primary)",cursor:p?"not-allowed":"pointer",opacity:p?.6:1}}),(0,b.jsx)("p",{style:{fontSize:"0.75rem",color:"var(--text-secondary)",marginTop:"0.25rem"},children:"Upload an image file (JPEG, PNG, GIF, WebP). Max size: 5MB"}),t&&(0,b.jsxs)("div",{style:{marginTop:"1rem",position:"relative",display:"inline-block"},children:[(0,b.jsx)("img",{src:t,alt:"Logo preview",style:{maxWidth:"200px",maxHeight:"200px",borderRadius:"8px",border:"1px solid var(--border-color)",padding:"0.5rem",backgroundColor:"var(--bg-secondary)"}}),(0,b.jsx)("button",{type:"button",onClick:()=>{u(null),Q({...P,logo:""}),i.current&&(i.current.value="")},style:{position:"absolute",top:"0.5rem",right:"0.5rem",padding:"0.25rem 0.5rem",backgroundColor:"rgba(239, 68, 68, 0.9)",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"0.75rem"},children:"Remove"})]})]}),(0,b.jsx)("div",{style:{display:"flex",gap:"2rem"},children:(0,b.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer"},children:[(0,b.jsx)("input",{type:"checkbox",checked:P.requiresLogin,onChange:a=>Q({...P,requiresLogin:a.target.checked}),style:{width:"18px",height:"18px"}}),(0,b.jsx)("span",{children:"Require login to submit tickets"})]})}),(0,b.jsx)("div",{style:{display:"flex",gap:"2rem"},children:(0,b.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer"},children:[(0,b.jsx)("input",{type:"checkbox",checked:P.isActive,onChange:a=>Q({...P,isActive:a.target.checked}),style:{width:"18px",height:"18px"}}),(0,b.jsx)("span",{children:"Active"})]})}),(0,b.jsx)("div",{style:{display:"flex",gap:"1rem",marginTop:"1rem"},children:(0,b.jsx)("button",{type:"submit",disabled:n,style:{padding:"0.75rem 1.5rem",backgroundColor:"var(--accent-primary)",color:"white",border:"none",borderRadius:"8px",cursor:n?"not-allowed":"pointer",fontSize:"0.875rem",fontWeight:600,opacity:n?.6:1},children:n?"Saving...":"Save Changes"})})]}),"categories"===v&&(0,b.jsxs)("div",{style:{display:"grid",gap:"1.5rem"},children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:500},children:"Add Category"}),(0,b.jsxs)("div",{style:{display:"flex",gap:"0.5rem"},children:[(0,b.jsx)("input",{type:"text",value:D,onChange:a=>E(a.target.value),onKeyPress:a=>{"Enter"===a.key&&(a.preventDefault(),Y())},placeholder:"Category name",style:{flex:1,padding:"0.75rem",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--bg-primary)",color:"var(--text-primary)"}}),(0,b.jsx)("button",{type:"button",onClick:Y,style:{padding:"0.75rem 1.5rem",backgroundColor:"var(--accent-primary)",color:"white",border:"none",borderRadius:"8px",cursor:"pointer"},children:"Add"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{style:{marginBottom:"1rem"},children:"Categories"}),0===B.length?(0,b.jsx)("p",{style:{color:"var(--text-secondary)"},children:"No categories added yet."}):(0,b.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem"},children:B.map(a=>(0,b.jsxs)("span",{style:{padding:"0.5rem 1rem",backgroundColor:"var(--bg-tertiary)",borderRadius:"8px",display:"flex",alignItems:"center",gap:"0.5rem"},children:[a,(0,b.jsx)("button",{type:"button",onClick:()=>{C(B.filter(b=>b!==a))},style:{background:"none",border:"none",color:"var(--error)",cursor:"pointer",padding:"0",fontSize:"1.25rem"},children:"Ã—"})]},a))})]}),(0,b.jsx)("button",{onClick:async()=>{await W(),s("Categories saved!"),setTimeout(()=>s(""),3e3)},style:{padding:"0.75rem 1.5rem",backgroundColor:"var(--accent-primary)",color:"white",border:"none",borderRadius:"8px",cursor:"pointer"},children:"Save Categories"})]}),"kb"===v&&(0,b.jsxs)("div",{style:{display:"grid",gap:"1.5rem"},children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{style:{marginBottom:"1rem"},children:"Select Knowledge Base Articles"}),(0,b.jsx)("div",{style:{maxHeight:"400px",overflowY:"auto",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"1rem"},children:x.map(a=>(0,b.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem",cursor:"pointer"},children:[(0,b.jsx)("input",{type:"checkbox",checked:F.includes(a.id),onChange:b=>{b.target.checked?G([...F,a.id]):G(F.filter(b=>b!==a.id))}}),(0,b.jsx)("span",{children:a.title})]},a.id))})]}),(0,b.jsx)("button",{onClick:async()=>{await X(),s("KB articles saved!"),setTimeout(()=>s(""),3e3)},style:{padding:"0.75rem 1.5rem",backgroundColor:"var(--accent-primary)",color:"white",border:"none",borderRadius:"8px",cursor:"pointer"},children:"Save KB Articles"})]}),"fields"===v&&(0,b.jsx)("div",{children:(0,b.jsx)("p",{style:{color:"var(--text-secondary)"},children:"Custom fields management coming soon..."})}),"assignments"===v&&(0,b.jsxs)("div",{style:{display:"grid",gap:"1.5rem"},children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{style:{marginBottom:"1rem"},children:"Add Assignment"}),(0,b.jsxs)("div",{style:{display:"grid",gap:"1rem",padding:"1rem",backgroundColor:"var(--bg-secondary)",borderRadius:"8px"},children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:500},children:"User"}),(0,b.jsxs)("select",{value:H,onChange:a=>I(a.target.value),style:{width:"100%",padding:"0.75rem",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--bg-primary)",color:"var(--text-primary)"},children:[(0,b.jsx)("option",{value:"",children:"Select a user..."}),z.map(a=>(0,b.jsx)("option",{value:a.id,children:a.firstName&&a.lastName?`${a.firstName} ${a.lastName}`:a.email},a.id))]})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer",marginBottom:"0.5rem"},children:[(0,b.jsx)("input",{type:"checkbox",checked:L,onChange:a=>{M(a.target.checked),a.target.checked&&K("")}}),(0,b.jsx)("span",{children:"Assign to all categories"})]}),!L&&(0,b.jsxs)("select",{value:J,onChange:a=>K(a.target.value),style:{width:"100%",padding:"0.75rem",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--bg-primary)",color:"var(--text-primary)"},children:[(0,b.jsx)("option",{value:"",children:"All categories"}),B.map(a=>(0,b.jsx)("option",{value:a,children:a},a))]})]}),(0,b.jsx)("button",{onClick:$,disabled:!H,style:{padding:"0.75rem 1.5rem",backgroundColor:"var(--accent-primary)",color:"white",border:"none",borderRadius:"8px",cursor:H?"pointer":"not-allowed",opacity:H?1:.6},children:"Add Assignment"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{style:{marginBottom:"1rem"},children:"Current Assignments"}),0===j.assignments.length?(0,b.jsx)("p",{style:{color:"var(--text-secondary)"},children:"No assignments yet."}):(0,b.jsx)("div",{style:{display:"grid",gap:"0.5rem"},children:j.assignments.map(a=>(0,b.jsxs)("div",{style:{padding:"1rem",backgroundColor:"var(--bg-secondary)",borderRadius:"8px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{style:{fontWeight:500},children:a.user.firstName&&a.user.lastName?`${a.user.firstName} ${a.user.lastName}`:a.user.email}),(0,b.jsx)("div",{style:{fontSize:"0.875rem",color:"var(--text-secondary)"},children:a.category||"All categories"})]}),(0,b.jsx)("button",{onClick:()=>_(a.id),style:{padding:"0.5rem 1rem",backgroundColor:"rgba(239, 68, 68, 0.1)",color:"var(--error)",border:"none",borderRadius:"6px",cursor:"pointer"},children:"Remove"})]},a.id))})]})]})]}):(0,b.jsxs)("div",{style:{padding:"2rem"},children:[(0,b.jsx)("p",{children:"Tenant not found"}),(0,b.jsx)(e.default,{href:"/admin/tenants",children:"Back to Tenants"})]})}a.s(["default",()=>h])}];

//# sourceMappingURL=app_admin_tenants_%5Bid%5D_page_tsx_2b03a478._.js.map