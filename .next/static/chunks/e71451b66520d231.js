(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,24985,e=>{"use strict";var r=e.i(43476),s=e.i(71645),t=e.i(18566),a=e.i(22016);function i(){let e=(0,t.useParams)();(0,t.useRouter)();let[i,o]=(0,s.useState)(null),[n,d]=(0,s.useState)([]),[l,c]=(0,s.useState)(!0),[m,g]=(0,s.useState)(!1),[h,y]=(0,s.useState)([]),[u,x]=(0,s.useState)(""),[p,v]=(0,s.useState)(!1),[j,f]=(0,s.useState)([]),[b,S]=(0,s.useState)([]),[T,A]=(0,s.useState)(!1);(0,s.useEffect)(()=>{e.id&&(w(e.id),B(e.id),k(),$(e.id),C(e.id))},[e.id]);let w=async e=>{try{c(!0);let r=localStorage.getItem("accessToken"),s=await fetch(`/api/v1/admin/users/${e}`,{headers:r?{Authorization:`Bearer ${r}`}:{}}),t=await s.json();t.success&&o(t.data.user)}catch(e){console.error("Failed to load user:",e)}finally{c(!1)}},B=async e=>{try{g(!0);let r=localStorage.getItem("accessToken"),s=await fetch(`/api/v1/assets?assignedTo=${e}&limit=1000`,{headers:r?{Authorization:`Bearer ${r}`}:{}}),t=await s.json();t.success&&t.data?.assets&&d(t.data.assets)}catch(e){console.error("Failed to load user assets:",e)}finally{g(!1)}},k=async()=>{try{let e=localStorage.getItem("accessToken"),r=await fetch("/api/v1/assets?limit=1000",{headers:e?{Authorization:`Bearer ${e}`}:{}}),s=await r.json();s.success&&s.data?.assets&&y(s.data.assets)}catch(e){console.error("Failed to load assets:",e)}},$=async e=>{try{A(!0);let r=localStorage.getItem("accessToken"),s=await fetch(`/api/v1/organizations/audit?entityType=User&entityId=${e}&limit=50`,{headers:r?{Authorization:`Bearer ${r}`}:{}}),t=await s.json();t.logs&&f(t.logs)}catch(e){console.error("Failed to load history:",e)}finally{A(!1)}},C=async e=>{try{let r=localStorage.getItem("accessToken"),s=await fetch(`/api/v1/tickets?requesterId=${e}&limit=50`,{headers:r?{Authorization:`Bearer ${r}`}:{}}),t=await s.json();t.success&&t.data&&S(t.data)}catch(e){console.error("Failed to load tickets:",e)}},D=async()=>{if(i&&u)try{v(!0);let e=localStorage.getItem("accessToken"),r=await fetch(`/api/v1/assets/${u}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({assignedToId:i.id})}),s=await r.json();s.success?(await B(i.id),await $(i.id),x("")):alert(s.error?.message||"Failed to assign asset")}catch(e){alert("An unexpected error occurred")}finally{v(!1)}},I=async e=>{if(i&&confirm("Are you sure you want to unassign this asset?"))try{let r=localStorage.getItem("accessToken"),s=await fetch(`/api/v1/assets/${e}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify({assignedToId:null})}),t=await s.json();t.success?(await B(i.id),await $(i.id)):alert(t.error?.message||"Failed to unassign asset")}catch(e){alert("An unexpected error occurred")}};return l?(0,r.jsx)("div",{style:{padding:"2rem"},children:"Loading user..."}):i?(0,r.jsxs)("div",{style:{padding:"2rem",maxWidth:"1200px",margin:"0 auto"},children:[(0,r.jsx)("div",{style:{marginBottom:"2rem"},children:(0,r.jsx)(a.default,{href:"/admin/users",style:{color:"var(--accent-primary)",textDecoration:"none"},children:"â† Back to Users"})}),(0,r.jsx)("h1",{style:{marginBottom:"2rem"},children:i.firstName||i.lastName?`${i.firstName||""} ${i.lastName||""}`.trim():i.email}),(0,r.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"2rem",marginBottom:"2rem"},children:[(0,r.jsxs)("div",{style:{padding:"1.5rem",border:"1px solid var(--border-color)",borderRadius:"8px",backgroundColor:"var(--bg-secondary)"},children:[(0,r.jsx)("h2",{style:{marginTop:0,marginBottom:"1rem"},children:"User Information"}),(0,r.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("strong",{children:"Email:"})," ",i.email]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("strong",{children:"Role:"})," ",i.role]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("strong",{children:"Status:"})," ",i.isActive?"Active":"Inactive"]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("strong",{children:"Email Verified:"})," ",i.emailVerified?"Yes":"No"]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("strong",{children:"Created:"})," ",new Date(i.createdAt).toLocaleDateString()]})]})]}),(0,r.jsxs)("div",{style:{padding:"1.5rem",border:"1px solid var(--border-color)",borderRadius:"8px",backgroundColor:"var(--bg-secondary)"},children:[(0,r.jsx)("h2",{style:{marginTop:0,marginBottom:"1rem"},children:"Assign Asset"}),(0,r.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[(0,r.jsxs)("select",{className:"input",value:u,onChange:e=>x(e.target.value),disabled:p,children:[(0,r.jsx)("option",{value:"",children:"Select an asset..."}),h.filter(e=>!n.find(r=>r.id===e.id)).map(e=>(0,r.jsxs)("option",{value:e.id,children:[e.assetNumber," - ",e.name]},e.id))]}),(0,r.jsx)("button",{className:"btn btn-primary",onClick:D,disabled:p||!u,children:p?"Assigning...":"Assign Asset"})]})]})]}),n.length>0&&(0,r.jsxs)("div",{style:{padding:"1.5rem",border:"1px solid var(--border-color)",borderRadius:"8px",backgroundColor:"var(--bg-secondary)",marginBottom:"2rem"},children:[(0,r.jsx)("h2",{style:{marginTop:0,marginBottom:"1rem"},children:"Assigned Assets"}),m?(0,r.jsx)("div",{children:"Loading assets..."}):(0,r.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:n.map(e=>(0,r.jsxs)("div",{style:{padding:"0.75rem",border:"1px solid var(--border-color)",borderRadius:"4px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)(a.default,{href:`/assets/${e.id}`,style:{color:"var(--accent-primary)",textDecoration:"none"},children:[(0,r.jsx)("strong",{children:e.assetNumber})," - ",e.name]}),(0,r.jsxs)("div",{style:{fontSize:"0.875rem",color:"var(--text-secondary)",marginTop:"0.25rem"},children:["Type: ",e.type," | Status: ",e.status,e.assignedAt&&` | Assigned: ${new Date(e.assignedAt).toLocaleDateString()}`]})]}),(0,r.jsx)("button",{className:"btn btn-secondary",onClick:()=>I(e.id),style:{fontSize:"0.875rem",padding:"0.5rem 1rem"},children:"Unassign"})]},e.id))})]}),b.length>0&&(0,r.jsxs)("div",{style:{padding:"1.5rem",border:"1px solid var(--border-color)",borderRadius:"8px",backgroundColor:"var(--bg-secondary)",marginBottom:"2rem"},children:[(0,r.jsx)("h2",{style:{marginTop:0,marginBottom:"1rem"},children:"Related Tickets"}),(0,r.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:b.map(e=>(0,r.jsxs)("div",{style:{padding:"0.75rem",border:"1px solid var(--border-color)",borderRadius:"4px"},children:[(0,r.jsxs)(a.default,{href:`/tickets/${e.id}`,style:{color:"var(--accent-primary)",textDecoration:"none"},children:[(0,r.jsx)("strong",{children:e.ticketNumber})," - ",e.subject]}),(0,r.jsxs)("div",{style:{fontSize:"0.875rem",color:"var(--text-secondary)",marginTop:"0.25rem"},children:["Status: ",e.status," | Priority: ",e.priority," | Created: ",new Date(e.createdAt).toLocaleDateString()]})]},e.id))})]}),(0,r.jsxs)("div",{style:{padding:"1.5rem",border:"1px solid var(--border-color)",borderRadius:"8px",backgroundColor:"var(--bg-secondary)",marginBottom:"2rem"},children:[(0,r.jsx)("h2",{style:{marginTop:0,marginBottom:"1rem"},children:"History"}),T?(0,r.jsx)("div",{children:"Loading history..."}):j.length>0?(0,r.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:j.map(e=>(0,r.jsxs)("div",{style:{padding:"0.75rem",border:"1px solid var(--border-color)",borderRadius:"4px"},children:[(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start",marginBottom:"0.25rem"},children:[(0,r.jsx)("strong",{children:e.eventType}),(0,r.jsx)("span",{style:{fontSize:"0.875rem",color:"var(--text-secondary)"},children:new Date(e.createdAt).toLocaleString()})]}),(0,r.jsxs)("div",{style:{fontSize:"0.875rem",color:"var(--text-secondary)",marginBottom:"0.25rem"},children:["By: ",e.userEmail]}),(0,r.jsx)("div",{style:{fontSize:"0.875rem"},children:e.description})]},e.id))}):(0,r.jsx)("div",{style:{color:"var(--text-secondary)"},children:"No history available"})]})]}):(0,r.jsxs)("div",{style:{padding:"2rem"},children:[(0,r.jsx)("p",{children:"User not found"}),(0,r.jsx)(a.default,{href:"/admin/users",children:"Back to Users"})]})}e.s(["default",()=>i])}]);