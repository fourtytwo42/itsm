module.exports=[28025,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(38246),f=a.i(23502),g=a.i(89329);function h({tenantId:a}){let[d,e]=(0,c.useState)(!1),[h,i]=(0,c.useState)([{role:"assistant",content:"Hello! I can help you find answers in our knowledge base or create a support ticket. How can I assist you today?"}]),[j,k]=(0,c.useState)(""),[l,m]=(0,c.useState)(!1),n=(0,c.useRef)(null);(0,c.useEffect)(()=>{n.current?.scrollIntoView({behavior:"smooth"})},[h]);let o=async()=>{if(!j.trim()||l)return;let b={role:"user",content:j};i(a=>[...a,b]),k(""),m(!0);try{let c=localStorage.getItem("accessToken"),d=await fetch("/api/v1/ai/chat",{method:"POST",headers:{"Content-Type":"application/json",...c&&{Authorization:`Bearer ${c}`}},body:JSON.stringify({messages:[...h,b].map(a=>({role:a.role,content:a.content})),tenantId:a})}),e=await d.json();e.success?i(a=>[...a,{role:"assistant",content:e.data.response}]):i(a=>[...a,{role:"assistant",content:"Sorry, I encountered an error. Please try again."}])}catch(a){i(a=>[...a,{role:"assistant",content:"Sorry, I encountered an error. Please try again."}])}finally{m(!1)}};return(0,b.jsx)("div",{style:{position:"fixed",bottom:"2rem",right:"2rem",zIndex:1e3},children:d?(0,b.jsxs)("div",{style:{width:"400px",height:"600px",backgroundColor:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"12px",boxShadow:"0 4px 24px rgba(0, 0, 0, 0.3)",display:"flex",flexDirection:"column"},children:[(0,b.jsxs)("div",{style:{padding:"1rem",borderBottom:"1px solid var(--border-color)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,b.jsx)("h3",{style:{margin:0,fontSize:"1rem",fontWeight:600},children:"Support Chat"}),(0,b.jsx)("button",{onClick:()=>e(!1),style:{background:"none",border:"none",cursor:"pointer",color:"var(--text-primary)",padding:"0.25rem"},children:(0,b.jsx)(g.XMarkIcon,{className:"w-5 h-5"})})]}),(0,b.jsxs)("div",{style:{flex:1,overflowY:"auto",padding:"1rem",display:"flex",flexDirection:"column",gap:"1rem"},children:[h.map((a,c)=>(0,b.jsx)("div",{style:{alignSelf:"user"===a.role?"flex-end":"flex-start",maxWidth:"80%",padding:"0.75rem 1rem",borderRadius:"12px",backgroundColor:"user"===a.role?"var(--accent-primary)":"var(--bg-tertiary)",color:"user"===a.role?"white":"var(--text-primary)"},children:a.content},c)),l&&(0,b.jsx)("div",{style:{alignSelf:"flex-start",padding:"0.75rem 1rem",borderRadius:"12px",backgroundColor:"var(--bg-tertiary)",color:"var(--text-secondary)"},children:"Thinking..."}),(0,b.jsx)("div",{ref:n})]}),(0,b.jsxs)("div",{style:{padding:"1rem",borderTop:"1px solid var(--border-color)",display:"flex",gap:"0.5rem"},children:[(0,b.jsx)("input",{type:"text",value:j,onChange:a=>k(a.target.value),onKeyPress:a=>{"Enter"!==a.key||a.shiftKey||(a.preventDefault(),o())},placeholder:"Type your message...",disabled:l,style:{flex:1,padding:"0.75rem",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--bg-primary)",color:"var(--text-primary)"}}),(0,b.jsx)("button",{onClick:o,disabled:l||!j.trim(),style:{padding:"0.75rem",backgroundColor:"var(--accent-primary)",color:"white",border:"none",borderRadius:"8px",cursor:l||!j.trim()?"not-allowed":"pointer",opacity:l||!j.trim()?.6:1},children:(0,b.jsx)(f.PaperAirplaneIcon,{className:"w-5 h-5"})})]})]}):(0,b.jsx)("button",{onClick:()=>e(!0),style:{width:"64px",height:"64px",borderRadius:"50%",backgroundColor:"var(--accent-primary)",color:"white",border:"none",cursor:"pointer",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,b.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",style:{width:"24px",height:"24px"},children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.625 12a.375.375 0 11-.75 0 .375.375 0 01.75 0zm0 0H8.25m4.125 0a.375.375 0 11-.75 0 .375.375 0 01.75 0zm0 0H12m4.125 0a.375.375 0 11-.75 0 .375.375 0 01.75 0zm0 0h-.375M21 12c0 4.556-4.03 8.25-9 8.25a9.764 9.764 0 01-2.555-.337A5.972 5.972 0 015.41 20.97a5.969 5.969 0 01-.474-.065 4.48 4.48 0 00.978-2.025c.09-.457-.133-.901-.467-1.226C3.93 16.178 3 14.189 3 12c0-4.556 4.03-8.25 9-8.25s9 3.694 9 8.25z"})})})})}function i(){let a=(0,d.useParams)(),f=(0,d.useRouter)(),g=a?.slug,[i,j]=(0,c.useState)(null),[k,l]=(0,c.useState)(!0),[m,n]=(0,c.useState)(""),[o,p]=(0,c.useState)(!1),[q,r]=(0,c.useState)([]),[s,t]=(0,c.useState)(!1),[u,v]=(0,c.useState)(null);(0,c.useEffect)(()=>{let a=localStorage.getItem("accessToken");if(p(!!a),!a){let a=localStorage.getItem("publicToken");a?v(a):w()}x()},[g]),(0,c.useEffect)(()=>{i&&y()},[i,o,u]);let w=async a=>{try{let b=await fetch("/api/v1/public/token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tenantId:a||null})}),c=await b.json();c.success&&(localStorage.setItem("publicToken",c.data.token),localStorage.setItem("publicTokenId",c.data.publicId),v(c.data.token))}catch(a){}};(0,c.useEffect)(()=>{!i||o||u||w(i.id)},[i?.id,o]);let x=async()=>{try{l(!0);let a=await fetch(`/api/v1/tenants/${g}`),b=await a.json();b.success?(j(b.data),b.data.requiresLogin&&!o&&f.push(`/login?redirect=/tenant/${g}`)):n(b.error?.message||"Tenant not found")}catch(a){n("Failed to load tenant")}finally{l(!1)}},y=async()=>{try{t(!0);let a=localStorage.getItem("accessToken"),b=u||localStorage.getItem("publicToken"),c={"Content-Type":"application/json"};a?c.Authorization=`Bearer ${a}`:b&&(c.Authorization=`Bearer ${b}`);let d=await fetch(`/api/v1/tenants/${g}/tickets`,{headers:c}),e=await d.json();e.success&&(r(e.data),e.data.length>0&&localStorage.setItem(`tickets_${g}`,JSON.stringify(e.data)))}catch(b){let a=localStorage.getItem(`tickets_${g}`);if(a)try{r(JSON.parse(a))}catch(a){}}finally{t(!1)}};return k?(0,b.jsx)("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,b.jsx)("p",{children:"Loading..."})}):m||!i?(0,b.jsx)("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,b.jsxs)("div",{style:{textAlign:"center"},children:[(0,b.jsx)("h1",{style:{fontSize:"2rem",marginBottom:"1rem"},children:"Tenant Not Found"}),(0,b.jsx)("p",{style:{color:"var(--text-secondary)"},children:m||"The tenant you are looking for does not exist."})]})}):(0,b.jsxs)("div",{style:{minHeight:"100vh",backgroundColor:"var(--bg-primary)",color:"var(--text-primary)"},children:[(0,b.jsx)("header",{style:{padding:"2rem",borderBottom:"1px solid var(--border-color)",backgroundColor:"var(--bg-secondary)"},children:(0,b.jsxs)("div",{style:{maxWidth:"1200px",margin:"0 auto",display:"flex",alignItems:"center",gap:"1rem"},children:[i.logo&&(0,b.jsx)("img",{src:i.logo,alt:i.name,style:{width:"64px",height:"64px",borderRadius:"8px"}}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{style:{fontSize:"2rem",margin:0},children:i.name}),i.description&&(0,b.jsx)("p",{style:{color:"var(--text-secondary)",marginTop:"0.5rem"},children:i.description})]})]})}),(0,b.jsx)("nav",{style:{padding:"1rem 2rem",borderBottom:"1px solid var(--border-color)",backgroundColor:"var(--bg-secondary)"},children:(0,b.jsxs)("div",{style:{maxWidth:"1200px",margin:"0 auto",display:"flex",gap:"2rem"},children:[(0,b.jsx)(e.default,{href:`/tenant/${g}`,style:{color:"var(--accent-primary)",textDecoration:"none",fontWeight:600},children:"Home"}),(0,b.jsx)(e.default,{href:`/tenant/${g}/kb`,style:{color:"var(--text-primary)",textDecoration:"none"},children:"Knowledge Base"}),(0,b.jsx)(e.default,{href:`/tenant/${g}/submit`,style:{color:"var(--text-primary)",textDecoration:"none"},children:"Submit Ticket"})]})}),(0,b.jsx)("main",{style:{maxWidth:"1200px",margin:"0 auto",padding:"2rem"},children:(0,b.jsx)("div",{children:(0,b.jsxs)("div",{children:[(0,b.jsxs)("h2",{style:{fontSize:"1.5rem",marginBottom:"1rem"},children:["Welcome to ",i.name," Support"]}),(0,b.jsx)("p",{style:{color:"var(--text-secondary)",marginBottom:"2rem"},children:"We're here to help! Browse our knowledge base or submit a support ticket."}),(0,b.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem",marginBottom:"2rem"},children:[(0,b.jsxs)(e.default,{href:`/tenant/${g}/submit`,style:{padding:"1.5rem",backgroundColor:"var(--bg-secondary)",borderRadius:"8px",border:"1px solid var(--border-color)",textDecoration:"none",color:"var(--text-primary)",display:"block"},children:[(0,b.jsx)("h3",{style:{margin:0,marginBottom:"0.5rem"},children:"Submit a Ticket"}),(0,b.jsx)("p",{style:{margin:0,color:"var(--text-secondary)",fontSize:"0.875rem"},children:"Get help with your issue"})]}),(0,b.jsxs)(e.default,{href:`/tenant/${g}/kb`,style:{padding:"1.5rem",backgroundColor:"var(--bg-secondary)",borderRadius:"8px",border:"1px solid var(--border-color)",textDecoration:"none",color:"var(--text-primary)",display:"block"},children:[(0,b.jsx)("h3",{style:{margin:0,marginBottom:"0.5rem"},children:"Knowledge Base"}),(0,b.jsx)("p",{style:{margin:0,color:"var(--text-secondary)",fontSize:"0.875rem"},children:"Browse articles and FAQs"})]})]}),(o||u||localStorage.getItem("publicToken"))&&(0,b.jsxs)("div",{style:{marginBottom:"2rem"},children:[(0,b.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[(0,b.jsx)("h3",{style:{fontSize:"1.25rem",margin:0},children:"My Tickets"}),q.length>5&&(0,b.jsx)(e.default,{href:`/tenant/${g}/tickets`,style:{fontSize:"0.875rem",color:"var(--accent-primary)",textDecoration:"none"},children:"View All"})]}),s?(0,b.jsx)("p",{style:{color:"var(--text-secondary)"},children:"Loading tickets..."}):q.length>0?(0,b.jsx)("div",{style:{display:"grid",gap:"1rem"},children:q.slice(0,5).map(a=>(0,b.jsxs)(e.default,{href:`/tenant/${g}/tickets/${a.id}`,style:{padding:"1rem",backgroundColor:"var(--bg-secondary)",borderRadius:"8px",border:"1px solid var(--border-color)",textDecoration:"none",color:"var(--text-primary)",display:"block"},children:[(0,b.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"0.5rem"},children:[(0,b.jsx)("span",{style:{fontWeight:600},children:a.ticketNumber}),(0,b.jsx)("span",{style:{padding:"0.25rem 0.75rem",borderRadius:"12px",fontSize:"0.75rem",fontWeight:600,backgroundColor:"OPEN"===a.status||"NEW"===a.status?"rgba(59, 130, 246, 0.1)":"RESOLVED"===a.status||"CLOSED"===a.status?"rgba(16, 185, 129, 0.1)":"rgba(156, 163, 175, 0.1)",color:"OPEN"===a.status||"NEW"===a.status?"rgb(59, 130, 246)":"RESOLVED"===a.status||"CLOSED"===a.status?"rgb(16, 185, 129)":"rgb(156, 163, 175)"},children:a.status})]}),(0,b.jsx)("h4",{style:{margin:0,marginBottom:"0.25rem"},children:a.subject}),(0,b.jsx)("p",{style:{margin:0,color:"var(--text-secondary)",fontSize:"0.875rem"},children:new Date(a.createdAt).toLocaleDateString()})]},a.id))}):(0,b.jsx)("p",{style:{color:"var(--text-secondary)"},children:"No tickets yet. Submit a ticket to get started!"})]}),i.kbArticles.length>0&&(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{style:{fontSize:"1.25rem",marginBottom:"1rem"},children:"Popular Articles"}),(0,b.jsx)("div",{style:{display:"grid",gap:"1rem"},children:i.kbArticles.slice(0,5).map(a=>(0,b.jsx)(e.default,{href:`/tenant/${g}/kb/${a.id}`,style:{padding:"1rem",backgroundColor:"var(--bg-secondary)",borderRadius:"8px",border:"1px solid var(--border-color)",textDecoration:"none",color:"var(--text-primary)",display:"block"},children:a.title},a.id))})]})]})})}),(0,b.jsx)(h,{tenantId:i.id})]})}a.s(["default",()=>i],28025)}];

//# sourceMappingURL=app_tenant_%5Bslug%5D_page_tsx_54d88b1f._.js.map