{"version":3,"sources":["../../../lib/services/tenant-service.ts"],"sourcesContent":["import prisma from '@/lib/prisma'\nimport { CustomFieldType } from '@prisma/client'\n\nexport interface CreateTenantInput {\n  name: string\n  slug: string\n  description?: string\n  logo?: string\n  requiresLogin?: boolean\n  isActive?: boolean\n  organizationId: string // Tenant belongs to an organization\n}\n\nexport interface UpdateTenantInput {\n  name?: string\n  slug?: string\n  description?: string\n  logo?: string\n  requiresLogin?: boolean\n  isActive?: boolean\n}\n\nexport interface CreateCustomFieldInput {\n  tenantId: string\n  label: string\n  fieldType: CustomFieldType\n  required?: boolean\n  options?: string[]\n  placeholder?: string\n  order?: number\n}\n\nexport interface UpdateCustomFieldInput {\n  label?: string\n  fieldType?: CustomFieldType\n  required?: boolean\n  options?: string[]\n  placeholder?: string\n  order?: number\n}\n\nexport interface CreateAssignmentInput {\n  tenantId: string\n  userId: string\n  category?: string | null // null means all categories\n}\n\nexport async function createTenant(input: CreateTenantInput) {\n  // Validate slug format\n  if (!/^[a-z0-9-]+$/.test(input.slug)) {\n    throw new Error('Slug must contain only lowercase letters, numbers, and hyphens')\n  }\n\n  // Check if slug already exists\n  const existing = await prisma.tenant.findUnique({\n    where: { slug: input.slug },\n  })\n\n  if (existing) {\n    throw new Error('Tenant with this slug already exists')\n  }\n\n  return prisma.tenant.create({\n    data: {\n      name: input.name,\n      slug: input.slug,\n      description: input.description,\n      logo: input.logo,\n      requiresLogin: input.requiresLogin ?? false,\n      isActive: input.isActive ?? true,\n      organizationId: input.organizationId,\n    },\n    include: {\n      categories: true,\n      kbArticles: {\n        include: {\n          article: {\n            select: {\n              id: true,\n              title: true,\n              slug: true,\n            },\n          },\n        },\n      },\n      customFields: {\n        orderBy: { order: 'asc' },\n      },\n      assignments: {\n        include: {\n          user: {\n            select: {\n              id: true,\n              email: true,\n              firstName: true,\n              lastName: true,\n            },\n          },\n        },\n      },\n    },\n  })\n}\n\nexport async function updateTenant(id: string, input: UpdateTenantInput) {\n  if (input.slug) {\n    // Validate slug format\n    if (!/^[a-z0-9-]+$/.test(input.slug)) {\n      throw new Error('Slug must contain only lowercase letters, numbers, and hyphens')\n    }\n\n    // Check if slug already exists (excluding current tenant)\n    const existing = await prisma.tenant.findUnique({\n      where: { slug: input.slug },\n    })\n\n    if (existing && existing.id !== id) {\n      throw new Error('Tenant with this slug already exists')\n    }\n  }\n\n  return prisma.tenant.update({\n    where: { id },\n    data: {\n      name: input.name,\n      slug: input.slug,\n      description: input.description,\n      logo: input.logo,\n      requiresLogin: input.requiresLogin,\n      isActive: input.isActive,\n    },\n    include: {\n      categories: true,\n      kbArticles: {\n        include: {\n          article: {\n            select: {\n              id: true,\n              title: true,\n              slug: true,\n            },\n          },\n        },\n      },\n      customFields: {\n        orderBy: { order: 'asc' },\n      },\n      assignments: {\n        include: {\n          user: {\n            select: {\n              id: true,\n              email: true,\n              firstName: true,\n              lastName: true,\n            },\n          },\n        },\n      },\n    },\n  })\n}\n\nexport async function getTenantBySlug(slug: string) {\n  return prisma.tenant.findUnique({\n    where: { slug, isActive: true },\n    include: {\n      organization: {\n        select: {\n          id: true,\n          name: true,\n          slug: true,\n          logo: true,\n        },\n      },\n      categories: true,\n      kbArticles: {\n        include: {\n          article: {\n            select: {\n              id: true,\n              title: true,\n              slug: true,\n              content: true,\n              tags: true,\n            },\n          },\n        },\n      },\n      customFields: {\n        orderBy: { order: 'asc' },\n      },\n    },\n  })\n}\n\nexport async function getTenantById(id: string) {\n  return prisma.tenant.findUnique({\n    where: { id },\n    include: {\n      categories: true,\n      kbArticles: {\n        include: {\n          article: {\n            select: {\n              id: true,\n              title: true,\n              slug: true,\n            },\n          },\n        },\n      },\n      customFields: {\n        orderBy: { order: 'asc' },\n      },\n      assignments: {\n        include: {\n          user: {\n            select: {\n              id: true,\n              email: true,\n              firstName: true,\n              lastName: true,\n            },\n          },\n        },\n      },\n    },\n  })\n}\n\nexport async function listTenants(filters?: {\n  search?: string\n  isActive?: boolean\n  organizationId?: string // Filter by organization\n  userId?: string // For filtering by user's organization\n  userRoles?: string[] // User's roles\n}) {\n  const where: any = {}\n\n  if (filters?.search) {\n    where.OR = [\n      { name: { contains: filters.search, mode: 'insensitive' } },\n      { slug: { contains: filters.search, mode: 'insensitive' } },\n      { description: { contains: filters.search, mode: 'insensitive' } },\n    ]\n  }\n\n  if (filters?.isActive !== undefined) {\n    where.isActive = filters.isActive\n  }\n\n  // Filter by organization - if user is not GLOBAL_ADMIN, filter by their organization\n  if (filters?.userId && filters?.userRoles) {\n    if (!filters.userRoles.includes('GLOBAL_ADMIN')) {\n      // Get user's organization\n      const user = await prisma.user.findUnique({\n        where: { id: filters.userId },\n        select: { organizationId: true },\n      })\n      if (user?.organizationId) {\n        where.organizationId = user.organizationId\n      } else {\n        // User has no organization, return empty\n        return []\n      }\n    }\n  }\n\n  if (filters?.organizationId) {\n    where.organizationId = filters.organizationId\n  }\n\n  return prisma.tenant.findMany({\n    where,\n    orderBy: { createdAt: 'desc' },\n    include: {\n      categories: true,\n      organization: {\n        select: {\n          id: true,\n          name: true,\n          slug: true,\n        },\n      },\n      _count: {\n        select: {\n          tickets: true,\n          assignments: true,\n        },\n      },\n    },\n  })\n}\n\nexport async function deleteTenant(id: string) {\n  // Soft delete by setting isActive to false\n  return prisma.tenant.update({\n    where: { id },\n    data: { isActive: false },\n  })\n}\n\nexport async function manageTenantCategories(tenantId: string, categories: string[]) {\n  // Delete existing categories\n  await prisma.tenantCategory.deleteMany({\n    where: { tenantId },\n  })\n\n  // Create new categories\n  if (categories.length > 0) {\n    await prisma.tenantCategory.createMany({\n      data: categories.map((category) => ({\n        tenantId,\n        category,\n      })),\n    })\n  }\n\n  return prisma.tenantCategory.findMany({\n    where: { tenantId },\n  })\n}\n\nexport async function manageTenantKBArticles(tenantId: string, articleIds: string[]) {\n  // Delete existing KB article links\n  await prisma.tenantKBArticle.deleteMany({\n    where: { tenantId },\n  })\n\n  // Create new KB article links\n  if (articleIds.length > 0) {\n    await prisma.tenantKBArticle.createMany({\n      data: articleIds.map((articleId) => ({\n        tenantId,\n        articleId,\n      })),\n    })\n  }\n\n  return prisma.tenantKBArticle.findMany({\n    where: { tenantId },\n    include: {\n      article: {\n        select: {\n          id: true,\n          title: true,\n          slug: true,\n        },\n      },\n    },\n  })\n}\n\nexport async function createCustomField(input: CreateCustomFieldInput) {\n  return prisma.tenantCustomField.create({\n    data: {\n      tenantId: input.tenantId,\n      label: input.label,\n      fieldType: input.fieldType,\n      required: input.required ?? false,\n      options: input.options ?? [],\n      placeholder: input.placeholder,\n      order: input.order ?? 0,\n    },\n  })\n}\n\nexport async function updateCustomField(id: string, input: UpdateCustomFieldInput) {\n  return prisma.tenantCustomField.update({\n    where: { id },\n    data: {\n      label: input.label,\n      fieldType: input.fieldType,\n      required: input.required,\n      options: input.options,\n      placeholder: input.placeholder,\n      order: input.order,\n    },\n  })\n}\n\nexport async function deleteCustomField(id: string) {\n  return prisma.tenantCustomField.delete({\n    where: { id },\n  })\n}\n\nexport async function createAssignment(input: CreateAssignmentInput) {\n  return prisma.tenantAssignment.create({\n    data: {\n      tenantId: input.tenantId,\n      userId: input.userId,\n      category: input.category,\n    },\n    include: {\n      user: {\n        select: {\n          id: true,\n          email: true,\n          firstName: true,\n          lastName: true,\n        },\n      },\n      tenant: {\n        select: {\n          id: true,\n          name: true,\n          slug: true,\n        },\n      },\n    },\n  })\n}\n\nexport async function deleteAssignment(id: string) {\n  return prisma.tenantAssignment.delete({\n    where: { id },\n  })\n}\n\nexport async function getUserTenantAssignments(userId: string) {\n  return prisma.tenantAssignment.findMany({\n    where: { userId },\n    include: {\n      tenant: {\n        select: {\n          id: true,\n          name: true,\n          slug: true,\n        },\n      },\n    },\n  })\n}\n\nexport async function getUserAssignedCategories(userId: string) {\n  const assignments = await prisma.tenantAssignment.findMany({\n    where: { userId },\n    include: {\n      tenant: {\n        select: {\n          id: true,\n          name: true,\n        },\n      },\n    },\n  })\n\n  // Build map of tenantId -> categories\n  const categoryMap = new Map<string, Set<string>>()\n\n  for (const assignment of assignments) {\n    const tenantId = assignment.tenantId\n\n    if (!categoryMap.has(tenantId)) {\n      categoryMap.set(tenantId, new Set())\n    }\n\n    if (assignment.category === null) {\n      // User is assigned to all categories for this tenant\n      // Get all categories for this tenant\n      const tenantCategories = await prisma.tenantCategory.findMany({\n        where: { tenantId },\n      })\n      tenantCategories.forEach((tc) => {\n        categoryMap.get(tenantId)!.add(tc.category)\n      })\n    } else {\n      // User is assigned to specific category\n      categoryMap.get(tenantId)!.add(assignment.category)\n    }\n  }\n\n  return categoryMap\n}\n\n// Organization-based tenant management\nexport async function canManageTenant(userId: string, tenantId: string): Promise<boolean> {\n  // Check if user is global admin\n  const user = await prisma.user.findUnique({\n    where: { id: userId },\n    include: {\n      roles: {\n        include: {\n          role: true,\n          customRole: true,\n        },\n      },\n    },\n  })\n\n  if (!user) {\n    return false\n  }\n\n  const isGlobalAdmin = user.roles.some((ur) => ur.role?.name === 'GLOBAL_ADMIN')\n  if (isGlobalAdmin) {\n    return true\n  }\n\n  // Get tenant and check if user belongs to same organization\n  const tenant = await prisma.tenant.findUnique({\n    where: { id: tenantId },\n    select: { organizationId: true },\n  })\n\n  if (!tenant) {\n    return false\n  }\n\n  // User must belong to the same organization as the tenant\n  return user.organizationId === tenant.organizationId\n}\n\n"],"names":[],"mappings":"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"}