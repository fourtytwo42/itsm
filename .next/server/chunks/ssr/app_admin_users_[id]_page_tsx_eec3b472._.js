module.exports=[71386,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(38246);function f(){let a=(0,d.useParams)();(0,d.useRouter)();let[f,g]=(0,c.useState)(null),[h,i]=(0,c.useState)([]),[j,k]=(0,c.useState)(!0),[l,m]=(0,c.useState)(!1),[n,o]=(0,c.useState)([]),[p,q]=(0,c.useState)(""),[r,s]=(0,c.useState)(!1),[t,u]=(0,c.useState)([]),[v,w]=(0,c.useState)([]),[x,y]=(0,c.useState)(!1);(0,c.useEffect)(()=>{a.id&&(z(a.id),A(a.id),B(),C(a.id),D(a.id))},[a.id]);let z=async a=>{try{k(!0);let b=localStorage.getItem("accessToken"),c=await fetch(`/api/v1/admin/users/${a}`,{headers:b?{Authorization:`Bearer ${b}`}:{}}),d=await c.json();d.success&&g(d.data.user)}catch(a){console.error("Failed to load user:",a)}finally{k(!1)}},A=async a=>{try{m(!0);let b=localStorage.getItem("accessToken"),c=await fetch(`/api/v1/assets?assignedTo=${a}&limit=1000`,{headers:b?{Authorization:`Bearer ${b}`}:{}}),d=await c.json();d.success&&d.data?.assets&&i(d.data.assets)}catch(a){console.error("Failed to load user assets:",a)}finally{m(!1)}},B=async()=>{try{let a=localStorage.getItem("accessToken"),b=await fetch("/api/v1/assets?limit=1000",{headers:a?{Authorization:`Bearer ${a}`}:{}}),c=await b.json();c.success&&c.data?.assets&&o(c.data.assets)}catch(a){console.error("Failed to load assets:",a)}},C=async a=>{try{y(!0);let b=localStorage.getItem("accessToken"),c=await fetch(`/api/v1/organizations/audit?entityType=User&entityId=${a}&limit=50`,{headers:b?{Authorization:`Bearer ${b}`}:{}}),d=await c.json();d.logs&&u(d.logs)}catch(a){console.error("Failed to load history:",a)}finally{y(!1)}},D=async a=>{try{let b=localStorage.getItem("accessToken"),c=await fetch(`/api/v1/tickets?requesterId=${a}&limit=50`,{headers:b?{Authorization:`Bearer ${b}`}:{}}),d=await c.json();d.success&&d.data&&w(d.data)}catch(a){console.error("Failed to load tickets:",a)}},E=async()=>{if(f&&p)try{s(!0);let a=localStorage.getItem("accessToken"),b=await fetch(`/api/v1/assets/${p}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify({assignedToId:f.id})}),c=await b.json();c.success?(await A(f.id),await C(f.id),q("")):alert(c.error?.message||"Failed to assign asset")}catch(a){alert("An unexpected error occurred")}finally{s(!1)}},F=async a=>{if(f&&confirm("Are you sure you want to unassign this asset?"))try{let b=localStorage.getItem("accessToken"),c=await fetch(`/api/v1/assets/${a}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${b}`},body:JSON.stringify({assignedToId:null})}),d=await c.json();d.success?(await A(f.id),await C(f.id)):alert(d.error?.message||"Failed to unassign asset")}catch(a){alert("An unexpected error occurred")}};return j?(0,b.jsx)("div",{style:{padding:"2rem"},children:"Loading user..."}):f?(0,b.jsxs)("div",{style:{padding:"2rem",maxWidth:"1200px",margin:"0 auto"},children:[(0,b.jsx)("div",{style:{marginBottom:"2rem"},children:(0,b.jsx)(e.default,{href:"/admin/users",style:{color:"var(--accent-primary)",textDecoration:"none"},children:"â† Back to Users"})}),(0,b.jsx)("h1",{style:{marginBottom:"2rem"},children:f.firstName||f.lastName?`${f.firstName||""} ${f.lastName||""}`.trim():f.email}),(0,b.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"2rem",marginBottom:"2rem"},children:[(0,b.jsxs)("div",{style:{padding:"1.5rem",border:"1px solid var(--border-color)",borderRadius:"8px",backgroundColor:"var(--bg-secondary)"},children:[(0,b.jsx)("h2",{style:{marginTop:0,marginBottom:"1rem"},children:"User Information"}),(0,b.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("strong",{children:"Email:"})," ",f.email]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("strong",{children:"Role:"})," ",f.role]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("strong",{children:"Status:"})," ",f.isActive?"Active":"Inactive"]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("strong",{children:"Email Verified:"})," ",f.emailVerified?"Yes":"No"]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("strong",{children:"Created:"})," ",new Date(f.createdAt).toLocaleDateString()]})]})]}),(0,b.jsxs)("div",{style:{padding:"1.5rem",border:"1px solid var(--border-color)",borderRadius:"8px",backgroundColor:"var(--bg-secondary)"},children:[(0,b.jsx)("h2",{style:{marginTop:0,marginBottom:"1rem"},children:"Assign Asset"}),(0,b.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[(0,b.jsxs)("select",{className:"input",value:p,onChange:a=>q(a.target.value),disabled:r,children:[(0,b.jsx)("option",{value:"",children:"Select an asset..."}),n.filter(a=>!h.find(b=>b.id===a.id)).map(a=>(0,b.jsxs)("option",{value:a.id,children:[a.assetNumber," - ",a.name]},a.id))]}),(0,b.jsx)("button",{className:"btn btn-primary",onClick:E,disabled:r||!p,children:r?"Assigning...":"Assign Asset"})]})]})]}),h.length>0&&(0,b.jsxs)("div",{style:{padding:"1.5rem",border:"1px solid var(--border-color)",borderRadius:"8px",backgroundColor:"var(--bg-secondary)",marginBottom:"2rem"},children:[(0,b.jsx)("h2",{style:{marginTop:0,marginBottom:"1rem"},children:"Assigned Assets"}),l?(0,b.jsx)("div",{children:"Loading assets..."}):(0,b.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:h.map(a=>(0,b.jsxs)("div",{style:{padding:"0.75rem",border:"1px solid var(--border-color)",borderRadius:"4px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)(e.default,{href:`/assets/${a.id}`,style:{color:"var(--accent-primary)",textDecoration:"none"},children:[(0,b.jsx)("strong",{children:a.assetNumber})," - ",a.name]}),(0,b.jsxs)("div",{style:{fontSize:"0.875rem",color:"var(--text-secondary)",marginTop:"0.25rem"},children:["Type: ",a.type," | Status: ",a.status,a.assignedAt&&` | Assigned: ${new Date(a.assignedAt).toLocaleDateString()}`]})]}),(0,b.jsx)("button",{className:"btn btn-secondary",onClick:()=>F(a.id),style:{fontSize:"0.875rem",padding:"0.5rem 1rem"},children:"Unassign"})]},a.id))})]}),v.length>0&&(0,b.jsxs)("div",{style:{padding:"1.5rem",border:"1px solid var(--border-color)",borderRadius:"8px",backgroundColor:"var(--bg-secondary)",marginBottom:"2rem"},children:[(0,b.jsx)("h2",{style:{marginTop:0,marginBottom:"1rem"},children:"Related Tickets"}),(0,b.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:v.map(a=>(0,b.jsxs)("div",{style:{padding:"0.75rem",border:"1px solid var(--border-color)",borderRadius:"4px"},children:[(0,b.jsxs)(e.default,{href:`/tickets/${a.id}`,style:{color:"var(--accent-primary)",textDecoration:"none"},children:[(0,b.jsx)("strong",{children:a.ticketNumber})," - ",a.subject]}),(0,b.jsxs)("div",{style:{fontSize:"0.875rem",color:"var(--text-secondary)",marginTop:"0.25rem"},children:["Status: ",a.status," | Priority: ",a.priority," | Created: ",new Date(a.createdAt).toLocaleDateString()]})]},a.id))})]}),(0,b.jsxs)("div",{style:{padding:"1.5rem",border:"1px solid var(--border-color)",borderRadius:"8px",backgroundColor:"var(--bg-secondary)",marginBottom:"2rem"},children:[(0,b.jsx)("h2",{style:{marginTop:0,marginBottom:"1rem"},children:"History"}),x?(0,b.jsx)("div",{children:"Loading history..."}):t.length>0?(0,b.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:t.map(a=>(0,b.jsxs)("div",{style:{padding:"0.75rem",border:"1px solid var(--border-color)",borderRadius:"4px"},children:[(0,b.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start",marginBottom:"0.25rem"},children:[(0,b.jsx)("strong",{children:a.eventType}),(0,b.jsx)("span",{style:{fontSize:"0.875rem",color:"var(--text-secondary)"},children:new Date(a.createdAt).toLocaleString()})]}),(0,b.jsxs)("div",{style:{fontSize:"0.875rem",color:"var(--text-secondary)",marginBottom:"0.25rem"},children:["By: ",a.userEmail]}),(0,b.jsx)("div",{style:{fontSize:"0.875rem"},children:a.description})]},a.id))}):(0,b.jsx)("div",{style:{color:"var(--text-secondary)"},children:"No history available"})]})]}):(0,b.jsxs)("div",{style:{padding:"2rem"},children:[(0,b.jsx)("p",{children:"User not found"}),(0,b.jsx)(e.default,{href:"/admin/users",children:"Back to Users"})]})}a.s(["default",()=>f])}];

//# sourceMappingURL=app_admin_users_%5Bid%5D_page_tsx_eec3b472._.js.map