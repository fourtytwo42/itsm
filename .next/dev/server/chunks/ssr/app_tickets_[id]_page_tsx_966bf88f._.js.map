{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///home/hendo420/itsm/app/tickets/%5Bid%5D/page.tsx"],"sourcesContent":["'use client'\n\nimport { useEffect, useState } from 'react'\nimport { useParams } from 'next/navigation'\n\ninterface Ticket {\n  id: string\n  ticketNumber: string\n  subject: string\n  description: string\n  status: string\n  priority: string\n  createdAt: string\n  comments: Array<{\n    id: string\n    body: string\n    createdAt: string\n    author: { email: string }\n  }>\n}\n\nexport default function TicketDetailPage() {\n  const params = useParams()\n  const ticketId = params?.id as string\n\n  const [ticket, setTicket] = useState<Ticket | null>(null)\n  const [loading, setLoading] = useState(true)\n  const [error, setError] = useState('')\n  const [comment, setComment] = useState('')\n  const [saving, setSaving] = useState(false)\n\n  useEffect(() => {\n    const fetchTicket = async () => {\n      try {\n        const res = await fetch(`/api/v1/tickets/${ticketId}`)\n        const data = await res.json()\n        if (!data.success) {\n          setError('Failed to load ticket')\n          return\n        }\n        setTicket(data.data)\n      } catch (err) {\n        setError('Failed to load ticket')\n      } finally {\n        setLoading(false)\n      }\n    }\n    if (ticketId) fetchTicket()\n  }, [ticketId])\n\n  const submitComment = async () => {\n    if (!comment.trim()) return\n    setSaving(true)\n    setError('')\n    try {\n      const token = localStorage.getItem('accessToken')\n      const res = await fetch(`/api/v1/tickets/${ticketId}`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          ...(token ? { Authorization: `Bearer ${token}` } : {}),\n        },\n        body: JSON.stringify({ body: comment }),\n      })\n      const data = await res.json()\n      if (!data.success) {\n        setError(data.error?.message || 'Failed to add comment')\n        setSaving(false)\n        return\n      }\n      setTicket((prev) =>\n        prev\n          ? { ...prev, comments: [...prev.comments, { ...data.data, author: data.data.author }] }\n          : prev\n      )\n      setComment('')\n    } catch (err) {\n      setError('Failed to add comment')\n    } finally {\n      setSaving(false)\n    }\n  }\n\n  if (loading) return <div className=\"container\" style={{ padding: '2rem' }}>Loading ticket...</div>\n  if (error) return <div className=\"container\" style={{ padding: '2rem', color: 'var(--error)' }}>{error}</div>\n  if (!ticket) return null\n\n  return (\n    <div className=\"container\" style={{ padding: '2rem', display: 'grid', gap: '1.5rem' }}>\n      <div className=\"card\">\n        <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '0.5rem' }}>\n          <span style={{ fontWeight: 600 }}>{ticket.ticketNumber}</span>\n          <span style={{ color: 'var(--text-secondary)' }}>{new Date(ticket.createdAt).toLocaleString()}</span>\n        </div>\n        <h1 style={{ marginBottom: '0.5rem' }}>{ticket.subject}</h1>\n        <p style={{ color: 'var(--text-secondary)', marginBottom: '0.75rem' }}>{ticket.description}</p>\n        <div style={{ display: 'flex', gap: '0.75rem', color: 'var(--text-secondary)', fontSize: '0.9rem' }}>\n          <span>Status: {ticket.status}</span>\n          <span>Priority: {ticket.priority}</span>\n        </div>\n      </div>\n\n      <div className=\"card\">\n        <h3 style={{ marginBottom: '0.75rem' }}>Comments</h3>\n        <div style={{ display: 'grid', gap: '0.5rem', marginBottom: '1rem' }}>\n          {ticket.comments.length === 0 && <p style={{ color: 'var(--text-secondary)' }}>No comments yet.</p>}\n          {ticket.comments.map((c) => (\n            <div key={c.id} style={{ border: '1px solid var(--border-color)', borderRadius: '0.5rem', padding: '0.75rem' }}>\n              <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '0.25rem' }}>\n                <span style={{ fontWeight: 500 }}>{c.author?.email ?? 'Unknown'}</span>\n                <span style={{ color: 'var(--text-tertiary)', fontSize: '0.85rem' }}>\n                  {new Date(c.createdAt).toLocaleString()}\n                </span>\n              </div>\n              <p>{c.body}</p>\n            </div>\n          ))}\n        </div>\n\n        <div style={{ display: 'grid', gap: '0.5rem' }}>\n          <textarea\n            className=\"input\"\n            rows={3}\n            placeholder=\"Add a comment\"\n            value={comment}\n            onChange={(e) => setComment(e.target.value)}\n            disabled={saving}\n          />\n          <button className=\"btn btn-primary\" onClick={submitComment} disabled={saving}>\n            {saving ? 'Adding...' : 'Add Comment'}\n          </button>\n          {error && <p style={{ color: 'var(--error)' }}>{error}</p>}\n        </div>\n      </div>\n    </div>\n  )\n}\n\n"],"names":[],"mappings":"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"}}]
}