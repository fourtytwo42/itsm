module.exports=[75793,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(38246);function f(){let a=(0,d.useParams)();(0,d.useRouter)();let f=a?.slug,g=a?.id,[h,i]=(0,c.useState)(null),[j,k]=(0,c.useState)(!0),[l,m]=(0,c.useState)(""),[n,o]=(0,c.useState)(""),[p,q]=(0,c.useState)(!1),[r,s]=(0,c.useState)(!1),[t,u]=(0,c.useState)(null),[v,w]=(0,c.useState)(!1);(0,c.useEffect)(()=>{let a=localStorage.getItem("user");if(w(!!localStorage.getItem("accessToken")),a)try{u(JSON.parse(a))}catch(a){}},[]),(0,c.useEffect)(()=>{let a=async()=>{try{let a=localStorage.getItem("accessToken"),b=localStorage.getItem("publicToken"),c={};if(a)c.Authorization=`Bearer ${a}`;else if(b)c.Authorization=`Bearer ${b}`;else{m("Authentication required"),k(!1);return}let d=await fetch(`/api/v1/tickets/${g}`,{headers:c}),e=await d.json();if(!e.success)return void m(e.error?.message||"Failed to load ticket");i(e.data)}catch(a){m("Failed to load ticket")}finally{k(!1)}};g&&a()},[g]);let x=async()=>{if(n.trim()&&v){q(!0);try{let a=localStorage.getItem("accessToken"),b=await fetch(`/api/v1/tickets/${g}/comments`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify({body:n})});if((await b.json()).success){o("");let b=await fetch(`/api/v1/tickets/${g}`,{headers:{Authorization:`Bearer ${a}`}}),c=await b.json();c.success&&i(c.data)}}catch(a){}finally{q(!1)}}},y=async a=>{if(v){s(!0);try{let b=localStorage.getItem("accessToken"),c=await fetch(`/api/v1/tickets/${g}`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${b}`},body:JSON.stringify({status:a})}),d=await c.json();d.success&&i(d.data)}catch(a){}finally{s(!1)}}};return j?(0,b.jsx)("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,b.jsx)("p",{children:"Loading ticket..."})}):l?(0,b.jsx)("div",{style:{minHeight:"100vh",padding:"2rem",color:"var(--error)"},children:l}):h?(0,b.jsx)("div",{style:{minHeight:"100vh",backgroundColor:"var(--bg-primary)",color:"var(--text-primary)"},children:(0,b.jsxs)("div",{style:{maxWidth:"1200px",margin:"0 auto",padding:"2rem"},children:[(0,b.jsx)(e.default,{href:`/tenant/${f}/tickets`,style:{color:"var(--text-secondary)",textDecoration:"none",marginBottom:"2rem",display:"inline-block"},children:"â† Back to Tickets"}),(0,b.jsxs)("div",{style:{display:"grid",gap:"1.5rem"},children:[(0,b.jsxs)("div",{style:{padding:"1.5rem",backgroundColor:"var(--bg-secondary)",borderRadius:"8px",border:"1px solid var(--border-color)"},children:[(0,b.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"0.5rem"},children:[(0,b.jsx)("span",{style:{fontWeight:600},children:h.ticketNumber}),(0,b.jsx)("span",{style:{color:"var(--text-secondary)"},children:new Date(h.createdAt).toLocaleString()})]}),(0,b.jsx)("h1",{style:{marginBottom:"0.5rem"},children:h.subject}),(0,b.jsx)("p",{style:{color:"var(--text-secondary)",marginBottom:"0.75rem"},children:h.description}),(0,b.jsxs)("div",{style:{padding:"1rem",backgroundColor:"var(--bg-primary)",borderRadius:"8px",marginBottom:"1rem"},children:[(0,b.jsx)("h3",{style:{margin:0,marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:600},children:"Submitted By"}),h.requester?(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{style:{margin:0,fontSize:"0.875rem"},children:h.requester.firstName&&h.requester.lastName?`${h.requester.firstName} ${h.requester.lastName}`:h.requester.email}),(0,b.jsx)("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.75rem",color:"var(--text-secondary)"},children:h.requester.email})]}):(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{style:{margin:0,fontSize:"0.875rem"},children:h.requesterName||"Anonymous"}),h.requesterEmail&&(0,b.jsx)("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.75rem",color:"var(--text-secondary)"},children:h.requesterEmail})]})]}),(0,b.jsxs)("div",{style:{display:"flex",gap:"1rem",marginBottom:"1rem",flexWrap:"wrap"},children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{style:{fontSize:"0.875rem",color:"var(--text-secondary)",display:"block",marginBottom:"0.25rem"},children:"Status"}),v&&t?.roles?.some(a=>["ADMIN","IT_MANAGER","AGENT"].includes(a))?(0,b.jsx)("select",{value:h.status,onChange:a=>y(a.target.value),disabled:r,style:{padding:"0.5rem",borderRadius:"6px",border:"1px solid var(--border-color)",backgroundColor:"var(--bg-primary)",color:"var(--text-primary)"},children:["NEW","IN_PROGRESS","RESOLVED","CLOSED"].map(a=>(0,b.jsx)("option",{value:a,children:a},a))}):(0,b.jsx)("span",{style:{padding:"0.5rem 1rem",borderRadius:"6px",fontSize:"0.875rem",fontWeight:600,backgroundColor:"OPEN"===h.status||"NEW"===h.status?"rgba(59, 130, 246, 0.1)":"RESOLVED"===h.status||"CLOSED"===h.status?"rgba(16, 185, 129, 0.1)":"rgba(156, 163, 175, 0.1)",color:"OPEN"===h.status||"NEW"===h.status?"rgb(59, 130, 246)":"RESOLVED"===h.status||"CLOSED"===h.status?"rgb(16, 185, 129)":"rgb(156, 163, 175)"},children:h.status})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{style:{fontSize:"0.875rem",color:"var(--text-secondary)",display:"block",marginBottom:"0.25rem"},children:"Priority"}),(0,b.jsx)("span",{style:{padding:"0.5rem 1rem",borderRadius:"6px",fontSize:"0.875rem",backgroundColor:"var(--bg-primary)"},children:h.priority})]}),h.category&&(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{style:{fontSize:"0.875rem",color:"var(--text-secondary)",display:"block",marginBottom:"0.25rem"},children:"Category"}),(0,b.jsx)("span",{style:{padding:"0.5rem 1rem",borderRadius:"6px",fontSize:"0.875rem",backgroundColor:"var(--bg-primary)"},children:h.category})]})]}),h.customFields&&Object.keys(h.customFields).length>0&&(0,b.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,b.jsx)("h3",{style:{fontSize:"0.875rem",fontWeight:600,marginBottom:"0.5rem"},children:"Additional Information"}),(0,b.jsx)("div",{style:{display:"grid",gap:"0.5rem"},children:Object.entries(h.customFields).map(([a,c])=>(0,b.jsxs)("div",{style:{fontSize:"0.875rem"},children:[(0,b.jsxs)("strong",{children:[a,":"]})," ",String(c)]},a))})]}),h.assignee&&(0,b.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,b.jsx)("label",{style:{fontSize:"0.875rem",color:"var(--text-secondary)",display:"block",marginBottom:"0.25rem"},children:"Assigned To"}),(0,b.jsx)("span",{style:{fontSize:"0.875rem"},children:h.assignee.firstName&&h.assignee.lastName?`${h.assignee.firstName} ${h.assignee.lastName}`:h.assignee.email})]})]}),(0,b.jsxs)("div",{style:{padding:"1.5rem",backgroundColor:"var(--bg-secondary)",borderRadius:"8px",border:"1px solid var(--border-color)"},children:[(0,b.jsx)("h2",{style:{marginBottom:"1rem"},children:"Comments"}),(0,b.jsxs)("div",{style:{display:"grid",gap:"1rem",marginBottom:"1.5rem"},children:[h.comments.map(a=>(0,b.jsxs)("div",{style:{padding:"1rem",backgroundColor:"var(--bg-primary)",borderRadius:"8px"},children:[(0,b.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"0.5rem"},children:[(0,b.jsx)("strong",{style:{fontSize:"0.875rem"},children:a.author.firstName&&a.author.lastName?`${a.author.firstName} ${a.author.lastName}`:a.author.email}),(0,b.jsx)("span",{style:{fontSize:"0.75rem",color:"var(--text-secondary)"},children:new Date(a.createdAt).toLocaleString()})]}),(0,b.jsx)("p",{style:{margin:0,fontSize:"0.875rem",whiteSpace:"pre-wrap"},children:a.body})]},a.id)),0===h.comments.length&&(0,b.jsx)("p",{style:{color:"var(--text-secondary)",fontSize:"0.875rem"},children:"No comments yet."})]}),v&&(0,b.jsxs)("div",{children:[(0,b.jsx)("textarea",{value:n,onChange:a=>o(a.target.value),placeholder:"Add a comment...",rows:4,style:{width:"100%",padding:"0.75rem",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--bg-primary)",color:"var(--text-primary)",fontFamily:"inherit",fontSize:"0.875rem",marginBottom:"0.75rem",resize:"vertical"}}),(0,b.jsx)("button",{onClick:x,disabled:!n.trim()||p,style:{padding:"0.75rem 1.5rem",backgroundColor:"var(--accent-primary)",color:"white",border:"none",borderRadius:"8px",cursor:p?"not-allowed":"pointer",fontSize:"0.875rem",fontWeight:600,opacity:p?.6:1},children:p?"Posting...":"Post Comment"})]})]})]})]})}):null}a.s(["default",()=>f])}];

//# sourceMappingURL=app_tenant_%5Bslug%5D_tickets_%5Bid%5D_page_tsx_66452cdf._.js.map