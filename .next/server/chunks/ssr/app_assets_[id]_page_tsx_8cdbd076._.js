module.exports=[50691,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(38246);function f(){let a=(0,d.useParams)();(0,d.useRouter)();let[f,g]=(0,c.useState)(null),[h,i]=(0,c.useState)(!0),[j,k]=(0,c.useState)(!1),[l,m]=(0,c.useState)([]),[n,o]=(0,c.useState)([]),[p,q]=(0,c.useState)([]),[r,s]=(0,c.useState)(!1),[t,u]=(0,c.useState)(null),[v,w]=(0,c.useState)({});(0,c.useEffect)(()=>{a.id&&(x(a.id),y(),z(a.id),A(a.id))},[a.id]);let x=async a=>{try{i(!0);let b=localStorage.getItem("accessToken"),c=await fetch(`/api/v1/assets/${a}`,{headers:b?{Authorization:`Bearer ${b}`}:{}}),d=await c.json();d.success&&(g(d.data.asset),w({assignedToId:d.data.asset.assignedTo?.id||""}))}catch(a){console.error("Failed to load asset:",a)}finally{i(!1)}},y=async()=>{try{let a=localStorage.getItem("accessToken"),b=await fetch("/api/v1/admin/users?limit=1000",{headers:a?{Authorization:`Bearer ${a}`}:{}}),c=await b.json();if(c.success){let a=c.data?.users||c.data||[];m(a)}}catch(a){console.error("Failed to load users:",a)}},z=async a=>{try{s(!0);let b=localStorage.getItem("accessToken"),c=await fetch(`/api/v1/organizations/audit?entityType=Asset&entityId=${a}&limit=100`,{headers:b?{Authorization:`Bearer ${b}`}:{}}),d=await c.json();d.logs&&o(d.logs)}catch(a){console.error("Failed to load history:",a)}finally{s(!1)}},A=async a=>{try{let b=localStorage.getItem("accessToken"),c=await fetch(`/api/v1/assets/${a}/tickets`,{headers:b?{Authorization:`Bearer ${b}`}:{}}),d=await c.json();d.success&&d.data&&q(d.data)}catch(a){console.error("Failed to load tickets:",a)}},B=async a=>{if(f)try{k(!0);let b=localStorage.getItem("accessToken"),c={};if("assignedToId"===a)c.assignedToId=v[a]||null;else if("name"===a)c.name=v[a];else if("status"===a)c.status=v[a];else if(a.startsWith("customField_")){let b=a.replace("customField_","");c.customFields={...f.customFields||{},[b]:v[a]}}let d=await fetch(`/api/v1/assets/${f.id}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${b}`},body:JSON.stringify(c)}),e=await d.json();e.success?(await x(f.id),await z(f.id),u(null)):alert(e.error?.message||"Failed to update asset")}catch(a){alert("An unexpected error occurred")}finally{k(!1)}},C=(a,b)=>{u(a),w({...v,[a]:b})},D=()=>{u(null)},E=({label:a,field:c,value:d,type:e="text",options:f,readOnly:g=!1})=>{let h=t===c,i=d||("date"===e?"":"Not set");return g?(0,b.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"150px 1fr",gap:"1rem",alignItems:"center",padding:"0.75rem 0",borderBottom:"1px solid var(--border-color)"},children:[(0,b.jsxs)("strong",{style:{fontSize:"0.875rem",color:"var(--text-secondary)"},children:[a,":"]}),(0,b.jsx)("span",{style:{fontSize:"0.875rem"},children:i})]}):(0,b.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"150px 1fr auto",gap:"1rem",alignItems:"center",padding:"0.75rem 0",borderBottom:"1px solid var(--border-color)"},children:[(0,b.jsxs)("strong",{style:{fontSize:"0.875rem",color:"var(--text-secondary)"},children:[a,":"]}),h?(0,b.jsxs)("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:["select"===e&&f?(0,b.jsx)("select",{className:"input",value:v[c]||"",onChange:a=>w({...v,[c]:a.target.value}),disabled:j,style:{flex:1,fontSize:"0.875rem",padding:"0.5rem"},children:f.map(a=>(0,b.jsx)("option",{value:a.value,children:a.label},a.value))}):"date"===e?(0,b.jsx)("input",{type:"date",className:"input",value:v[c]?new Date(v[c]).toISOString().split("T")[0]:"",onChange:a=>w({...v,[c]:a.target.value?new Date(a.target.value).toISOString():null}),disabled:j,style:{flex:1,fontSize:"0.875rem",padding:"0.5rem"}}):"number"===e?(0,b.jsx)("input",{type:"number",step:"0.01",className:"input",value:v[c]||"",onChange:a=>w({...v,[c]:a.target.value}),disabled:j,style:{flex:1,fontSize:"0.875rem",padding:"0.5rem"}}):(0,b.jsx)("input",{type:"text",className:"input",value:v[c]||"",onChange:a=>w({...v,[c]:a.target.value}),disabled:j,style:{flex:1,fontSize:"0.875rem",padding:"0.5rem"}}),(0,b.jsx)("button",{className:"btn btn-primary",onClick:()=>B(c),disabled:j,style:{fontSize:"0.75rem",padding:"0.375rem 0.75rem",whiteSpace:"nowrap"},children:j?"Saving...":"Save"}),(0,b.jsx)("button",{className:"btn btn-secondary",onClick:D,disabled:j,style:{fontSize:"0.75rem",padding:"0.375rem 0.75rem",whiteSpace:"nowrap"},children:"Cancel"})]}):(0,b.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,b.jsx)("span",{style:{fontSize:"0.875rem",flex:1},children:i}),(0,b.jsx)("button",{onClick:()=>C(c,d),style:{padding:"0.25rem 0.5rem",fontSize:"0.75rem",backgroundColor:"transparent",border:"1px solid var(--border-color)",borderRadius:"4px",color:"var(--accent-primary)",cursor:"pointer"},children:"Edit"})]})]})};if(h)return(0,b.jsx)("div",{style:{padding:"2rem"},children:"Loading asset..."});if(!f)return(0,b.jsxs)("div",{style:{padding:"2rem"},children:[(0,b.jsx)("p",{children:"Asset not found"}),(0,b.jsx)(e.default,{href:"/assets",children:"Back to Assets"})]});let F=f.customFields||{},G=f.customAssetType?.fields||[];return(0,b.jsxs)("div",{style:{padding:"2rem",maxWidth:"1400px",margin:"0 auto"},children:[(0,b.jsxs)("div",{style:{marginBottom:"2rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,b.jsx)(e.default,{href:"/assets",style:{color:"var(--accent-primary)",textDecoration:"none",fontSize:"0.875rem"},children:"← Back to Assets"}),(0,b.jsxs)("div",{style:{fontSize:"0.875rem",color:"var(--text-secondary)"},children:["Asset Number: ",(0,b.jsx)("strong",{children:f.assetNumber})]})]}),(0,b.jsx)("h1",{style:{marginBottom:"2rem",fontSize:"2rem",fontWeight:"bold"},children:f.name}),(0,b.jsxs)("div",{style:{padding:"1.5rem",border:"1px solid var(--border-color)",borderRadius:"8px",backgroundColor:"var(--bg-secondary)",marginBottom:"2rem"},children:[(0,b.jsx)("h2",{style:{marginTop:0,marginBottom:"1.5rem",fontSize:"1.25rem",fontWeight:600},children:"Asset Information"}),(0,b.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:0},children:[(0,b.jsx)(E,{label:"Asset Number",field:"assetNumber",value:f.assetNumber,readOnly:!0}),(0,b.jsx)(E,{label:"Name",field:"name",value:f.name}),(0,b.jsx)(E,{label:"Type",field:"type",value:f.customAssetType?.name||f.type||"N/A",readOnly:!0}),(0,b.jsx)(E,{label:"Status",field:"status",value:f.status,type:"select",options:[{value:"ACTIVE",label:"Active"},{value:"INACTIVE",label:"Inactive"},{value:"RETIRED",label:"Retired"},{value:"MAINTENANCE",label:"Maintenance"}]}),(0,b.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"150px 1fr auto",gap:"1rem",alignItems:"center",padding:"0.75rem 0",borderBottom:"1px solid var(--border-color)"},children:[(0,b.jsx)("strong",{style:{fontSize:"0.875rem",color:"var(--text-secondary)"},children:"Assigned To:"}),"assignedToId"===t?(0,b.jsxs)("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[(0,b.jsxs)("select",{className:"input",value:v.assignedToId||"",onChange:a=>w({...v,assignedToId:a.target.value}),disabled:j,style:{flex:1,fontSize:"0.875rem",padding:"0.5rem"},children:[(0,b.jsx)("option",{value:"",children:"Unassigned"}),l.filter(a=>"END_USER"===a.role||a.roles?.includes("END_USER")).map(a=>(0,b.jsx)("option",{value:a.id,children:a.firstName||a.lastName?`${a.firstName||""} ${a.lastName||""}`.trim():a.email},a.id))]}),(0,b.jsx)("button",{className:"btn btn-primary",onClick:()=>B("assignedToId"),disabled:j,style:{fontSize:"0.75rem",padding:"0.375rem 0.75rem",whiteSpace:"nowrap"},children:j?"Saving...":"Save"}),(0,b.jsx)("button",{className:"btn btn-secondary",onClick:D,disabled:j,style:{fontSize:"0.75rem",padding:"0.375rem 0.75rem",whiteSpace:"nowrap"},children:"Cancel"})]}):(0,b.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,b.jsx)("span",{style:{fontSize:"0.875rem",flex:1},children:f.assignedTo?`${f.assignedTo.firstName||""} ${f.assignedTo.lastName||""}`.trim()||f.assignedTo.email:"Unassigned"}),(0,b.jsx)("button",{onClick:()=>C("assignedToId",f.assignedTo?.id||""),style:{padding:"0.25rem 0.5rem",fontSize:"0.75rem",backgroundColor:"transparent",border:"1px solid var(--border-color)",borderRadius:"4px",color:"var(--accent-primary)",cursor:"pointer"},children:"Edit"})]})]})]})]}),G.length>0&&(0,b.jsxs)("div",{style:{padding:"1.5rem",border:"1px solid var(--border-color)",borderRadius:"8px",backgroundColor:"var(--bg-secondary)",marginBottom:"2rem"},children:[(0,b.jsxs)("h2",{style:{marginTop:0,marginBottom:"1.5rem",fontSize:"1.25rem",fontWeight:600},children:[f.customAssetType?.name," Fields"]}),(0,b.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:0},children:G.sort((a,b)=>a.order-b.order).map(a=>{let c=`customField_${a.fieldName}`,d=t===c,e=F[a.fieldName];return(0,b.jsx)("div",{style:{padding:"0.75rem 0",borderBottom:"1px solid var(--border-color)"},children:(0,b.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"150px 1fr auto",gap:"1rem",alignItems:"center"},children:[(0,b.jsxs)("strong",{style:{fontSize:"0.875rem",color:"var(--text-secondary)"},children:[a.label,a.required&&(0,b.jsx)("span",{style:{color:"var(--error)"},children:" *"})]}),d?(0,b.jsxs)("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[(0,b.jsx)("div",{style:{flex:1},children:((a,c,d)=>{if(!d)return null;switch(a.fieldType){case"textarea":return(0,b.jsx)("textarea",{className:"input",value:v[`customField_${a.fieldName}`]||c||"",onChange:b=>w({...v,[`customField_${a.fieldName}`]:b.target.value}),disabled:j,rows:4,style:{fontSize:"0.875rem",padding:"0.5rem"}});case"select":let e=Array.isArray(a.options)?a.options:[];return(0,b.jsxs)("select",{className:"input",value:v[`customField_${a.fieldName}`]||c||"",onChange:b=>w({...v,[`customField_${a.fieldName}`]:b.target.value}),disabled:j,style:{fontSize:"0.875rem",padding:"0.5rem"},children:[(0,b.jsx)("option",{value:"",children:"Select..."}),e.map((a,c)=>(0,b.jsx)("option",{value:a,children:a},c))]});case"checkbox":let f=Array.isArray(a.options)?a.options:[],g=Array.isArray(v[`customField_${a.fieldName}`]||c)?v[`customField_${a.fieldName}`]||c:[];return(0,b.jsx)("div",{children:f.map((c,d)=>(0,b.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.5rem"},children:[(0,b.jsx)("input",{type:"checkbox",checked:g.includes(c),onChange:b=>{let d=b.target.checked?[...g,c]:g.filter(a=>a!==c);w({...v,[`customField_${a.fieldName}`]:d})},disabled:j}),c]},d))});case"date":return(0,b.jsx)("input",{type:"date",className:"input",value:v[`customField_${a.fieldName}`]||(c?new Date(c).toISOString().split("T")[0]:""),onChange:b=>w({...v,[`customField_${a.fieldName}`]:b.target.value?new Date(b.target.value).toISOString():""}),disabled:j,style:{fontSize:"0.875rem",padding:"0.5rem"}});case"number":return(0,b.jsx)("input",{type:"number",className:"input",value:v[`customField_${a.fieldName}`]||c||"",onChange:b=>w({...v,[`customField_${a.fieldName}`]:b.target.value}),disabled:j,style:{fontSize:"0.875rem",padding:"0.5rem"}});default:return(0,b.jsx)("input",{type:"text",className:"input",value:v[`customField_${a.fieldName}`]||c||"",onChange:b=>w({...v,[`customField_${a.fieldName}`]:b.target.value}),disabled:j,style:{fontSize:"0.875rem",padding:"0.5rem"}})}})(a,e,!0)}),(0,b.jsx)("button",{className:"btn btn-primary",onClick:()=>B(c),disabled:j,style:{fontSize:"0.75rem",padding:"0.375rem 0.75rem",whiteSpace:"nowrap"},children:j?"Saving...":"Save"}),(0,b.jsx)("button",{className:"btn btn-secondary",onClick:D,disabled:j,style:{fontSize:"0.75rem",padding:"0.375rem 0.75rem",whiteSpace:"nowrap"},children:"Cancel"})]}):(0,b.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,b.jsx)("span",{style:{fontSize:"0.875rem",flex:1},children:"checkbox"===a.fieldType&&Array.isArray(e)?e.join(", "):"date"===a.fieldType&&e?new Date(e).toLocaleDateString():e||"Not set"}),(0,b.jsx)("button",{onClick:()=>C(c,e),style:{padding:"0.25rem 0.5rem",fontSize:"0.75rem",backgroundColor:"transparent",border:"1px solid var(--border-color)",borderRadius:"4px",color:"var(--accent-primary)",cursor:"pointer"},children:"Edit"})]})]})},a.id)})})]}),f.relationships&&f.relationships.length>0||f.relatedAssets&&f.relatedAssets.length>0?(0,b.jsxs)("div",{style:{padding:"1.5rem",border:"1px solid var(--border-color)",borderRadius:"8px",backgroundColor:"var(--bg-secondary)",marginBottom:"2rem"},children:[(0,b.jsx)("h2",{style:{marginTop:0,marginBottom:"1rem",fontSize:"1.25rem",fontWeight:600},children:"Relationships"}),(0,b.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[f.relationships?.map(a=>(0,b.jsxs)("div",{style:{padding:"0.75rem",backgroundColor:"var(--bg-primary)",borderRadius:"4px"},children:[(0,b.jsxs)("strong",{style:{fontSize:"0.875rem"},children:[a.relationshipType,":"]})," ",(0,b.jsxs)(e.default,{href:`/assets/${a.targetAsset.id}`,style:{color:"var(--accent-primary)",textDecoration:"none"},children:[a.targetAsset.assetNumber," - ",a.targetAsset.name]})]},a.id)),f.relatedAssets?.map(a=>(0,b.jsxs)("div",{style:{padding:"0.75rem",backgroundColor:"var(--bg-primary)",borderRadius:"4px"},children:[(0,b.jsxs)("strong",{style:{fontSize:"0.875rem"},children:[a.relationshipType,":"]})," ",(0,b.jsxs)(e.default,{href:`/assets/${a.sourceAsset.id}`,style:{color:"var(--accent-primary)",textDecoration:"none"},children:[a.sourceAsset.assetNumber," - ",a.sourceAsset.name]})]},a.id))]})]}):null,p.length>0&&(0,b.jsxs)("div",{style:{padding:"1.5rem",border:"1px solid var(--border-color)",borderRadius:"8px",backgroundColor:"var(--bg-secondary)",marginBottom:"2rem"},children:[(0,b.jsx)("h2",{style:{marginTop:0,marginBottom:"1rem",fontSize:"1.25rem",fontWeight:600},children:"Related Tickets"}),(0,b.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:p.map(a=>(0,b.jsxs)("div",{style:{padding:"0.75rem",border:"1px solid var(--border-color)",borderRadius:"4px",backgroundColor:"var(--bg-primary)"},children:[(0,b.jsxs)(e.default,{href:`/tickets/${a.id}`,style:{color:"var(--accent-primary)",textDecoration:"none",fontWeight:500},children:[a.ticketNumber," - ",a.subject]}),(0,b.jsxs)("div",{style:{fontSize:"0.8125rem",color:"var(--text-secondary)",marginTop:"0.25rem"},children:["Status: ",a.status," | Priority: ",a.priority," | Created: ",new Date(a.createdAt).toLocaleDateString()]})]},a.id))})]}),(0,b.jsxs)("div",{style:{padding:"1.5rem",border:"1px solid var(--border-color)",borderRadius:"8px",backgroundColor:"var(--bg-secondary)",marginBottom:"2rem"},children:[(0,b.jsx)("h2",{style:{marginTop:0,marginBottom:"1.5rem",fontSize:"1.25rem",fontWeight:600},children:"Change History"}),r?(0,b.jsx)("div",{style:{padding:"2rem",textAlign:"center",color:"var(--text-secondary)"},children:"Loading history..."}):n.length>0?(0,b.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:n.map(a=>(0,b.jsxs)("div",{style:{padding:"1rem",border:"1px solid var(--border-color)",borderRadius:"6px",backgroundColor:"var(--bg-primary)"},children:[(0,b.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start",marginBottom:"0.5rem"},children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("strong",{style:{fontSize:"0.9375rem",color:"var(--text-primary)"},children:a.eventType.replace(/_/g," ").replace(/\b\w/g,a=>a.toUpperCase())}),(0,b.jsxs)("div",{style:{fontSize:"0.8125rem",color:"var(--text-secondary)",marginTop:"0.25rem"},children:["By: ",a.user?.firstName||a.user?.lastName?`${a.user.firstName||""} ${a.user.lastName||""}`.trim():a.userEmail]})]}),(0,b.jsx)("span",{style:{fontSize:"0.8125rem",color:"var(--text-secondary)",whiteSpace:"nowrap"},children:new Date(a.createdAt).toLocaleString()})]}),(0,b.jsx)("div",{style:{fontSize:"0.875rem",color:"var(--text-primary)",marginTop:"0.5rem",padding:"0.75rem",backgroundColor:"var(--bg-secondary)",borderRadius:"4px"},children:(a=>{if(!a.metadata)return a.description;let b=a.metadata;if("ASSET_ASSIGNED"===a.eventType&&(b.oldAssigneeId||b.newAssigneeId)){let a=b.oldAssigneeId?l.find(a=>a.id===b.oldAssigneeId):null,c=b.newAssigneeId?l.find(a=>a.id===b.newAssigneeId):null,d=a?a.firstName||a.lastName?`${a.firstName||""} ${a.lastName||""}`.trim():a.email:"Unassigned",e=c?c.firstName||c.lastName?`${c.firstName||""} ${c.lastName||""}`.trim():c.email:"Unassigned";return`Assignment changed from "${d}" to "${e}"`}if(b.changes&&"object"==typeof b.changes){let a=[];if(Object.keys(b.changes).forEach(c=>{let d=b.changes[c];if(d&&"object"==typeof d&&"old"in d&&"new"in d){let b=null===d.old||void 0===d.old?"empty":String(d.old),e=null===d.new||void 0===d.new?"empty":String(d.new),f=c.replace(/([A-Z])/g," $1").replace(/^./,a=>a.toUpperCase()).trim();a.push(`${f}: "${b}" → "${e}"`)}else if(null!=d){let b=f&&void 0!==f[c]?String(f[c]):"empty",e=String(d),g=c.replace(/([A-Z])/g," $1").replace(/^./,a=>a.toUpperCase()).trim();b!==e&&a.push(`${g}: "${b}" → "${e}"`)}}),a.length>0)return a.join(" | ")}return a.description})(a)})]},a.id))}):(0,b.jsx)("div",{style:{padding:"2rem",textAlign:"center",color:"var(--text-secondary)"},children:"No history available"})]})]})}a.s(["default",()=>f])}];

//# sourceMappingURL=app_assets_%5Bid%5D_page_tsx_8cdbd076._.js.map