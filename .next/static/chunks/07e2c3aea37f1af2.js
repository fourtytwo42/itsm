(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,12058,e=>{"use strict";var r=e.i(43476),t=e.i(71645),a=e.i(18566),i=e.i(22016);function o(){let e=(0,a.useParams)(),o=(0,a.useRouter)(),l=e?.slug,[d,s]=(0,t.useState)(null),[n,c]=(0,t.useState)(!0),[u,m]=(0,t.useState)(!1),[p,g]=(0,t.useState)(""),[y,h]=(0,t.useState)(!1),[b,x]=(0,t.useState)(""),[v,j]=(0,t.useState)(!1),[f,k]=(0,t.useState)(null),[C,S]=(0,t.useState)({name:"",email:"",category:"",subject:"",description:"",customFields:{}});(0,t.useEffect)(()=>{let e=localStorage.getItem("accessToken"),r=localStorage.getItem("user");if(j(!!e),r)try{let e=JSON.parse(r);k(e),S(r=>({...r,name:e.firstName&&e.lastName?`${e.firstName} ${e.lastName}`:e.email?.split("@")[0]||"",email:e.email||""}))}catch(e){}T()},[l]);let T=async()=>{try{c(!0);let e=await fetch(`/api/v1/tenants/${l}`),r=await e.json();r.success?(s(r.data),r.data.requiresLogin&&!v&&o.push(`/login?redirect=/tenant/${l}/submit`)):g(r.error?.message||"Tenant not found")}catch(e){g("Failed to load tenant")}finally{c(!1)}},F=async e=>{e.preventDefault(),m(!0),g("");try{let e=localStorage.getItem("accessToken"),r=localStorage.getItem("publicToken"),t={"Content-Type":"application/json"};if(e)t.Authorization=`Bearer ${e}`;else if(r)t.Authorization=`Bearer ${r}`;else{let e=await fetch("/api/v1/public/token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tenantId:d?.id})}),r=await e.json();r.success&&(localStorage.setItem("publicToken",r.data.token),localStorage.setItem("publicTokenId",r.data.publicId),t.Authorization=`Bearer ${r.data.token}`)}let a=await fetch(`/api/v1/tenants/${l}/tickets`,{method:"POST",headers:t,body:JSON.stringify({subject:C.subject,description:C.description,category:C.category,name:C.name,email:C.email,customFields:C.customFields})}),i=await a.json();i.success?(x(i.data.ticketNumber),h(!0)):g(i.error?.message||"Failed to submit ticket")}catch(e){g("An unexpected error occurred")}finally{m(!1)}};return n?(0,r.jsx)("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,r.jsx)("p",{children:"Loading..."})}):p&&!d?(0,r.jsx)("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,r.jsxs)("div",{style:{textAlign:"center"},children:[(0,r.jsx)("h1",{style:{fontSize:"2rem",marginBottom:"1rem"},children:"Tenant Not Found"}),(0,r.jsx)("p",{style:{color:"var(--text-secondary)"},children:p})]})}):y?(0,r.jsx)("div",{style:{minHeight:"100vh",backgroundColor:"var(--bg-primary)",color:"var(--text-primary)"},children:(0,r.jsx)("div",{style:{maxWidth:"800px",margin:"0 auto",padding:"4rem 2rem",textAlign:"center"},children:(0,r.jsxs)("div",{style:{padding:"2rem",backgroundColor:"var(--bg-secondary)",borderRadius:"12px",border:"1px solid var(--border-color)"},children:[(0,r.jsx)("h1",{style:{fontSize:"2rem",marginBottom:"1rem",color:"var(--success)"},children:"Ticket Submitted!"}),(0,r.jsx)("p",{style:{fontSize:"1.25rem",marginBottom:"0.5rem"},children:"Your ticket number is:"}),(0,r.jsx)("p",{style:{fontSize:"1.5rem",fontWeight:600,color:"var(--accent-primary)",marginBottom:"2rem"},children:b}),(0,r.jsx)("p",{style:{color:"var(--text-secondary)",marginBottom:"2rem"},children:"We've received your request and will get back to you soon."}),(0,r.jsx)("div",{style:{display:"flex",gap:"1rem",justifyContent:"center"},children:(0,r.jsx)(i.default,{href:`/tenant/${l}`,style:{padding:"0.75rem 1.5rem",backgroundColor:"var(--accent-primary)",color:"white",textDecoration:"none",borderRadius:"8px",fontWeight:600},children:"Back to Home"})})]})})}):(0,r.jsx)("div",{style:{minHeight:"100vh",backgroundColor:"var(--bg-primary)",color:"var(--text-primary)"},children:(0,r.jsxs)("div",{style:{maxWidth:"800px",margin:"0 auto",padding:"2rem"},children:[(0,r.jsx)(i.default,{href:`/tenant/${l}`,style:{color:"var(--text-secondary)",textDecoration:"none",marginBottom:"2rem",display:"inline-block"},children:"â† Back"}),(0,r.jsx)("h1",{style:{fontSize:"2rem",marginBottom:"2rem"},children:"Submit a Support Ticket"}),p&&(0,r.jsx)("div",{style:{padding:"1rem",backgroundColor:"rgba(239, 68, 68, 0.1)",color:"var(--error)",borderRadius:"8px",marginBottom:"1.5rem"},children:p}),(0,r.jsxs)("form",{onSubmit:F,style:{display:"grid",gap:"1.5rem"},children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:500},children:"Name *"}),(0,r.jsx)("input",{type:"text",required:!0,value:C.name,onChange:e=>S({...C,name:e.target.value}),disabled:v,style:{width:"100%",padding:"0.75rem",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--bg-primary)",color:"var(--text-primary)",opacity:v?.6:1}})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:500},children:"Email *"}),(0,r.jsx)("input",{type:"email",required:!0,value:C.email,onChange:e=>S({...C,email:e.target.value}),disabled:v,style:{width:"100%",padding:"0.75rem",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--bg-primary)",color:"var(--text-primary)",opacity:v?.6:1}})]}),d&&d.categories.length>0&&(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:500},children:"Category *"}),(0,r.jsxs)("select",{required:!0,value:C.category,onChange:e=>S({...C,category:e.target.value}),style:{width:"100%",padding:"0.75rem",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--bg-primary)",color:"var(--text-primary)"},children:[(0,r.jsx)("option",{value:"",children:"Select a category..."}),d.categories.map(e=>(0,r.jsx)("option",{value:e,children:e},e))]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:500},children:"Subject *"}),(0,r.jsx)("input",{type:"text",required:!0,value:C.subject,onChange:e=>S({...C,subject:e.target.value}),placeholder:"Brief description of your issue",style:{width:"100%",padding:"0.75rem",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--bg-primary)",color:"var(--text-primary)"}})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:500},children:"Description *"}),(0,r.jsx)("textarea",{required:!0,value:C.description,onChange:e=>S({...C,description:e.target.value}),placeholder:"Please provide details about your issue...",rows:6,style:{width:"100%",padding:"0.75rem",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--bg-primary)",color:"var(--text-primary)"}})]}),d&&d.customFields.map(e=>(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:500},children:[e.label," ",e.required&&"*"]}),(e=>{switch(e.fieldType){case"TEXT":case"EMAIL":case"PHONE":return(0,r.jsx)("input",{type:"EMAIL"===e.fieldType?"email":"PHONE"===e.fieldType?"tel":"text",required:e.required,value:C.customFields[e.id]||"",onChange:r=>S({...C,customFields:{...C.customFields,[e.id]:r.target.value}}),placeholder:e.placeholder,style:{width:"100%",padding:"0.75rem",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--bg-primary)",color:"var(--text-primary)"}});case"TEXTAREA":return(0,r.jsx)("textarea",{required:e.required,value:C.customFields[e.id]||"",onChange:r=>S({...C,customFields:{...C.customFields,[e.id]:r.target.value}}),placeholder:e.placeholder,rows:4,style:{width:"100%",padding:"0.75rem",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--bg-primary)",color:"var(--text-primary)"}});case"NUMBER":return(0,r.jsx)("input",{type:"number",required:e.required,value:C.customFields[e.id]||"",onChange:r=>S({...C,customFields:{...C.customFields,[e.id]:r.target.value}}),placeholder:e.placeholder,style:{width:"100%",padding:"0.75rem",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--bg-primary)",color:"var(--text-primary)"}});case"DATE":return(0,r.jsx)("input",{type:"date",required:e.required,value:C.customFields[e.id]||"",onChange:r=>S({...C,customFields:{...C.customFields,[e.id]:r.target.value}}),style:{width:"100%",padding:"0.75rem",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--bg-primary)",color:"var(--text-primary)"}});case"SELECT":return(0,r.jsxs)("select",{required:e.required,value:C.customFields[e.id]||"",onChange:r=>S({...C,customFields:{...C.customFields,[e.id]:r.target.value}}),style:{width:"100%",padding:"0.75rem",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--bg-primary)",color:"var(--text-primary)"},children:[(0,r.jsx)("option",{value:"",children:"Select an option..."}),e.options?.map(e=>(0,r.jsx)("option",{value:e,children:e},e))]});case"CHECKBOX":return(0,r.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer"},children:[(0,r.jsx)("input",{type:"checkbox",checked:C.customFields[e.id]||!1,onChange:r=>S({...C,customFields:{...C.customFields,[e.id]:r.target.checked}}),style:{width:"18px",height:"18px"}}),(0,r.jsx)("span",{children:e.placeholder||"Yes"})]});default:return null}})(e)]},e.id)),(0,r.jsxs)("div",{style:{display:"flex",gap:"1rem",marginTop:"1rem"},children:[(0,r.jsx)("button",{type:"submit",disabled:u,style:{padding:"0.75rem 1.5rem",backgroundColor:"var(--accent-primary)",color:"white",border:"none",borderRadius:"8px",cursor:u?"not-allowed":"pointer",fontSize:"0.875rem",fontWeight:600,opacity:u?.6:1},children:u?"Submitting...":"Submit Ticket"}),(0,r.jsx)(i.default,{href:`/tenant/${l}`,style:{padding:"0.75rem 1.5rem",backgroundColor:"var(--bg-tertiary)",color:"var(--text-primary)",textDecoration:"none",borderRadius:"8px",fontSize:"0.875rem",display:"inline-block"},children:"Cancel"})]})]})]})})}e.s(["default",()=>o])}]);