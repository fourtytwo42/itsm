(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,37940,e=>{"use strict";var t=e.i(43476),r=e.i(71645),o=e.i(18566),a=e.i(22016),n=e.i(42969),i=e.i(27217);function s({tenantId:e}){let[o,a]=(0,r.useState)(!1),[s,l]=(0,r.useState)([{role:"assistant",content:"Hello! I can help you find answers in our knowledge base or create a support ticket. How can I assist you today?"}]),[d,c]=(0,r.useState)(""),[m,p]=(0,r.useState)(!1),x=(0,r.useRef)(null);(0,r.useEffect)(()=>{x.current?.scrollIntoView({behavior:"smooth"})},[s]);let g=async()=>{if(!d.trim()||m)return;let t={role:"user",content:d};l(e=>[...e,t]),c(""),p(!0);try{let r=localStorage.getItem("accessToken"),o=await fetch("/api/v1/ai/chat",{method:"POST",headers:{"Content-Type":"application/json",...r&&{Authorization:`Bearer ${r}`}},body:JSON.stringify({messages:[...s,t].map(e=>({role:e.role,content:e.content})),tenantId:e})}),a=await o.json();a.success?l(e=>[...e,{role:"assistant",content:a.data.response}]):l(e=>[...e,{role:"assistant",content:"Sorry, I encountered an error. Please try again."}])}catch(e){l(e=>[...e,{role:"assistant",content:"Sorry, I encountered an error. Please try again."}])}finally{p(!1)}};return(0,t.jsx)("div",{style:{position:"fixed",bottom:"2rem",right:"2rem",zIndex:1e3},children:o?(0,t.jsxs)("div",{style:{width:"400px",height:"600px",backgroundColor:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"12px",boxShadow:"0 4px 24px rgba(0, 0, 0, 0.3)",display:"flex",flexDirection:"column"},children:[(0,t.jsxs)("div",{style:{padding:"1rem",borderBottom:"1px solid var(--border-color)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,t.jsx)("h3",{style:{margin:0,fontSize:"1rem",fontWeight:600},children:"Support Chat"}),(0,t.jsx)("button",{onClick:()=>a(!1),style:{background:"none",border:"none",cursor:"pointer",color:"var(--text-primary)",padding:"0.25rem"},children:(0,t.jsx)(i.XMarkIcon,{className:"w-5 h-5"})})]}),(0,t.jsxs)("div",{style:{flex:1,overflowY:"auto",padding:"1rem",display:"flex",flexDirection:"column",gap:"1rem"},children:[s.map((e,r)=>(0,t.jsx)("div",{style:{alignSelf:"user"===e.role?"flex-end":"flex-start",maxWidth:"80%",padding:"0.75rem 1rem",borderRadius:"12px",backgroundColor:"user"===e.role?"var(--accent-primary)":"var(--bg-tertiary)",color:"user"===e.role?"white":"var(--text-primary)"},children:e.content},r)),m&&(0,t.jsx)("div",{style:{alignSelf:"flex-start",padding:"0.75rem 1rem",borderRadius:"12px",backgroundColor:"var(--bg-tertiary)",color:"var(--text-secondary)"},children:"Thinking..."}),(0,t.jsx)("div",{ref:x})]}),(0,t.jsxs)("div",{style:{padding:"1rem",borderTop:"1px solid var(--border-color)",display:"flex",gap:"0.5rem"},children:[(0,t.jsx)("input",{type:"text",value:d,onChange:e=>c(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),g())},placeholder:"Type your message...",disabled:m,style:{flex:1,padding:"0.75rem",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--bg-primary)",color:"var(--text-primary)"}}),(0,t.jsx)("button",{onClick:g,disabled:m||!d.trim(),style:{padding:"0.75rem",backgroundColor:"var(--accent-primary)",color:"white",border:"none",borderRadius:"8px",cursor:m||!d.trim()?"not-allowed":"pointer",opacity:m||!d.trim()?.6:1},children:(0,t.jsx)(n.PaperAirplaneIcon,{className:"w-5 h-5"})})]})]}):(0,t.jsx)("button",{onClick:()=>a(!0),style:{width:"64px",height:"64px",borderRadius:"50%",backgroundColor:"var(--accent-primary)",color:"white",border:"none",cursor:"pointer",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",style:{width:"24px",height:"24px"},children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.625 12a.375.375 0 11-.75 0 .375.375 0 01.75 0zm0 0H8.25m4.125 0a.375.375 0 11-.75 0 .375.375 0 01.75 0zm0 0H12m4.125 0a.375.375 0 11-.75 0 .375.375 0 01.75 0zm0 0h-.375M21 12c0 4.556-4.03 8.25-9 8.25a9.764 9.764 0 01-2.555-.337A5.972 5.972 0 015.41 20.97a5.969 5.969 0 01-.474-.065 4.48 4.48 0 00.978-2.025c.09-.457-.133-.901-.467-1.226C3.93 16.178 3 14.189 3 12c0-4.556 4.03-8.25 9-8.25s9 3.694 9 8.25z"})})})})}function l(){let e=(0,o.useParams)(),n=(0,o.useRouter)(),i=e?.slug,[l,d]=(0,r.useState)(null),[c,m]=(0,r.useState)(!0),[p,x]=(0,r.useState)(""),[g,y]=(0,r.useState)(!1),[h,u]=(0,r.useState)([]),[b,f]=(0,r.useState)(!1),[v,j]=(0,r.useState)(null);(0,r.useEffect)(()=>{let e=localStorage.getItem("accessToken");if(y(!!e),!e){let e=localStorage.getItem("publicToken");e?j(e):k()}S()},[i]),(0,r.useEffect)(()=>{l&&w()},[l,g,v]);let k=async e=>{try{let t=await fetch("/api/v1/public/token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tenantId:e||null})}),r=await t.json();r.success&&(localStorage.setItem("publicToken",r.data.token),localStorage.setItem("publicTokenId",r.data.publicId),j(r.data.token))}catch(e){}};(0,r.useEffect)(()=>{!l||g||v||k(l.id)},[l?.id,g]);let S=async()=>{try{m(!0);let e=await fetch(`/api/v1/tenants/${i}`),t=await e.json();t.success?(d(t.data),t.data.requiresLogin&&!g&&n.push(`/login?redirect=/tenant/${i}`)):x(t.error?.message||"Tenant not found")}catch(e){x("Failed to load tenant")}finally{m(!1)}},w=async()=>{try{f(!0);let e=localStorage.getItem("accessToken"),t=v||localStorage.getItem("publicToken"),r={"Content-Type":"application/json"};e?r.Authorization=`Bearer ${e}`:t&&(r.Authorization=`Bearer ${t}`);let o=await fetch(`/api/v1/tenants/${i}/tickets`,{headers:r}),a=await o.json();a.success&&(u(a.data),a.data.length>0&&localStorage.setItem(`tickets_${i}`,JSON.stringify(a.data)))}catch(t){let e=localStorage.getItem(`tickets_${i}`);if(e)try{u(JSON.parse(e))}catch(e){}}finally{f(!1)}};return c?(0,t.jsx)("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,t.jsx)("p",{children:"Loading..."})}):p||!l?(0,t.jsx)("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,t.jsxs)("div",{style:{textAlign:"center"},children:[(0,t.jsx)("h1",{style:{fontSize:"2rem",marginBottom:"1rem"},children:"Tenant Not Found"}),(0,t.jsx)("p",{style:{color:"var(--text-secondary)"},children:p||"The tenant you are looking for does not exist."})]})}):(0,t.jsxs)("div",{style:{minHeight:"100vh",backgroundColor:"var(--bg-primary)",color:"var(--text-primary)"},children:[(0,t.jsx)("header",{style:{padding:"2rem",borderBottom:"1px solid var(--border-color)",backgroundColor:"var(--bg-secondary)"},children:(0,t.jsxs)("div",{style:{maxWidth:"1200px",margin:"0 auto",display:"flex",alignItems:"center",gap:"1rem"},children:[l.logo&&(0,t.jsx)("img",{src:l.logo,alt:l.name,style:{width:"64px",height:"64px",borderRadius:"8px"}}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{style:{fontSize:"2rem",margin:0},children:l.name}),l.description&&(0,t.jsx)("p",{style:{color:"var(--text-secondary)",marginTop:"0.5rem"},children:l.description})]})]})}),(0,t.jsx)("nav",{style:{padding:"1rem 2rem",borderBottom:"1px solid var(--border-color)",backgroundColor:"var(--bg-secondary)"},children:(0,t.jsxs)("div",{style:{maxWidth:"1200px",margin:"0 auto",display:"flex",gap:"2rem"},children:[(0,t.jsx)(a.default,{href:`/tenant/${i}`,style:{color:"var(--accent-primary)",textDecoration:"none",fontWeight:600},children:"Home"}),(0,t.jsx)(a.default,{href:`/tenant/${i}/kb`,style:{color:"var(--text-primary)",textDecoration:"none"},children:"Knowledge Base"}),(0,t.jsx)(a.default,{href:`/tenant/${i}/submit`,style:{color:"var(--text-primary)",textDecoration:"none"},children:"Submit Ticket"})]})}),(0,t.jsx)("main",{style:{maxWidth:"1200px",margin:"0 auto",padding:"2rem"},children:(0,t.jsx)("div",{children:(0,t.jsxs)("div",{children:[(0,t.jsxs)("h2",{style:{fontSize:"1.5rem",marginBottom:"1rem"},children:["Welcome to ",l.name," Support"]}),(0,t.jsx)("p",{style:{color:"var(--text-secondary)",marginBottom:"2rem"},children:"We're here to help! Browse our knowledge base or submit a support ticket."}),(0,t.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem",marginBottom:"2rem"},children:[(0,t.jsxs)(a.default,{href:`/tenant/${i}/submit`,style:{padding:"1.5rem",backgroundColor:"var(--bg-secondary)",borderRadius:"8px",border:"1px solid var(--border-color)",textDecoration:"none",color:"var(--text-primary)",display:"block"},children:[(0,t.jsx)("h3",{style:{margin:0,marginBottom:"0.5rem"},children:"Submit a Ticket"}),(0,t.jsx)("p",{style:{margin:0,color:"var(--text-secondary)",fontSize:"0.875rem"},children:"Get help with your issue"})]}),(0,t.jsxs)(a.default,{href:`/tenant/${i}/kb`,style:{padding:"1.5rem",backgroundColor:"var(--bg-secondary)",borderRadius:"8px",border:"1px solid var(--border-color)",textDecoration:"none",color:"var(--text-primary)",display:"block"},children:[(0,t.jsx)("h3",{style:{margin:0,marginBottom:"0.5rem"},children:"Knowledge Base"}),(0,t.jsx)("p",{style:{margin:0,color:"var(--text-secondary)",fontSize:"0.875rem"},children:"Browse articles and FAQs"})]})]}),(g||v||localStorage.getItem("publicToken"))&&(0,t.jsxs)("div",{style:{marginBottom:"2rem"},children:[(0,t.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[(0,t.jsx)("h3",{style:{fontSize:"1.25rem",margin:0},children:"My Tickets"}),h.length>5&&(0,t.jsx)(a.default,{href:`/tenant/${i}/tickets`,style:{fontSize:"0.875rem",color:"var(--accent-primary)",textDecoration:"none"},children:"View All"})]}),b?(0,t.jsx)("p",{style:{color:"var(--text-secondary)"},children:"Loading tickets..."}):h.length>0?(0,t.jsx)("div",{style:{display:"grid",gap:"1rem"},children:h.slice(0,5).map(e=>(0,t.jsxs)(a.default,{href:`/tenant/${i}/tickets/${e.id}`,style:{padding:"1rem",backgroundColor:"var(--bg-secondary)",borderRadius:"8px",border:"1px solid var(--border-color)",textDecoration:"none",color:"var(--text-primary)",display:"block"},children:[(0,t.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"0.5rem"},children:[(0,t.jsx)("span",{style:{fontWeight:600},children:e.ticketNumber}),(0,t.jsx)("span",{style:{padding:"0.25rem 0.75rem",borderRadius:"12px",fontSize:"0.75rem",fontWeight:600,backgroundColor:"OPEN"===e.status||"NEW"===e.status?"rgba(59, 130, 246, 0.1)":"RESOLVED"===e.status||"CLOSED"===e.status?"rgba(16, 185, 129, 0.1)":"rgba(156, 163, 175, 0.1)",color:"OPEN"===e.status||"NEW"===e.status?"rgb(59, 130, 246)":"RESOLVED"===e.status||"CLOSED"===e.status?"rgb(16, 185, 129)":"rgb(156, 163, 175)"},children:e.status})]}),(0,t.jsx)("h4",{style:{margin:0,marginBottom:"0.25rem"},children:e.subject}),(0,t.jsx)("p",{style:{margin:0,color:"var(--text-secondary)",fontSize:"0.875rem"},children:new Date(e.createdAt).toLocaleDateString()})]},e.id))}):(0,t.jsx)("p",{style:{color:"var(--text-secondary)"},children:"No tickets yet. Submit a ticket to get started!"})]}),l.kbArticles.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{style:{fontSize:"1.25rem",marginBottom:"1rem"},children:"Popular Articles"}),(0,t.jsx)("div",{style:{display:"grid",gap:"1rem"},children:l.kbArticles.slice(0,5).map(e=>(0,t.jsx)(a.default,{href:`/tenant/${i}/kb/${e.id}`,style:{padding:"1rem",backgroundColor:"var(--bg-secondary)",borderRadius:"8px",border:"1px solid var(--border-color)",textDecoration:"none",color:"var(--text-primary)",display:"block"},children:e.title},e.id))})]})]})})}),(0,t.jsx)(s,{tenantId:l.id})]})}e.s(["default",()=>l],37940)}]);