(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,83579,e=>{"use strict";var a=e.i(43476),r=e.i(71645),t=e.i(18566),o=e.i(18228);function l(){(0,t.useRouter)();let[e,l]=(0,r.useState)(null),[i,n]=(0,r.useState)(!0),[s,d]=(0,r.useState)(!1),[c,m]=(0,r.useState)(""),[p,u]=(0,r.useState)(""),[g,h]=(0,r.useState)(null),[y,v]=(0,r.useState)(null),[x,b]=(0,r.useState)("details"),[j,f]=(0,r.useState)(null),[S,N]=(0,r.useState)(!1),[w,B]=(0,r.useState)(""),[T,P]=(0,r.useState)(""),[k,z]=(0,r.useState)({providerName:"",protocol:o.EmailProtocol.SMTP,host:"",port:587,username:"",password:"",encryption:o.EmailEncryption.TLS,pollingIntervalMinutes:5});(0,r.useEffect)(()=>{E(),"email"===x&&C()},[x]);let E=async()=>{try{let e=localStorage.getItem("accessToken"),a=await fetch("/api/v1/organizations/me",{headers:{Authorization:`Bearer ${e}`}});if(!a.ok)throw Error("Failed to fetch organization");let r=await a.json();l(r.organization),r.organization?.logo&&v(r.organization.logo)}catch(e){m(e.message)}finally{n(!1)}},C=async()=>{try{let e=localStorage.getItem("accessToken"),a=await fetch("/api/v1/organizations/email-config",{headers:{Authorization:`Bearer ${e}`}});if(!a.ok){if(404===a.status)return void f(null);throw Error("Failed to fetch email configuration")}let r=await a.json();r.success&&r.data?(f(r.data),z({providerName:r.data.providerName||"",protocol:r.data.protocol,host:r.data.host||"",port:r.data.port||587,username:r.data.username||"",password:"",encryption:r.data.encryption||o.EmailEncryption.TLS,pollingIntervalMinutes:r.data.pollingIntervalMinutes||5})):f(null)}catch(e){console.error("Error fetching email config:",e),f(null)}},F=async e=>{e.preventDefault(),N(!0),B(""),P("");try{let e=localStorage.getItem("accessToken"),a=await fetch("/api/v1/organizations/email-config",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify(k)}),r=await a.json();if(!a.ok)throw Error(r.error?.message||"Failed to save email configuration");P("Email configuration saved successfully"),f(r.data)}catch(e){B(e.message)}finally{N(!1)}},I=async()=>{if(g&&e){d(!0),m(""),u("");try{let a=localStorage.getItem("accessToken"),r=new FormData;r.append("file",g),r.append("organizationId",e.id);let t=await fetch("/api/v1/organizations/upload-logo",{method:"POST",headers:{Authorization:`Bearer ${a}`},body:r}),o=await t.json();if(!t.ok)throw Error(o.error||"Failed to upload logo");u("Logo uploaded successfully"),h(null),o.logoUrl&&(v(o.logoUrl),l({...e,logo:o.logoUrl}))}catch(e){m(e.message)}finally{d(!1)}}},M=async a=>{if(a.preventDefault(),e){d(!0),m(""),u("");try{let a=localStorage.getItem("accessToken"),r=await fetch("/api/v1/organizations/me",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify({name:e.name,description:e.description})}),t=await r.json();if(!r.ok)throw Error(t.error||"Failed to update organization");u("Organization updated successfully"),l(t.organization||t)}catch(e){m(e.message)}finally{d(!1)}}};return i?(0,a.jsx)("div",{children:"Loading organization settings..."}):e?(0,a.jsxs)("div",{style:{padding:"2rem",maxWidth:"1000px",margin:"0 auto"},children:[(0,a.jsx)("h1",{style:{marginBottom:"2rem"},children:"Organization Settings"}),(0,a.jsxs)("div",{style:{display:"flex",gap:"1rem",borderBottom:"1px solid var(--border-color)",marginBottom:"2rem"},children:[(0,a.jsx)("button",{onClick:()=>b("details"),style:{padding:"0.75rem 1.5rem",border:"none",background:"none",borderBottom:"details"===x?"2px solid var(--accent-primary)":"2px solid transparent",cursor:"pointer",color:"details"===x?"var(--accent-primary)":"var(--text-secondary)",fontWeight:"details"===x?600:400},children:"Details"}),(0,a.jsx)("button",{onClick:()=>b("email"),style:{padding:"0.75rem 1.5rem",border:"none",background:"none",borderBottom:"email"===x?"2px solid var(--accent-primary)":"2px solid transparent",cursor:"pointer",color:"email"===x?"var(--accent-primary)":"var(--text-secondary)",fontWeight:"email"===x?600:400},children:"Email (SMTP)"})]}),c&&(0,a.jsx)("div",{style:{padding:"0.75rem",backgroundColor:"rgba(239, 68, 68, 0.1)",border:"1px solid var(--error)",borderRadius:"0.5rem",marginBottom:"1rem",color:"var(--error)"},children:c}),p&&(0,a.jsx)("div",{style:{padding:"0.75rem",backgroundColor:"rgba(34, 197, 94, 0.1)",border:"1px solid var(--success)",borderRadius:"0.5rem",marginBottom:"1rem",color:"var(--success)"},children:p}),"details"===x&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"card",style:{padding:"2rem",marginBottom:"2rem"},children:[(0,a.jsx)("h2",{style:{marginBottom:"1.5rem"},children:"Logo"}),(0,a.jsxs)("div",{style:{display:"flex",gap:"1.5rem",alignItems:"flex-start"},children:[y&&(0,a.jsx)("img",{src:y,alt:"Organization logo",style:{width:"120px",height:"120px",objectFit:"contain",borderRadius:"0.5rem",border:"1px solid var(--border)"}}),(0,a.jsxs)("div",{style:{flex:1},children:[(0,a.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{let a=e.target.files?.[0];if(a){h(a);let e=new FileReader;e.onloadend=()=>{v(e.result)},e.readAsDataURL(a)}},style:{marginBottom:"1rem"},disabled:s}),g&&(0,a.jsx)("button",{type:"button",className:"btn btn-primary",onClick:I,disabled:s,children:s?"Uploading...":"Upload Logo"})]})]})]}),(0,a.jsxs)("div",{className:"card",style:{padding:"2rem"},children:[(0,a.jsx)("h2",{style:{marginBottom:"1.5rem"},children:"Organization Details"}),(0,a.jsxs)("form",{onSubmit:M,children:[(0,a.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,a.jsx)("label",{className:"label",htmlFor:"name",children:"Organization Name"}),(0,a.jsx)("input",{id:"name",type:"text",className:"input",value:e.name,onChange:a=>l({...e,name:a.target.value}),required:!0,disabled:s})]}),(0,a.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,a.jsx)("label",{className:"label",htmlFor:"slug",children:"Slug"}),(0,a.jsx)("input",{id:"slug",type:"text",className:"input",value:e.slug,disabled:!0,style:{backgroundColor:"var(--bg-secondary)",color:"var(--text-secondary)"}}),(0,a.jsx)("p",{style:{fontSize:"0.875rem",color:"var(--text-secondary)",marginTop:"0.25rem"},children:"Slug cannot be changed after creation"})]}),(0,a.jsxs)("div",{style:{marginBottom:"1.5rem"},children:[(0,a.jsx)("label",{className:"label",htmlFor:"description",children:"Description"}),(0,a.jsx)("textarea",{id:"description",className:"input",value:e.description||"",onChange:a=>l({...e,description:a.target.value}),rows:4,disabled:s})]}),(0,a.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:s,children:s?"Saving...":"Save Changes"})]})]})]}),"email"===x&&(0,a.jsxs)("div",{className:"card",style:{padding:"2rem"},children:[(0,a.jsx)("h2",{style:{marginBottom:"1.5rem"},children:"SMTP Email Configuration"}),w&&(0,a.jsx)("div",{style:{padding:"0.75rem",backgroundColor:"rgba(239, 68, 68, 0.1)",border:"1px solid var(--error)",borderRadius:"0.5rem",marginBottom:"1rem",color:"var(--error)"},children:w}),T&&(0,a.jsx)("div",{style:{padding:"0.75rem",backgroundColor:"rgba(34, 197, 94, 0.1)",border:"1px solid var(--success)",borderRadius:"0.5rem",marginBottom:"1rem",color:"var(--success)"},children:T}),(0,a.jsxs)("form",{onSubmit:F,children:[(0,a.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,a.jsx)("label",{className:"label",htmlFor:"providerName",children:"Provider Name (Optional)"}),(0,a.jsx)("input",{id:"providerName",type:"text",className:"input",value:k.providerName,onChange:e=>z({...k,providerName:e.target.value}),placeholder:"e.g., Gmail, SendGrid, AWS SES",disabled:S})]}),(0,a.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,a.jsx)("label",{className:"label",htmlFor:"protocol",children:"Protocol *"}),(0,a.jsxs)("select",{id:"protocol",className:"input",value:k.protocol,onChange:e=>z({...k,protocol:e.target.value}),required:!0,disabled:S,children:[(0,a.jsx)("option",{value:o.EmailProtocol.SMTP,children:"SMTP"}),(0,a.jsx)("option",{value:o.EmailProtocol.IMAP,children:"IMAP"}),(0,a.jsx)("option",{value:o.EmailProtocol.POP3,children:"POP3"})]})]}),(0,a.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,a.jsx)("label",{className:"label",htmlFor:"host",children:"SMTP Host *"}),(0,a.jsx)("input",{id:"host",type:"text",className:"input",value:k.host,onChange:e=>z({...k,host:e.target.value}),placeholder:"e.g., smtp.gmail.com, smtp.sendgrid.net",required:!0,disabled:S})]}),(0,a.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,a.jsx)("label",{className:"label",htmlFor:"port",children:"Port *"}),(0,a.jsx)("input",{id:"port",type:"number",className:"input",value:k.port,onChange:e=>z({...k,port:parseInt(e.target.value)||587}),min:"1",max:"65535",required:!0,disabled:S}),(0,a.jsx)("small",{style:{color:"var(--text-secondary)",fontSize:"0.875rem",marginTop:"0.25rem",display:"block"},children:"Common ports: 587 (TLS), 465 (SSL), 25 (unencrypted)"})]}),(0,a.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,a.jsx)("label",{className:"label",htmlFor:"username",children:"Username / Email *"}),(0,a.jsx)("input",{id:"username",type:"text",className:"input",value:k.username,onChange:e=>z({...k,username:e.target.value}),placeholder:"your-email@example.com",required:!0,disabled:S})]}),(0,a.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,a.jsx)("label",{className:"label",htmlFor:"password",children:"Password *"}),(0,a.jsx)("input",{id:"password",type:"password",className:"input",value:k.password,onChange:e=>z({...k,password:e.target.value}),placeholder:j?"Leave blank to keep current password":"Enter SMTP password",required:!j,disabled:S}),j&&(0,a.jsx)("small",{style:{color:"var(--text-secondary)",fontSize:"0.875rem",marginTop:"0.25rem",display:"block"},children:"Leave blank to keep the current password"})]}),(0,a.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,a.jsx)("label",{className:"label",htmlFor:"encryption",children:"Encryption *"}),(0,a.jsxs)("select",{id:"encryption",className:"input",value:k.encryption,onChange:e=>z({...k,encryption:e.target.value}),required:!0,disabled:S,children:[(0,a.jsx)("option",{value:o.EmailEncryption.NONE,children:"None"}),(0,a.jsx)("option",{value:o.EmailEncryption.SSL,children:"SSL"}),(0,a.jsx)("option",{value:o.EmailEncryption.TLS,children:"TLS"})]}),(0,a.jsx)("small",{style:{color:"var(--text-secondary)",fontSize:"0.875rem",marginTop:"0.25rem",display:"block"},children:"Recommended: TLS (port 587) or SSL (port 465)"})]}),(0,a.jsxs)("div",{style:{marginBottom:"1.5rem"},children:[(0,a.jsx)("label",{className:"label",htmlFor:"pollingIntervalMinutes",children:"Polling Interval (Minutes)"}),(0,a.jsx)("input",{id:"pollingIntervalMinutes",type:"number",className:"input",value:k.pollingIntervalMinutes,onChange:e=>z({...k,pollingIntervalMinutes:parseInt(e.target.value)||5}),min:"1",max:"60",disabled:S}),(0,a.jsx)("small",{style:{color:"var(--text-secondary)",fontSize:"0.875rem",marginTop:"0.25rem",display:"block"},children:"How often to check for new emails (for IMAP/POP3)"})]}),(0,a.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:S,children:S?"Saving...":j?"Update Configuration":"Save Configuration"})]})]})]}):(0,a.jsx)("div",{children:"Organization not found"})}e.s(["default",()=>l])}]);