module.exports=[96853,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(38246);function f(){let a=(0,d.useParams)(),[f,g]=(0,c.useState)(null),[h,i]=(0,c.useState)(!0),[j,k]=(0,c.useState)(!1);(0,c.useEffect)(()=>{a.id&&l(a.id)},[a.id]);let l=async a=>{try{i(!0);let b=localStorage.getItem("accessToken"),c=await fetch(`/api/v1/changes/${a}`,{headers:b?{Authorization:`Bearer ${b}`}:{}}),d=await c.json();d.success&&g(d.data.changeRequest)}catch(a){console.error("Failed to load change request:",a)}finally{i(!1)}},m=async()=>{try{let b=localStorage.getItem("accessToken"),c=await fetch(`/api/v1/changes/${a.id}/submit`,{method:"POST",headers:b?{Authorization:`Bearer ${b}`}:{}});(await c.json()).success&&await l(a.id)}catch(a){console.error("Failed to submit change request:",a)}},n=async(b,c,d)=>{try{k(!0);let e=localStorage.getItem("accessToken"),f=await fetch("/api/v1/auth/me",{headers:e?{Authorization:`Bearer ${e}`}:{}}),g=await f.json(),h=await fetch(`/api/v1/changes/${a.id}/approve`,{method:"POST",headers:{"Content-Type":"application/json",...e&&{Authorization:`Bearer ${e}`}},body:JSON.stringify({approverId:g.data?.user?.id||"",stage:b,approved:c,comments:d})});(await h.json()).success&&await l(a.id)}catch(a){console.error("Failed to approve change request:",a)}finally{k(!1)}};return h?(0,b.jsx)("div",{style:{padding:"2rem"},children:"Loading change request..."}):f?(0,b.jsxs)("div",{style:{padding:"2rem",maxWidth:"1200px",margin:"0 auto"},children:[(0,b.jsx)("div",{style:{marginBottom:"2rem"},children:(0,b.jsx)(e.default,{href:"/changes",style:{color:"var(--accent-primary)",textDecoration:"none"},children:"â† Back to Changes"})}),(0,b.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start",marginBottom:"2rem"},children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{style:{marginBottom:"0.5rem"},children:f.title}),(0,b.jsx)("p",{style:{color:"var(--text-secondary)",margin:0},children:f.changeNumber})]}),"DRAFT"===f.status&&(0,b.jsx)("button",{onClick:m,style:{padding:"0.5rem 1rem",backgroundColor:"var(--accent-primary)",color:"white",border:"none",borderRadius:"6px",cursor:"pointer"},children:"Submit for Approval"})]}),(0,b.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"2rem",marginBottom:"2rem"},children:[(0,b.jsxs)("div",{style:{padding:"1.5rem",border:"1px solid var(--border-color)",borderRadius:"8px",backgroundColor:"var(--bg-secondary)"},children:[(0,b.jsx)("h2",{style:{marginTop:0,marginBottom:"1rem"},children:"Details"}),(0,b.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("strong",{children:"Status:"})," ",f.status]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("strong",{children:"Type:"})," ",f.type]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("strong",{children:"Priority:"})," ",f.priority]}),f.riskLevel&&(0,b.jsxs)("div",{children:[(0,b.jsx)("strong",{children:"Risk Level:"})," ",f.riskLevel]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("strong",{children:"Requester:"})," ",`${f.requester.firstName||""} ${f.requester.lastName||""}`.trim()||f.requester.email]}),f.relatedTicket&&(0,b.jsxs)("div",{children:[(0,b.jsx)("strong",{children:"Related Ticket:"})," ",(0,b.jsxs)(e.default,{href:`/tickets/${f.relatedTicket.id}`,style:{color:"var(--accent-primary)"},children:[f.relatedTicket.ticketNumber," - ",f.relatedTicket.subject]})]})]})]}),(0,b.jsxs)("div",{style:{padding:"1.5rem",border:"1px solid var(--border-color)",borderRadius:"8px",backgroundColor:"var(--bg-secondary)"},children:[(0,b.jsx)("h2",{style:{marginTop:0,marginBottom:"1rem"},children:"Timeline"}),(0,b.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[f.plannedStartDate&&(0,b.jsxs)("div",{children:[(0,b.jsx)("strong",{children:"Planned Start:"})," ",new Date(f.plannedStartDate).toLocaleDateString()]}),f.plannedEndDate&&(0,b.jsxs)("div",{children:[(0,b.jsx)("strong",{children:"Planned End:"})," ",new Date(f.plannedEndDate).toLocaleDateString()]}),f.actualStartDate&&(0,b.jsxs)("div",{children:[(0,b.jsx)("strong",{children:"Actual Start:"})," ",new Date(f.actualStartDate).toLocaleDateString()]}),f.actualEndDate&&(0,b.jsxs)("div",{children:[(0,b.jsx)("strong",{children:"Actual End:"})," ",new Date(f.actualEndDate).toLocaleDateString()]})]})]})]}),(0,b.jsxs)("div",{style:{padding:"1.5rem",border:"1px solid var(--border-color)",borderRadius:"8px",backgroundColor:"var(--bg-secondary)",marginBottom:"2rem"},children:[(0,b.jsx)("h2",{style:{marginTop:0,marginBottom:"1rem"},children:"Description"}),(0,b.jsx)("p",{style:{whiteSpace:"pre-wrap"},children:f.description})]}),f.approvals&&f.approvals.length>0&&(0,b.jsxs)("div",{style:{padding:"1.5rem",border:"1px solid var(--border-color)",borderRadius:"8px",backgroundColor:"var(--bg-secondary)",marginBottom:"2rem"},children:[(0,b.jsx)("h2",{style:{marginTop:0,marginBottom:"1rem"},children:"Approvals"}),(0,b.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:f.approvals.map(a=>(0,b.jsxs)("div",{style:{padding:"1rem",border:"1px solid var(--border-color)",borderRadius:"6px"},children:[(0,b.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start",marginBottom:"0.5rem"},children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("strong",{children:["Stage ",a.stage,":"]})," ",a.approver.firstName||""," ",a.approver.lastName||""," (",a.approver.email,")"]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("strong",{children:"Status:"})," ",a.status]})]}),a.comments&&(0,b.jsxs)("div",{style:{marginTop:"0.5rem",color:"var(--text-secondary)"},children:[(0,b.jsx)("strong",{children:"Comments:"})," ",a.comments]}),"PENDING"===a.status&&"IN_REVIEW"===f.status&&(0,b.jsxs)("div",{style:{marginTop:"1rem",display:"flex",gap:"0.5rem"},children:[(0,b.jsx)("button",{onClick:()=>{let b=prompt("Enter approval comments (optional):");n(a.stage,!0,b||void 0)},disabled:j,style:{padding:"0.5rem 1rem",backgroundColor:"green",color:"white",border:"none",borderRadius:"6px",cursor:j?"not-allowed":"pointer"},children:"Approve"}),(0,b.jsx)("button",{onClick:()=>{let b=prompt("Enter rejection comments (optional):");n(a.stage,!1,b||void 0)},disabled:j,style:{padding:"0.5rem 1rem",backgroundColor:"red",color:"white",border:"none",borderRadius:"6px",cursor:j?"not-allowed":"pointer"},children:"Reject"})]})]},a.id))})]}),f.implementationNotes&&(0,b.jsxs)("div",{style:{padding:"1.5rem",border:"1px solid var(--border-color)",borderRadius:"8px",backgroundColor:"var(--bg-secondary)"},children:[(0,b.jsx)("h2",{style:{marginTop:0,marginBottom:"1rem"},children:"Implementation Notes"}),(0,b.jsx)("p",{style:{whiteSpace:"pre-wrap"},children:f.implementationNotes})]})]}):(0,b.jsxs)("div",{style:{padding:"2rem"},children:[(0,b.jsx)("p",{children:"Change request not found"}),(0,b.jsx)(e.default,{href:"/changes",children:"Back to Changes"})]})}a.s(["default",()=>f])}];

//# sourceMappingURL=app_changes_%5Bid%5D_page_tsx_13dd01a6._.js.map