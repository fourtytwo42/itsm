(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,55156,e=>{"use strict";var t=e.i(18050),r=e.i(71645),a=e.i(18228),l=e.i(44452),s=e.i(44735);function i(){let[e,i]=(0,r.useState)([]),[n,o]=(0,r.useState)(!0),[d,c]=(0,r.useState)(""),[m,h]=(0,r.useState)({}),[p,x]=(0,r.useState)({search:"",role:"",isActive:"",tenantId:""}),[g,y]=(0,r.useState)([]),[u,v]=(0,r.useState)("createdAt"),[f,j]=(0,r.useState)("desc");(0,r.useEffect)(()=>{S(),b()},[p,u,f]),(0,r.useEffect)(()=>{e.length>0&&A()},[e]);let b=async()=>{try{let e=localStorage.getItem("accessToken"),t=await fetch("/api/v1/admin/tenants",{headers:e?{Authorization:`Bearer ${e}`}:{}}),r=await t.json();r.success&&y(r.data.tenants||r.data||[])}catch(e){console.error("Failed to load tenants:",e)}},S=async()=>{try{o(!0);let e=localStorage.getItem("accessToken"),t=new URLSearchParams;p.search&&t.append("search",p.search),p.role&&t.append("role",p.role),""!==p.isActive&&t.append("isActive",p.isActive),p.tenantId&&t.append("tenantId",p.tenantId),t.append("sort",u),t.append("order",f);let r=await fetch(`/api/v1/agent/users?${t.toString()}`,{headers:e?{Authorization:`Bearer ${e}`}:{}}),l=await r.json();if(l.success){let e=(l.data?.users||l.data||[]).map(e=>({...e,role:e.roles&&e.roles.length>0?e.roles[0]:a.RoleName.END_USER}));i(e)}else c(l.error?.message||"Failed to load users")}catch(e){c("An unexpected error occurred")}finally{o(!1)}},A=async()=>{let t=localStorage.getItem("accessToken"),r={},l=e.filter(e=>e.role!==a.RoleName.ADMIN&&(e.role===a.RoleName.AGENT||e.role===a.RoleName.IT_MANAGER||e.role===a.RoleName.END_USER));await Promise.all(l.map(async e=>{try{let a=await fetch(`/api/v1/agent/users/${e.id}/tenants`,{headers:t?{Authorization:`Bearer ${t}`}:{}}),l=await a.json();l.success&&(r[e.id]=l.data)}catch(t){console.error(`Failed to load tenant assignments for user ${e.id}:`,t)}})),h(r)},N=({field:e,label:r,align:a="left"})=>(0,t.jsx)("th",{style:{padding:"0.875rem 1rem",textAlign:a,fontWeight:600,fontSize:"0.875rem",color:"var(--text-secondary)",cursor:"pointer",userSelect:"none"},onClick:()=>{u===e?j("asc"===f?"desc":"asc"):(v(e),j("desc"))},children:(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem",justifyContent:"right"===a?"flex-end":"center"===a?"center":"flex-start"},children:[r,u===e&&("asc"===f?(0,t.jsx)(l.ChevronUpIcon,{style:{width:"0.875rem",height:"0.875rem"}}):(0,t.jsx)(s.ChevronDownIcon,{style:{width:"0.875rem",height:"0.875rem"}}))]})});return n?(0,t.jsx)("div",{style:{padding:"2rem"},children:"Loading users..."}):(0,t.jsxs)("div",{style:{padding:"2rem",maxWidth:"1400px",margin:"0 auto"},children:[(0,t.jsx)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"2rem"},children:(0,t.jsx)("h1",{style:{margin:0},children:"Users"})}),d&&(0,t.jsx)("div",{style:{padding:"0.75rem",backgroundColor:"rgba(239, 68, 68, 0.1)",border:"1px solid var(--error)",borderRadius:"0.5rem",marginBottom:"1rem",color:"var(--error)"},children:d}),(0,t.jsx)("div",{className:"card",style:{padding:"1rem",marginBottom:"1.5rem"},children:(0,t.jsxs)("div",{style:{display:"flex",gap:"0.75rem",flexWrap:"wrap",alignItems:"center"},children:[(0,t.jsx)("input",{type:"text",placeholder:"Search by email, name...",value:p.search,onChange:e=>x({...p,search:e.target.value}),className:"input",style:{flex:1,minWidth:"250px",maxWidth:"400px"}}),(0,t.jsxs)("select",{value:p.role,onChange:e=>x({...p,role:e.target.value}),className:"input",style:{minWidth:"120px",maxWidth:"150px"},children:[(0,t.jsx)("option",{value:"",children:"All Roles"}),Object.values(a.RoleName).filter(e=>e!==a.RoleName.GLOBAL_ADMIN).map(e=>(0,t.jsx)("option",{value:e,children:e.replace("_"," ")},e))]}),(0,t.jsxs)("select",{value:p.isActive,onChange:e=>x({...p,isActive:e.target.value}),className:"input",style:{minWidth:"120px",maxWidth:"150px"},children:[(0,t.jsx)("option",{value:"",children:"All Status"}),(0,t.jsx)("option",{value:"true",children:"Active"}),(0,t.jsx)("option",{value:"false",children:"Inactive"})]}),(0,t.jsxs)("select",{value:p.tenantId,onChange:e=>x({...p,tenantId:e.target.value}),className:"input",style:{minWidth:"150px",maxWidth:"200px"},children:[(0,t.jsx)("option",{value:"",children:"All Tenants"}),g.map(e=>(0,t.jsx)("option",{value:e.id,children:e.name},e.id))]})]})}),(0,t.jsx)("div",{className:"card",style:{overflowX:"auto",padding:0},children:0===e.length?(0,t.jsxs)("div",{style:{padding:"3rem",textAlign:"center",color:"var(--text-secondary)"},children:[(0,t.jsx)("p",{style:{margin:0,fontSize:"1rem"},children:"No users found"}),(0,t.jsx)("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.875rem"},children:"Try adjusting your filters"})]}):(0,t.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{style:{borderBottom:"2px solid var(--border-color)",backgroundColor:"var(--bg-secondary)"},children:[(0,t.jsx)(N,{field:"email",label:"Email"}),(0,t.jsx)(N,{field:"firstName",label:"Name"}),(0,t.jsx)(N,{field:"role",label:"Role"}),(0,t.jsx)("th",{style:{padding:"0.875rem 1rem",textAlign:"left",fontWeight:600,fontSize:"0.875rem",color:"var(--text-secondary)"},children:"Tenants"}),(0,t.jsx)(N,{field:"isActive",label:"Status"}),(0,t.jsx)(N,{field:"emailVerified",label:"Verified",align:"center"}),(0,t.jsx)(N,{field:"createdAt",label:"Created"})]})}),(0,t.jsx)("tbody",{children:e.map(e=>(0,t.jsxs)("tr",{style:{borderBottom:"1px solid var(--border-color)",transition:"background-color 0.15s ease"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="var(--bg-secondary)"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="transparent"},children:[(0,t.jsx)("td",{style:{padding:"1rem",fontSize:"0.875rem"},children:(0,t.jsx)("div",{style:{fontWeight:500,color:"var(--text-primary)"},children:e.email})}),(0,t.jsx)("td",{style:{padding:"1rem",fontSize:"0.875rem",color:"var(--text-primary)"},children:e.firstName||e.lastName?`${e.firstName||""} ${e.lastName||""}`.trim():(0,t.jsx)("span",{style:{color:"var(--text-secondary)",fontStyle:"italic"},children:"-"})}),(0,t.jsx)("td",{style:{padding:"1rem"},children:(0,t.jsx)("span",{style:{padding:"0.25rem 0.5rem",backgroundColor:"var(--bg-tertiary)",borderRadius:"4px",fontSize:"0.75rem",fontWeight:500,color:"var(--text-primary)"},children:e.role.replace("_"," ")})}),(0,t.jsx)("td",{style:{padding:"1rem",maxWidth:"200px"},children:e.role===a.RoleName.ADMIN?(0,t.jsx)("span",{style:{fontSize:"0.8125rem",color:"var(--text-secondary)"},children:"All tenants"}):e.role===a.RoleName.AGENT||e.role===a.RoleName.END_USER||e.role===a.RoleName.IT_MANAGER?(0,t.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.25rem"},children:m[e.id]&&m[e.id].length>0?(0,t.jsxs)(t.Fragment,{children:[m[e.id].slice(0,3).map(e=>(0,t.jsx)("span",{style:{padding:"0.1875rem 0.5rem",backgroundColor:"var(--bg-tertiary)",borderRadius:"4px",fontSize:"0.75rem",color:"var(--text-primary)",whiteSpace:"nowrap"},children:e.tenant.name},e.id)),m[e.id].length>3&&(0,t.jsxs)("span",{style:{fontSize:"0.75rem",color:"var(--text-secondary)",alignSelf:"center"},children:["+",m[e.id].length-3]})]}):(0,t.jsx)("span",{style:{fontSize:"0.75rem",color:"var(--text-secondary)",fontStyle:"italic"},children:"No tenants"})}):(0,t.jsx)("span",{style:{fontSize:"0.8125rem",color:"var(--text-secondary)"},children:"-"})}),(0,t.jsx)("td",{style:{padding:"1rem"},children:(0,t.jsx)("span",{style:{padding:"0.25rem 0.625rem",backgroundColor:e.isActive?"rgba(34, 197, 94, 0.15)":"rgba(239, 68, 68, 0.15)",color:e.isActive?"rgb(34, 197, 94)":"rgb(239, 68, 68)",borderRadius:"4px",fontSize:"0.75rem",fontWeight:500,display:"inline-block"},children:e.isActive?"Active":"Inactive"})}),(0,t.jsx)("td",{style:{padding:"1rem",textAlign:"center"},children:(0,t.jsx)("span",{style:{fontSize:"1rem",color:e.emailVerified?"rgb(34, 197, 94)":"var(--text-secondary)",fontWeight:e.emailVerified?600:400},children:e.emailVerified?"✓":"✗"})}),(0,t.jsx)("td",{style:{padding:"1rem",fontSize:"0.8125rem",color:"var(--text-secondary)"},children:new Date(e.createdAt).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})})]},e.id))})]})})]})}e.s(["default",()=>i])}]);