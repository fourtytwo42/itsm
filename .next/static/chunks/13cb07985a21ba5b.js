(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,41598,e=>{"use strict";var r=e.i(43476),t=e.i(71645),s=e.i(22016),a=e.i(44452),i=e.i(44735);function o({tickets:e,onStatusChange:o,showQuickActions:d=!0,onRefresh:l,disableClientSort:n=!1,onSortChange:c,currentSortField:m,currentSortOrder:g}){let[u,x]=(0,t.useState)("createdAt"),[h,p]=(0,t.useState)("desc"),y=n&&void 0!==m?m:u,b=n&&void 0!==g?g:h,[f,j]=(0,t.useState)({}),v=async(e,r)=>{if(o){j(r=>({...r,[e]:!0}));try{await o(e,r),l&&l()}catch(e){console.error("Failed to update status:",e)}finally{j(r=>({...r,[e]:!1}))}}},k=n?e:[...e].sort((e,r)=>{let t,s;switch(y){case"ticketNumber":t=e.ticketNumber,s=r.ticketNumber;break;case"subject":t=e.subject,s=r.subject;break;case"status":t=e.status,s=r.status;break;case"priority":t=e.priority,s=r.priority;break;case"createdAt":default:t=new Date(e.createdAt).getTime(),s=new Date(r.createdAt).getTime();break;case"updatedAt":t=new Date(e.updatedAt).getTime(),s=new Date(r.updatedAt).getTime();break;case"requester":t=e.requester?.email||e.requesterEmail||"",s=r.requester?.email||r.requesterEmail||"";break;case"assignee":t=e.assignee?.email||"",s=r.assignee?.email||""}return t<s?"asc"===b?-1:1:t>s?"asc"===b?1:-1:0}),S=({field:e,label:t})=>(0,r.jsx)("th",{style:{padding:"0.875rem 1rem",textAlign:"left",fontWeight:600,fontSize:"0.875rem",cursor:"pointer",userSelect:"none",position:"relative"},onClick:()=>{n&&c?c(e,y===e&&"desc"===b?"asc":"desc"):y===e?p("asc"===h?"desc":"asc"):(x(e),p("desc"))},children:(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[t,y===e&&("asc"===b?(0,r.jsx)(a.ChevronUpIcon,{style:{width:"0.875rem",height:"0.875rem"}}):(0,r.jsx)(i.ChevronDownIcon,{style:{width:"0.875rem",height:"0.875rem"}}))]})});return 0===e.length?(0,r.jsx)("div",{className:"card",style:{padding:"3rem",textAlign:"center",color:"var(--text-secondary)"},children:"No tickets found."}):(0,r.jsx)("div",{className:"card",style:{overflowX:"auto",padding:0},children:(0,r.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{style:{borderBottom:"2px solid var(--border-color)",backgroundColor:"var(--bg-secondary)"},children:[(0,r.jsx)(S,{field:"ticketNumber",label:"Ticket #"}),(0,r.jsx)(S,{field:"subject",label:"Subject"}),(0,r.jsx)(S,{field:"requester",label:"Requester"}),(0,r.jsx)(S,{field:"assignee",label:"Assignee"}),(0,r.jsx)(S,{field:"status",label:"Status"}),(0,r.jsx)(S,{field:"priority",label:"Priority"}),(0,r.jsx)(S,{field:"createdAt",label:"Created"}),d&&(0,r.jsx)("th",{style:{padding:"0.875rem 1rem",textAlign:"right",fontWeight:600,fontSize:"0.875rem"},children:"Actions"})]})}),(0,r.jsx)("tbody",{children:k.map(e=>(0,r.jsxs)("tr",{style:{borderBottom:"1px solid var(--border-color)"},children:[(0,r.jsx)("td",{style:{padding:"1rem"},children:(0,r.jsx)(s.default,{href:`/tickets/${e.id}`,style:{color:"var(--accent-primary)",textDecoration:"none",fontWeight:500},children:e.ticketNumber})}),(0,r.jsx)("td",{style:{padding:"1rem"},children:(0,r.jsx)(s.default,{href:`/tickets/${e.id}`,style:{color:"var(--text-primary)",textDecoration:"none"},children:e.subject})}),(0,r.jsx)("td",{style:{padding:"1rem",color:"var(--text-secondary)"},children:e.requester?[e.requester.firstName,e.requester.lastName].filter(Boolean).join(" ")||e.requester.email:e.requesterName||e.requesterEmail||"Unknown"}),(0,r.jsx)("td",{style:{padding:"1rem",color:"var(--text-secondary)"},children:e.assignee?[e.assignee.firstName,e.assignee.lastName].filter(Boolean).join(" ")||e.assignee.email:"Unassigned"}),(0,r.jsx)("td",{style:{padding:"1rem"},children:(0,r.jsx)("span",{style:{padding:"0.25rem 0.75rem",backgroundColor:(e=>{switch(e){case"NEW":return"rgba(59, 130, 246, 0.15)";case"IN_PROGRESS":return"rgba(234, 179, 8, 0.15)";case"RESOLVED":return"rgba(34, 197, 94, 0.15)";case"CLOSED":return"rgba(107, 114, 128, 0.15)";default:return"var(--bg-tertiary)"}})(e.status),color:(e=>{switch(e){case"NEW":return"rgb(59, 130, 246)";case"IN_PROGRESS":return"rgb(234, 179, 8)";case"RESOLVED":return"rgb(34, 197, 94)";case"CLOSED":return"rgb(107, 114, 128)";default:return"var(--text-secondary)"}})(e.status),borderRadius:"4px",fontSize:"0.75rem",fontWeight:500,textTransform:"capitalize"},children:e.status.replace("_"," ")})}),(0,r.jsx)("td",{style:{padding:"1rem"},children:(0,r.jsx)("span",{style:{padding:"0.25rem 0.75rem",backgroundColor:(e=>{switch(e){case"LOW":return"rgba(34, 197, 94, 0.15)";case"MEDIUM":return"rgba(234, 179, 8, 0.15)";case"HIGH":return"rgba(251, 146, 60, 0.15)";case"CRITICAL":return"rgba(239, 68, 68, 0.15)";default:return"var(--bg-tertiary)"}})(e.priority),color:(e=>{switch(e){case"LOW":return"rgb(34, 197, 94)";case"MEDIUM":return"rgb(234, 179, 8)";case"HIGH":return"rgb(251, 146, 60)";case"CRITICAL":return"rgb(239, 68, 68)";default:return"var(--text-secondary)"}})(e.priority),borderRadius:"4px",fontSize:"0.75rem",fontWeight:500,textTransform:"capitalize"},children:e.priority})}),(0,r.jsxs)("td",{style:{padding:"1rem",color:"var(--text-secondary)",fontSize:"0.875rem"},children:[new Date(e.createdAt).toLocaleDateString()," ",new Date(e.createdAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]}),d&&(0,r.jsx)("td",{style:{padding:"1rem",textAlign:"right"},children:o&&(0,r.jsxs)("select",{value:e.status,onChange:r=>v(e.id,r.target.value),disabled:f[e.id],style:{padding:"0.375rem 0.75rem",border:"1px solid var(--border-color)",borderRadius:"4px",backgroundColor:"var(--bg-primary)",color:"var(--text-primary)",cursor:f[e.id]?"not-allowed":"pointer",fontSize:"0.875rem"},children:[(0,r.jsx)("option",{value:"NEW",children:"New"}),(0,r.jsx)("option",{value:"IN_PROGRESS",children:"In Progress"}),(0,r.jsx)("option",{value:"RESOLVED",children:"Resolved"}),(0,r.jsx)("option",{value:"CLOSED",children:"Closed"})]})})]},e.id))})]})})}e.s(["default",()=>o])},78928,e=>{"use strict";var r=e.i(43476),t=e.i(71645),s=e.i(22016),a=e.i(41598);function i(){let[e,i]=(0,t.useState)(null),[o,d]=(0,t.useState)(null),[l,n]=(0,t.useState)(!0),[c,m]=(0,t.useState)([]),[g,u]=(0,t.useState)(!1),[x,h]=(0,t.useState)([]),[p,y]=(0,t.useState)(!1),[b,f]=(0,t.useState)(null);(0,t.useEffect)(()=>{let e=localStorage.getItem("user");if(e)try{let r=JSON.parse(e);f(r)}catch(e){console.error("Failed to parse user data")}j()},[]),(0,t.useEffect)(()=>{b&&b.roles?.some(e=>["AGENT","IT_MANAGER","ADMIN"].includes(e))&&(v(),k())},[b]);let j=async()=>{try{n(!0);let e=localStorage.getItem("accessToken"),[r,t]=await Promise.all([fetch("/api/v1/analytics/metrics",{headers:e?{Authorization:`Bearer ${e}`}:{}}),fetch("/api/v1/analytics/mttr",{headers:e?{Authorization:`Bearer ${e}`}:{}})]),s=await r.json(),a=await t.json();s.success&&i(s.data.metrics),a.success&&d(a.data.mttr)}catch(e){console.error("Failed to load dashboard data:",e)}finally{n(!1)}},v=async()=>{try{u(!0);let e=localStorage.getItem("accessToken"),r=await fetch("/api/v1/tickets?onlyAssignedToMe=true&excludeStatuses=CLOSED,RESOLVED&limit=20",{headers:e?{Authorization:`Bearer ${e}`}:{}}),t=await r.json();t.success&&m(t.data||[])}catch(e){console.error("Failed to load assigned tickets:",e)}finally{u(!1)}},k=async()=>{try{y(!0);let e=localStorage.getItem("accessToken"),r=await fetch("/api/v1/kb?limit=5",{headers:e?{Authorization:`Bearer ${e}`}:{}}),t=await r.json();t.success&&Array.isArray(t.data)&&h(t.data.slice(0,5))}catch(e){console.error("Failed to load KB articles:",e)}finally{y(!1)}},S=async(e,r)=>{let t=localStorage.getItem("accessToken");try{let s=await fetch(`/api/v1/tickets/${e}`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({status:r})}),a=await s.json();if(!a.success)throw Error(a.error?.message||"Failed to update status");"CLOSED"===r||"RESOLVED"===r?m(r=>r.filter(r=>r.id!==e)):m(t=>t.map(t=>t.id===e?{...t,status:r}:t))}catch(e){throw console.error("Failed to update ticket status:",e),e}},w=async e=>{try{let r=localStorage.getItem("accessToken"),t=await fetch(`/api/v1/analytics/export?type=${e}&format=csv`,{headers:r?{Authorization:`Bearer ${r}`}:{}}),s=await t.blob(),a=window.URL.createObjectURL(s),i=document.createElement("a");i.href=a,i.download=`${e}-report-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(i),i.click(),window.URL.revokeObjectURL(a),document.body.removeChild(i)}catch(e){console.error("Failed to export report:",e)}},C=b?.roles?.some(e=>["AGENT","IT_MANAGER","ADMIN"].includes(e));return l?(0,r.jsx)("div",{style:{padding:"2rem"},children:"Loading dashboard..."}):(0,r.jsxs)("div",{style:{padding:"2rem",maxWidth:"1400px",margin:"0 auto"},children:[(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"2rem"},children:[(0,r.jsx)("h1",{style:{margin:0},children:"Dashboard"}),(0,r.jsxs)("div",{style:{display:"flex",gap:"1rem"},children:[(0,r.jsx)("button",{onClick:()=>w("tickets"),style:{padding:"0.5rem 1rem",backgroundColor:"var(--accent-primary)",color:"white",border:"none",borderRadius:"6px",cursor:"pointer"},children:"Export Tickets CSV"}),(0,r.jsx)(s.default,{href:"/reports",style:{padding:"0.5rem 1rem",backgroundColor:"var(--accent-primary)",color:"white",textDecoration:"none",borderRadius:"6px"},children:"View Reports"})]})]}),e&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem",marginBottom:"2rem"},children:[(0,r.jsxs)("div",{style:{padding:"1.5rem",border:"1px solid var(--border-color)",borderRadius:"8px",backgroundColor:"var(--bg-secondary)"},children:[(0,r.jsx)("h3",{style:{marginTop:0,marginBottom:"0.5rem",fontSize:"0.875rem",color:"var(--text-secondary)"},children:"Total Tickets"}),(0,r.jsx)("div",{style:{fontSize:"2rem",fontWeight:"bold"},children:e.totalTickets})]}),(0,r.jsxs)("div",{style:{padding:"1.5rem",border:"1px solid var(--border-color)",borderRadius:"8px",backgroundColor:"var(--bg-secondary)"},children:[(0,r.jsx)("h3",{style:{marginTop:0,marginBottom:"0.5rem",fontSize:"0.875rem",color:"var(--text-secondary)"},children:"Open Tickets"}),(0,r.jsx)("div",{style:{fontSize:"2rem",fontWeight:"bold",color:"orange"},children:e.openTickets})]}),(0,r.jsxs)("div",{style:{padding:"1.5rem",border:"1px solid var(--border-color)",borderRadius:"8px",backgroundColor:"var(--bg-secondary)"},children:[(0,r.jsx)("h3",{style:{marginTop:0,marginBottom:"0.5rem",fontSize:"0.875rem",color:"var(--text-secondary)"},children:"Resolved Tickets"}),(0,r.jsx)("div",{style:{fontSize:"2rem",fontWeight:"bold",color:"green"},children:e.resolvedTickets})]}),(0,r.jsxs)("div",{style:{padding:"1.5rem",border:"1px solid var(--border-color)",borderRadius:"8px",backgroundColor:"var(--bg-secondary)"},children:[(0,r.jsx)("h3",{style:{marginTop:0,marginBottom:"0.5rem",fontSize:"0.875rem",color:"var(--text-secondary)"},children:"SLA Compliance"}),(0,r.jsxs)("div",{style:{fontSize:"2rem",fontWeight:"bold",color:e.slaCompliance>=90?"green":e.slaCompliance>=75?"orange":"red"},children:[e.slaCompliance.toFixed(1),"%"]})]}),null!==o&&(0,r.jsxs)("div",{style:{padding:"1.5rem",border:"1px solid var(--border-color)",borderRadius:"8px",backgroundColor:"var(--bg-secondary)"},children:[(0,r.jsx)("h3",{style:{marginTop:0,marginBottom:"0.5rem",fontSize:"0.875rem",color:"var(--text-secondary)"},children:"MTTR (Minutes)"}),(0,r.jsx)("div",{style:{fontSize:"2rem",fontWeight:"bold"},children:o})]}),(0,r.jsxs)("div",{style:{padding:"1.5rem",border:"1px solid var(--border-color)",borderRadius:"8px",backgroundColor:"var(--bg-secondary)"},children:[(0,r.jsx)("h3",{style:{marginTop:0,marginBottom:"0.5rem",fontSize:"0.875rem",color:"var(--text-secondary)"},children:"Avg Resolution Time"}),(0,r.jsxs)("div",{style:{fontSize:"2rem",fontWeight:"bold"},children:[e.averageResolutionTime," min"]})]})]}),(0,r.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"2rem",marginBottom:"2rem"},children:[(0,r.jsxs)("div",{style:{padding:"1.5rem",border:"1px solid var(--border-color)",borderRadius:"8px",backgroundColor:"var(--bg-secondary)"},children:[(0,r.jsx)("h2",{style:{marginTop:0,marginBottom:"1rem"},children:"Tickets by Priority"}),(0,r.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:Object.entries(e.ticketsByPriority).map(([e,t])=>(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,r.jsxs)("span",{children:[e,":"]}),(0,r.jsx)("strong",{children:t})]},e))})]}),(0,r.jsxs)("div",{style:{padding:"1.5rem",border:"1px solid var(--border-color)",borderRadius:"8px",backgroundColor:"var(--bg-secondary)"},children:[(0,r.jsx)("h2",{style:{marginTop:0,marginBottom:"1rem"},children:"Tickets by Status"}),(0,r.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:Object.entries(e.ticketsByStatus).map(([e,t])=>(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,r.jsxs)("span",{children:[e,":"]}),(0,r.jsx)("strong",{children:t})]},e))})]})]})]}),C&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{style:{marginBottom:"2rem"},children:[(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[(0,r.jsx)("h2",{style:{margin:0},children:"My Assigned Tickets"}),(0,r.jsx)(s.default,{href:"/tickets",className:"btn btn-secondary",style:{fontSize:"0.875rem"},children:"View All Tickets"})]}),g?(0,r.jsx)("div",{style:{padding:"2rem",textAlign:"center"},children:"Loading tickets..."}):(0,r.jsx)(a.default,{tickets:c,onStatusChange:S,showQuickActions:!0,onRefresh:v})]}),(0,r.jsxs)("div",{style:{marginBottom:"2rem"},children:[(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[(0,r.jsx)("h2",{style:{margin:0},children:"Recent Knowledge Base Articles"}),(0,r.jsx)(s.default,{href:"/kb",className:"btn btn-secondary",style:{fontSize:"0.875rem"},children:"View All Articles"})]}),p?(0,r.jsx)("div",{style:{padding:"2rem",textAlign:"center"},children:"Loading articles..."}):x.length>0?(0,r.jsx)("div",{className:"card",style:{padding:0},children:(0,r.jsx)("div",{style:{display:"flex",flexDirection:"column"},children:x.map(e=>(0,r.jsxs)(s.default,{href:`/kb/${e.slug}`,style:{padding:"1rem",borderBottom:"1px solid var(--border-color)",textDecoration:"none",color:"inherit",display:"block"},children:[(0,r.jsx)("h3",{style:{margin:0,marginBottom:"0.5rem",fontSize:"1rem"},children:e.title}),(0,r.jsxs)("div",{style:{fontSize:"0.875rem",color:"var(--text-secondary)"},children:["Updated: ",new Date(e.updatedAt).toLocaleDateString()]})]},e.id))})}):(0,r.jsx)("div",{className:"card",style:{padding:"2rem",textAlign:"center",color:"var(--text-secondary)"},children:"No knowledge base articles found."})]})]}),(0,r.jsxs)("div",{style:{marginTop:"2rem"},children:[(0,r.jsx)("h2",{style:{marginBottom:"1rem"},children:"Quick Links"}),(0,r.jsxs)("div",{style:{display:"flex",gap:"1rem",flexWrap:"wrap"},children:[(0,r.jsx)(s.default,{href:"/tickets",style:{padding:"0.75rem 1.5rem",backgroundColor:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"6px",textDecoration:"none",color:"var(--text-primary)"},children:"View Tickets"}),(0,r.jsx)(s.default,{href:"/assets",style:{padding:"0.75rem 1.5rem",backgroundColor:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"6px",textDecoration:"none",color:"var(--text-primary)"},children:"View Assets"}),(0,r.jsx)(s.default,{href:"/changes",style:{padding:"0.75rem 1.5rem",backgroundColor:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"6px",textDecoration:"none",color:"var(--text-primary)"},children:"View Changes"}),(0,r.jsx)(s.default,{href:"/kb",style:{padding:"0.75rem 1.5rem",backgroundColor:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"6px",textDecoration:"none",color:"var(--text-primary)"},children:"Knowledge Base"})]})]})]})}e.s(["default",()=>i])}]);