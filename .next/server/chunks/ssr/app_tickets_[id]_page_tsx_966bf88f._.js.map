{"version":3,"sources":["../../../../app/tickets/%5Bid%5D/page.tsx"],"sourcesContent":["'use client'\n\nimport { useEffect, useState } from 'react'\nimport { useParams } from 'next/navigation'\n\ninterface Ticket {\n  id: string\n  ticketNumber: string\n  subject: string\n  description: string\n  status: string\n  priority: string\n  createdAt: string\n  comments: Array<{\n    id: string\n    body: string\n    createdAt: string\n    author: { email: string }\n  }>\n}\n\nexport default function TicketDetailPage() {\n  const params = useParams()\n  const ticketId = params?.id as string\n\n  const [ticket, setTicket] = useState<Ticket | null>(null)\n  const [loading, setLoading] = useState(true)\n  const [error, setError] = useState('')\n  const [comment, setComment] = useState('')\n  const [saving, setSaving] = useState(false)\n\n  useEffect(() => {\n    const fetchTicket = async () => {\n      try {\n        const res = await fetch(`/api/v1/tickets/${ticketId}`)\n        const data = await res.json()\n        if (!data.success) {\n          setError('Failed to load ticket')\n          return\n        }\n        setTicket(data.data)\n      } catch (err) {\n        setError('Failed to load ticket')\n      } finally {\n        setLoading(false)\n      }\n    }\n    if (ticketId) fetchTicket()\n  }, [ticketId])\n\n  const submitComment = async () => {\n    if (!comment.trim()) return\n    setSaving(true)\n    setError('')\n    try {\n      const token = localStorage.getItem('accessToken')\n      const res = await fetch(`/api/v1/tickets/${ticketId}`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          ...(token ? { Authorization: `Bearer ${token}` } : {}),\n        },\n        body: JSON.stringify({ body: comment }),\n      })\n      const data = await res.json()\n      if (!data.success) {\n        setError(data.error?.message || 'Failed to add comment')\n        setSaving(false)\n        return\n      }\n      setTicket((prev) =>\n        prev\n          ? { ...prev, comments: [...prev.comments, { ...data.data, author: data.data.author }] }\n          : prev\n      )\n      setComment('')\n    } catch (err) {\n      setError('Failed to add comment')\n    } finally {\n      setSaving(false)\n    }\n  }\n\n  if (loading) return <div className=\"container\" style={{ padding: '2rem' }}>Loading ticket...</div>\n  if (error) return <div className=\"container\" style={{ padding: '2rem', color: 'var(--error)' }}>{error}</div>\n  if (!ticket) return null\n\n  return (\n    <div className=\"container\" style={{ padding: '2rem', display: 'grid', gap: '1.5rem' }}>\n      <div className=\"card\">\n        <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '0.5rem' }}>\n          <span style={{ fontWeight: 600 }}>{ticket.ticketNumber}</span>\n          <span style={{ color: 'var(--text-secondary)' }}>{new Date(ticket.createdAt).toLocaleString()}</span>\n        </div>\n        <h1 style={{ marginBottom: '0.5rem' }}>{ticket.subject}</h1>\n        <p style={{ color: 'var(--text-secondary)', marginBottom: '0.75rem' }}>{ticket.description}</p>\n        <div style={{ display: 'flex', gap: '0.75rem', color: 'var(--text-secondary)', fontSize: '0.9rem' }}>\n          <span>Status: {ticket.status}</span>\n          <span>Priority: {ticket.priority}</span>\n        </div>\n      </div>\n\n      <div className=\"card\">\n        <h3 style={{ marginBottom: '0.75rem' }}>Comments</h3>\n        <div style={{ display: 'grid', gap: '0.5rem', marginBottom: '1rem' }}>\n          {ticket.comments.length === 0 && <p style={{ color: 'var(--text-secondary)' }}>No comments yet.</p>}\n          {ticket.comments.map((c) => (\n            <div key={c.id} style={{ border: '1px solid var(--border-color)', borderRadius: '0.5rem', padding: '0.75rem' }}>\n              <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '0.25rem' }}>\n                <span style={{ fontWeight: 500 }}>{c.author?.email ?? 'Unknown'}</span>\n                <span style={{ color: 'var(--text-tertiary)', fontSize: '0.85rem' }}>\n                  {new Date(c.createdAt).toLocaleString()}\n                </span>\n              </div>\n              <p>{c.body}</p>\n            </div>\n          ))}\n        </div>\n\n        <div style={{ display: 'grid', gap: '0.5rem' }}>\n          <textarea\n            className=\"input\"\n            rows={3}\n            placeholder=\"Add a comment\"\n            value={comment}\n            onChange={(e) => setComment(e.target.value)}\n            disabled={saving}\n          />\n          <button className=\"btn btn-primary\" onClick={submitComment} disabled={saving}>\n            {saving ? 'Adding...' : 'Add Comment'}\n          </button>\n          {error && <p style={{ color: 'var(--error)' }}>{error}</p>}\n        </div>\n      </div>\n    </div>\n  )\n}\n\n"],"names":[],"mappings":"wDAEA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OAkBe,SAAS,IACtB,IAAM,EAAS,CAAA,EAAA,EAAA,SAAA,AAAS,IAClB,EAAW,GAAQ,GAEnB,CAAC,EAAQ,EAAU,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAgB,MAC9C,CAAC,EAAS,EAAW,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GACjC,CAAC,EAAO,EAAS,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IAC7B,CAAC,EAAS,EAAW,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IACjC,CAAC,EAAQ,EAAU,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GAErC,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KACR,IAAM,EAAc,UAClB,GAAI,CACF,IAAM,EAAM,MAAM,MAAM,CAAC,gBAAgB,EAAE,EAAA,CAAU,EAC/C,EAAO,MAAM,EAAI,IAAI,GAC3B,GAAI,CAAC,EAAK,OAAO,CAAE,YACjB,EAAS,yBAGX,EAAU,EAAK,IAAI,CACrB,CAAE,MAAO,EAAK,CACZ,EAAS,wBACX,QAAU,CACR,EAAW,GACb,CACF,EACI,GAAU,GAChB,EAAG,CAAC,EAAS,EAEb,IAAM,EAAgB,UACpB,GAAK,CAAD,CAAS,IAAI,IAAI,AACrB,GAAU,GACV,EAAS,IACT,GAAI,CACF,IAAM,EAAQ,aAAa,OAAO,CAAC,eAC7B,EAAM,MAAM,MAAM,CAAC,gBAAgB,EAAE,EAAA,CAAU,CAAE,CACrD,OAAQ,OACR,QAAS,CACP,eAAgB,mBAChB,GAAI,EAAQ,CAAE,cAAe,CAAC,OAAO,EAAE,EAAA,CAAO,AAAC,EAAI,CAAC,CAAC,AACvD,EACA,KAAM,KAAK,SAAS,CAAC,CAAE,KAAM,CAAQ,EACvC,GACM,EAAO,MAAM,EAAI,IAAI,GAC3B,GAAI,CAAC,EAAK,OAAO,CAAE,CACjB,EAAS,EAAK,KAAK,EAAE,SAAW,yBAChC,GAAU,GACV,MACF,CACA,EAAU,AAAC,GACT,EACI,CAAE,GAAG,CAAI,CAAE,SAAU,IAAI,EAAK,QAAQ,CAAE,CAAE,GAAG,EAAK,IAAI,CAAE,OAAQ,EAAK,IAAI,CAAC,MAAM,AAAC,EAAE,AAAC,EACpF,GAEN,EAAW,GACb,CAAE,MAAO,EAAK,CACZ,EAAS,wBACX,QAAU,CACR,GAAU,EACZ,EACF,SAEA,AAAI,EAAgB,CAAA,EAAA,EAAA,EAAP,CAAO,EAAC,MAAA,CAAI,UAAU,YAAY,MAAO,CAAE,QAAS,MAAO,WAAG,sBACvE,EAAc,CAAA,EAAA,EAAP,AAAO,GAAA,EAAC,MAAA,CAAI,UAAU,YAAY,MAAO,CAAE,QAAS,OAAQ,MAAO,cAAe,WAAI,IAC5F,EAGH,CAAA,EAAA,EAAA,CAHW,GAGX,EAAC,MAAA,CAAI,UAAU,YAAY,MAAO,CAAE,QAAS,OAAQ,QAAS,OAAQ,IAAK,QAAS,YAClF,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,iBACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,MAAO,CAAE,QAAS,OAAQ,eAAgB,gBAAiB,aAAc,QAAS,YACrF,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,MAAO,CAAE,WAAY,GAAI,WAAI,EAAO,YAAY,GACtD,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,MAAO,CAAE,MAAO,uBAAwB,WAAI,IAAI,KAAK,EAAO,SAAS,EAAE,cAAc,QAE7F,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,MAAO,CAAE,aAAc,QAAS,WAAI,EAAO,OAAO,GACtD,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,MAAO,CAAE,MAAO,wBAAyB,aAAc,SAAU,WAAI,EAAO,WAAW,GAC1F,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,MAAO,CAAE,QAAS,OAAQ,IAAK,UAAW,MAAO,wBAAyB,SAAU,QAAS,YAChG,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,WAAK,WAAS,EAAO,MAAM,IAC5B,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,WAAK,aAAW,EAAO,QAAQ,UAIpC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,iBACb,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,MAAO,CAAE,aAAc,SAAU,WAAG,aACxC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,MAAO,CAAE,QAAS,OAAQ,IAAK,SAAU,aAAc,MAAO,YACrC,IAA3B,EAAO,QAAQ,CAAC,MAAM,EAAU,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,MAAO,CAAE,MAAO,uBAAwB,WAAG,qBAC9E,EAAO,QAAQ,CAAC,GAAG,CAAC,AAAC,GACpB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAe,MAAO,CAAE,OAAQ,gCAAiC,aAAc,SAAU,QAAS,SAAU,YAC3G,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,MAAO,CAAE,QAAS,OAAQ,eAAgB,gBAAiB,aAAc,SAAU,YACtF,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,MAAO,CAAE,WAAY,GAAI,WAAI,EAAE,MAAM,EAAE,OAAS,YACtD,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,MAAO,CAAE,MAAO,uBAAwB,SAAU,SAAU,WAC/D,IAAI,KAAK,EAAE,SAAS,EAAE,cAAc,QAGzC,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,UAAG,EAAE,IAAI,KAPF,EAAE,EAAE,MAYlB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,MAAO,CAAE,QAAS,OAAQ,IAAK,QAAS,YAC3C,CAAA,EAAA,EAAA,GAAA,EAAC,WAAA,CACC,UAAU,QACV,KAAM,EACN,YAAY,gBACZ,MAAO,EACP,SAAU,AAAC,GAAM,EAAW,EAAE,MAAM,CAAC,KAAK,EAC1C,SAAU,IAEZ,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,UAAU,kBAAkB,QAAS,EAAe,SAAU,WACnE,EAAS,YAAc,gBAEzB,GAAS,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,MAAO,CAAE,MAAO,cAAe,WAAI,aA9CpC,IAmDtB"}