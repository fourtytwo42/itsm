(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,41598,e=>{"use strict";var t=e.i(43476),r=e.i(71645),a=e.i(22016),s=e.i(44452),i=e.i(44735);function l({tickets:e,onStatusChange:l,showQuickActions:n=!0,onRefresh:o,disableClientSort:d=!1,onSortChange:c,currentSortField:u,currentSortOrder:m}){let[h,p]=(0,r.useState)("createdAt"),[g,x]=(0,r.useState)("desc"),b=d&&void 0!==u?u:h,j=d&&void 0!==m?m:g,[y,v]=(0,r.useState)({}),f=async(e,t)=>{if(l){v(t=>({...t,[e]:!0}));try{await l(e,t),o&&o()}catch(e){console.error("Failed to update status:",e)}finally{v(t=>({...t,[e]:!1}))}}},S=d?e:[...e].sort((e,t)=>{let r,a;switch(b){case"ticketNumber":r=e.ticketNumber,a=t.ticketNumber;break;case"subject":r=e.subject,a=t.subject;break;case"status":r=e.status,a=t.status;break;case"priority":r=e.priority,a=t.priority;break;case"createdAt":default:r=new Date(e.createdAt).getTime(),a=new Date(t.createdAt).getTime();break;case"updatedAt":r=new Date(e.updatedAt).getTime(),a=new Date(t.updatedAt).getTime();break;case"requester":r=e.requester?.email||e.requesterEmail||"",a=t.requester?.email||t.requesterEmail||"";break;case"assignee":r=e.assignee?.email||"",a=t.assignee?.email||""}return r<a?"asc"===j?-1:1:r>a?"asc"===j?1:-1:0}),N=({field:e,label:r})=>(0,t.jsx)("th",{style:{padding:"0.875rem 1rem",textAlign:"left",fontWeight:600,fontSize:"0.875rem",cursor:"pointer",userSelect:"none",position:"relative"},onClick:()=>{d&&c?c(e,b===e&&"desc"===j?"asc":"desc"):b===e?x("asc"===g?"desc":"asc"):(p(e),x("desc"))},children:(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[r,b===e&&("asc"===j?(0,t.jsx)(s.ChevronUpIcon,{style:{width:"0.875rem",height:"0.875rem"}}):(0,t.jsx)(i.ChevronDownIcon,{style:{width:"0.875rem",height:"0.875rem"}}))]})});return 0===e.length?(0,t.jsx)("div",{className:"card",style:{padding:"3rem",textAlign:"center",color:"var(--text-secondary)"},children:"No tickets found."}):(0,t.jsx)("div",{className:"card",style:{overflowX:"auto",padding:0},children:(0,t.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{style:{borderBottom:"2px solid var(--border-color)",backgroundColor:"var(--bg-secondary)"},children:[(0,t.jsx)(N,{field:"ticketNumber",label:"Ticket #"}),(0,t.jsx)(N,{field:"subject",label:"Subject"}),(0,t.jsx)(N,{field:"requester",label:"Requester"}),(0,t.jsx)(N,{field:"assignee",label:"Assignee"}),(0,t.jsx)(N,{field:"status",label:"Status"}),(0,t.jsx)(N,{field:"priority",label:"Priority"}),(0,t.jsx)(N,{field:"createdAt",label:"Created"}),n&&(0,t.jsx)("th",{style:{padding:"0.875rem 1rem",textAlign:"right",fontWeight:600,fontSize:"0.875rem"},children:"Actions"})]})}),(0,t.jsx)("tbody",{children:S.map(e=>(0,t.jsxs)("tr",{style:{borderBottom:"1px solid var(--border-color)"},children:[(0,t.jsx)("td",{style:{padding:"1rem"},children:(0,t.jsx)(a.default,{href:`/tickets/${e.id}`,style:{color:"var(--accent-primary)",textDecoration:"none",fontWeight:500},children:e.ticketNumber})}),(0,t.jsx)("td",{style:{padding:"1rem"},children:(0,t.jsx)(a.default,{href:`/tickets/${e.id}`,style:{color:"var(--text-primary)",textDecoration:"none"},children:e.subject})}),(0,t.jsx)("td",{style:{padding:"1rem",color:"var(--text-secondary)"},children:e.requester?[e.requester.firstName,e.requester.lastName].filter(Boolean).join(" ")||e.requester.email:e.requesterName||e.requesterEmail||"Unknown"}),(0,t.jsx)("td",{style:{padding:"1rem",color:"var(--text-secondary)"},children:e.assignee?[e.assignee.firstName,e.assignee.lastName].filter(Boolean).join(" ")||e.assignee.email:"Unassigned"}),(0,t.jsx)("td",{style:{padding:"1rem"},children:(0,t.jsx)("span",{style:{padding:"0.25rem 0.75rem",backgroundColor:(e=>{switch(e){case"NEW":return"rgba(59, 130, 246, 0.15)";case"IN_PROGRESS":return"rgba(234, 179, 8, 0.15)";case"RESOLVED":return"rgba(34, 197, 94, 0.15)";case"CLOSED":return"rgba(107, 114, 128, 0.15)";default:return"var(--bg-tertiary)"}})(e.status),color:(e=>{switch(e){case"NEW":return"rgb(59, 130, 246)";case"IN_PROGRESS":return"rgb(234, 179, 8)";case"RESOLVED":return"rgb(34, 197, 94)";case"CLOSED":return"rgb(107, 114, 128)";default:return"var(--text-secondary)"}})(e.status),borderRadius:"4px",fontSize:"0.75rem",fontWeight:500,textTransform:"capitalize"},children:e.status.replace("_"," ")})}),(0,t.jsx)("td",{style:{padding:"1rem"},children:(0,t.jsx)("span",{style:{padding:"0.25rem 0.75rem",backgroundColor:(e=>{switch(e){case"LOW":return"rgba(34, 197, 94, 0.15)";case"MEDIUM":return"rgba(234, 179, 8, 0.15)";case"HIGH":return"rgba(251, 146, 60, 0.15)";case"CRITICAL":return"rgba(239, 68, 68, 0.15)";default:return"var(--bg-tertiary)"}})(e.priority),color:(e=>{switch(e){case"LOW":return"rgb(34, 197, 94)";case"MEDIUM":return"rgb(234, 179, 8)";case"HIGH":return"rgb(251, 146, 60)";case"CRITICAL":return"rgb(239, 68, 68)";default:return"var(--text-secondary)"}})(e.priority),borderRadius:"4px",fontSize:"0.75rem",fontWeight:500,textTransform:"capitalize"},children:e.priority})}),(0,t.jsxs)("td",{style:{padding:"1rem",color:"var(--text-secondary)",fontSize:"0.875rem"},children:[new Date(e.createdAt).toLocaleDateString()," ",new Date(e.createdAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]}),n&&(0,t.jsx)("td",{style:{padding:"1rem",textAlign:"right"},children:l&&(0,t.jsxs)("select",{value:e.status,onChange:t=>f(e.id,t.target.value),disabled:y[e.id],style:{padding:"0.375rem 0.75rem",border:"1px solid var(--border-color)",borderRadius:"4px",backgroundColor:"var(--bg-primary)",color:"var(--text-primary)",cursor:y[e.id]?"not-allowed":"pointer",fontSize:"0.875rem"},children:[(0,t.jsx)("option",{value:"NEW",children:"New"}),(0,t.jsx)("option",{value:"IN_PROGRESS",children:"In Progress"}),(0,t.jsx)("option",{value:"RESOLVED",children:"Resolved"}),(0,t.jsx)("option",{value:"CLOSED",children:"Closed"})]})})]},e.id))})]})})}e.s(["default",()=>l])},93546,e=>{"use strict";var t=e.i(43476),r=e.i(22016),a=e.i(71645),s=e.i(41598);function i(){let[e,i]=(0,a.useState)([]),[l,n]=(0,a.useState)(!0),[o,d]=(0,a.useState)(""),[c,u]=(0,a.useState)("all"),[m,h]=(0,a.useState)(""),[p,g]=(0,a.useState)("createdAt"),[x,b]=(0,a.useState)("desc"),[j,y]=(0,a.useState)(1),[v,f]=(0,a.useState)(1),[S,N]=(0,a.useState)(0);(0,a.useEffect)(()=>{k()},[c,m,p,x,j]);let k=async()=>{try{n(!0),d("");let e=localStorage.getItem("accessToken"),t=new URLSearchParams;"all"!==c&&t.append("status",c),m.trim()&&t.append("search",m.trim()),t.append("sortBy",p),t.append("sortOrder",x),t.append("page",j.toString()),t.append("limit","20");let r=await fetch(`/api/v1/tickets?${t.toString()}`,{headers:e?{Authorization:`Bearer ${e}`}:{}}),a=await r.json();if(!a.success)return void d(a.error?.message||"Failed to load tickets");i(a.data||[]),a.pagination&&(f(a.pagination.totalPages||1),N(a.pagination.total||0))}catch(e){d("Failed to load tickets"),console.error(e)}finally{n(!1)}},C=async(e,t)=>{let r=localStorage.getItem("accessToken");try{let a=await fetch(`/api/v1/tickets/${e}`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify({status:t})}),s=await a.json();if(!s.success)throw Error(s.error?.message||"Failed to update status");k()}catch(e){throw console.error("Failed to update ticket status:",e),e}};return(0,t.jsxs)("div",{className:"container",style:{padding:"2rem"},children:[(0,t.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.5rem",marginTop:"1rem"},children:[(0,t.jsx)("h1",{style:{fontSize:"2rem",fontWeight:"bold"},children:"Tickets"}),(0,t.jsx)(r.default,{href:"/tickets/new",className:"btn btn-primary",children:"New Ticket"})]}),(0,t.jsxs)("div",{className:"card",style:{padding:"1.5rem",marginBottom:"1.5rem"},children:[(0,t.jsxs)("div",{style:{display:"flex",gap:"1rem",flexWrap:"wrap",alignItems:"flex-end"},children:[(0,t.jsxs)("div",{style:{flex:1,minWidth:"200px"},children:[(0,t.jsx)("label",{className:"label",htmlFor:"statusFilter",children:"Status"}),(0,t.jsxs)("select",{id:"statusFilter",className:"input",value:c,onChange:e=>{u(e.target.value),y(1)},children:[(0,t.jsx)("option",{value:"all",children:"All Statuses"}),(0,t.jsx)("option",{value:"NEW",children:"New"}),(0,t.jsx)("option",{value:"IN_PROGRESS",children:"In Progress"}),(0,t.jsx)("option",{value:"RESOLVED",children:"Resolved"}),(0,t.jsx)("option",{value:"CLOSED",children:"Closed"})]})]}),(0,t.jsxs)("div",{style:{flex:2,minWidth:"250px"},children:[(0,t.jsx)("label",{className:"label",htmlFor:"search",children:"Search (Username, Email, or Problem)"}),(0,t.jsxs)("form",{onSubmit:e=>{e.preventDefault(),y(1),k()},style:{display:"flex",gap:"0.5rem"},children:[(0,t.jsx)("input",{id:"search",type:"text",className:"input",value:m,onChange:e=>h(e.target.value),placeholder:"Search by username, email, or problem text...",style:{flex:1}}),(0,t.jsx)("button",{type:"submit",className:"btn btn-secondary",children:"Search"}),m&&(0,t.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:()=>{h(""),y(1)},children:"Clear"})]})]}),(0,t.jsxs)("div",{style:{minWidth:"150px"},children:[(0,t.jsx)("label",{className:"label",htmlFor:"sortBy",children:"Sort By"}),(0,t.jsxs)("select",{id:"sortBy",className:"input",value:p,onChange:e=>{g(e.target.value),y(1)},children:[(0,t.jsx)("option",{value:"createdAt",children:"Created Date"}),(0,t.jsx)("option",{value:"updatedAt",children:"Updated Date"}),(0,t.jsx)("option",{value:"ticketNumber",children:"Ticket Number"}),(0,t.jsx)("option",{value:"subject",children:"Subject"}),(0,t.jsx)("option",{value:"status",children:"Status"}),(0,t.jsx)("option",{value:"priority",children:"Priority"}),(0,t.jsx)("option",{value:"requester",children:"Requester"}),(0,t.jsx)("option",{value:"assignee",children:"Assignee"})]})]}),(0,t.jsxs)("div",{style:{minWidth:"120px"},children:[(0,t.jsx)("label",{className:"label",htmlFor:"sortOrder",children:"Order"}),(0,t.jsxs)("select",{id:"sortOrder",className:"input",value:x,onChange:e=>{b(e.target.value),y(1)},children:[(0,t.jsx)("option",{value:"desc",children:"Newest First"}),(0,t.jsx)("option",{value:"asc",children:"Oldest First"})]})]})]}),S>0&&(0,t.jsxs)("div",{style:{marginTop:"1rem",paddingTop:"1rem",borderTop:"1px solid var(--border-color)",color:"var(--text-secondary)",fontSize:"0.875rem"},children:["Showing ",(j-1)*20+1," - ",Math.min(20*j,S)," of ",S," tickets"]})]}),o&&(0,t.jsx)("div",{style:{padding:"0.75rem",backgroundColor:"rgba(239, 68, 68, 0.1)",border:"1px solid var(--error)",borderRadius:"0.5rem",marginBottom:"1rem",color:"var(--error)"},children:o}),l?(0,t.jsx)("div",{style:{padding:"2rem",textAlign:"center"},children:"Loading tickets..."}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.default,{tickets:e,onStatusChange:C,showQuickActions:!0,onRefresh:k,disableClientSort:!0,onSortChange:(e,t)=>{g(e),b(t),y(1)},currentSortField:p,currentSortOrder:x}),v>1&&(0,t.jsxs)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",gap:"1rem",marginTop:"2rem"},children:[(0,t.jsx)("button",{className:"btn btn-secondary",onClick:()=>y(e=>Math.max(1,e-1)),disabled:1===j,children:"Previous"}),(0,t.jsxs)("span",{style:{color:"var(--text-secondary)"},children:["Page ",j," of ",v]}),(0,t.jsx)("button",{className:"btn btn-secondary",onClick:()=>y(e=>Math.min(v,e+1)),disabled:j===v,children:"Next"})]})]})]})}e.s(["default",()=>i])}]);