(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,63972,e=>{"use strict";var r=e.i(71645);let t=r.forwardRef(function({title:e,titleId:t,...a},i){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:i,"aria-labelledby":t},a),e?r.createElement("title",{id:t},e):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"}))});e.s(["DocumentDuplicateIcon",0,t],63972)},46863,e=>{"use strict";var r=e.i(43476),t=e.i(71645),a=e.i(18566),i=e.i(22016),o=e.i(63972),s=e.i(87906);function n(){(0,a.useRouter)();let e=(0,a.useParams)(),n=e?.id,l=(0,t.useRef)(null),[d,c]=(0,t.useState)(null),[p,g]=(0,t.useState)(!0),[m,u]=(0,t.useState)(!1),[h,y]=(0,t.useState)(!1),[x,b]=(0,t.useState)(""),[v,j]=(0,t.useState)(null),[f,k]=(0,t.useState)("basic"),[w,C]=(0,t.useState)([]),[S,R]=(0,t.useState)([]),[B,T]=(0,t.useState)([]),[A,I]=(0,t.useState)(""),[z,$]=(0,t.useState)([]),[W,N]=(0,t.useState)(""),[P,F]=(0,t.useState)(""),[L,O]=(0,t.useState)(!1),[D,E]=(0,t.useState)(!1),[U,q]=(0,t.useState)({name:"",slug:"",description:"",logo:"",requiresLogin:!1,isActive:!0});(0,t.useEffect)(()=>{K(),G(),H()},[n]);let K=async()=>{try{g(!0);let e=localStorage.getItem("accessToken"),r=await fetch(`/api/v1/admin/tenants/${n}`,{headers:e?{Authorization:`Bearer ${e}`}:{}}),t=await r.json();if(t.success){if(c(t.data),q({name:t.data.name,slug:t.data.slug,description:t.data.description||"",logo:t.data.logo||"",requiresLogin:t.data.requiresLogin,isActive:t.data.isActive}),T(t.data.categories.map(e=>e.category)),$(t.data.kbArticles.map(e=>e.article.id)),t.data.logo){let e=t.data.logo.startsWith("http")?t.data.logo:`${window.location.origin}${t.data.logo}`;j(e)}}else b(t.error?.message||"Failed to load tenant")}catch(e){b("An unexpected error occurred")}finally{g(!1)}},G=async()=>{try{let e=localStorage.getItem("accessToken"),r=await fetch("/api/v1/kb",{headers:e?{Authorization:`Bearer ${e}`}:{}}),t=await r.json();t.success&&C(t.data)}catch(e){}},H=async()=>{try{let e=localStorage.getItem("accessToken"),r=await fetch("/api/v1/admin/users",{headers:e?{Authorization:`Bearer ${e}`}:{}}),t=await r.json();t.success&&R(t.data.users||[])}catch(e){}},J=async e=>{let r=e.target.files?.[0];if(!r)return;if(!["image/jpeg","image/jpg","image/png","image/gif","image/webp"].includes(r.type))return void b("Invalid file type. Only images (JPEG, PNG, GIF, WebP) are allowed.");if(r.size>5242880)return void b("File size exceeds 5MB limit.");let t=new FileReader;t.onload=e=>{j(e.target?.result)},t.readAsDataURL(r),y(!0),b("");try{let e=new FormData;e.append("file",r);let t=localStorage.getItem("accessToken"),a=await fetch("/api/v1/admin/tenants/upload-logo",{method:"POST",headers:{Authorization:`Bearer ${t}`},body:e}),i=await a.json();i.success?q({...U,logo:i.data.url}):(b(i.error?.message||"Failed to upload logo"),j(null))}catch(e){b("Failed to upload logo"),j(null)}finally{y(!1)}},M=async e=>{e.preventDefault(),u(!0),b("");try{let e=localStorage.getItem("accessToken"),r=await fetch(`/api/v1/admin/tenants/${n}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify(U)}),t=await r.json();t.success?(b(""),await Promise.all([V(),Y()]),K()):b(t.error?.message||"Failed to update tenant")}catch(e){b("An unexpected error occurred")}finally{u(!1)}},V=async()=>{try{let e=localStorage.getItem("accessToken");await fetch(`/api/v1/admin/tenants/${n}/categories`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({categories:B})})}catch(e){}},Y=async()=>{try{let e=localStorage.getItem("accessToken");await fetch(`/api/v1/admin/tenants/${n}/kb-articles`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({articleIds:z})})}catch(e){}},_=()=>{A.trim()&&!B.includes(A.trim())&&(T([...B,A.trim()]),I(""))},Q=()=>d?`${window.location.origin}/tenant/${d.slug}`:"",X=async()=>{let e=Q();try{await navigator.clipboard.writeText(e),E(!0),setTimeout(()=>E(!1),2e3)}catch(e){console.error("Failed to copy:",e)}},Z=async()=>{if(W)try{let e=localStorage.getItem("accessToken"),r=await fetch(`/api/v1/admin/tenants/${n}/assignments`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({userId:W,category:L?null:P||null})}),t=await r.json();t.success?(N(""),F(""),O(!1),K()):b(t.error?.message||"Failed to add assignment")}catch(e){b("An unexpected error occurred")}},ee=async e=>{try{let r=localStorage.getItem("accessToken");(await fetch(`/api/v1/admin/tenants/${n}/assignments?assignmentId=${e}`,{method:"DELETE",headers:{Authorization:`Bearer ${r}`}})).ok&&K()}catch(e){b("Failed to remove assignment")}};return p?(0,r.jsx)("div",{style:{padding:"2rem"},children:(0,r.jsx)("p",{children:"Loading tenant..."})}):d?(0,r.jsxs)("div",{style:{padding:"2rem",maxWidth:"1400px",margin:"0 auto"},children:[(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"2rem"},children:[(0,r.jsxs)("h1",{style:{fontSize:"2rem",margin:0},children:["Edit Tenant: ",d.name]}),(0,r.jsx)(i.default,{href:"/admin/tenants",style:{padding:"0.75rem 1.5rem",backgroundColor:"var(--bg-tertiary)",color:"var(--text-primary)",textDecoration:"none",borderRadius:"8px"},children:"Back to Tenants"})]}),x&&(0,r.jsx)("div",{style:{padding:"1rem",backgroundColor:"rgba(239, 68, 68, 0.1)",color:"var(--error)",borderRadius:"8px",marginBottom:"1.5rem"},children:x}),(0,r.jsx)("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"2rem",borderBottom:"1px solid var(--border-color)"},children:["basic","categories","kb","fields","assignments"].map(e=>(0,r.jsx)("button",{onClick:()=>k(e),style:{padding:"0.75rem 1.5rem",backgroundColor:f===e?"var(--bg-tertiary)":"transparent",color:"var(--text-primary)",border:"none",borderBottom:f===e?"2px solid var(--accent-primary)":"2px solid transparent",cursor:"pointer",textTransform:"capitalize"},children:"kb"===e?"KB Articles":e},e))}),"basic"===f&&(0,r.jsxs)("form",{onSubmit:M,style:{display:"grid",gap:"1.5rem"},children:[d&&(0,r.jsxs)("div",{style:{padding:"1.5rem",backgroundColor:"var(--bg-secondary)",borderRadius:"8px",border:"1px solid var(--border-color)"},children:[(0,r.jsx)("label",{style:{display:"block",marginBottom:"0.75rem",fontWeight:600,fontSize:"0.875rem"},children:"Public URL (Share with customers)"}),(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,r.jsx)("code",{style:{flex:1,padding:"0.75rem",backgroundColor:"var(--bg-primary)",borderRadius:"6px",fontSize:"0.875rem",fontFamily:"monospace",color:"var(--accent-primary)",border:"1px solid var(--border-color)",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},title:Q(),children:Q()}),(0,r.jsx)("button",{type:"button",onClick:X,style:{padding:"0.75rem 1rem",backgroundColor:D?"var(--success)":"var(--accent-primary)",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.875rem",fontWeight:500,transition:"background-color 0.2s"},title:"Copy URL",children:D?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.CheckIcon,{style:{width:"16px",height:"16px"}}),"Copied!"]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.DocumentDuplicateIcon,{style:{width:"16px",height:"16px"}}),"Copy"]})}),(0,r.jsx)("a",{href:`/tenant/${d.slug}`,target:"_blank",rel:"noopener noreferrer",style:{padding:"0.75rem 1rem",backgroundColor:"var(--bg-tertiary)",color:"var(--text-primary)",textDecoration:"none",borderRadius:"6px",fontSize:"0.875rem",fontWeight:500,border:"1px solid var(--border-color)"},title:"Open in new tab",children:"Open"})]}),(0,r.jsx)("p",{style:{marginTop:"0.75rem",fontSize:"0.75rem",color:"var(--text-secondary)"},children:"Customers can use this URL to submit tickets, view knowledge base articles, and chat with AI support."})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:500},children:"Tenant Name *"}),(0,r.jsx)("input",{type:"text",required:!0,value:U.name,onChange:e=>q({...U,name:e.target.value}),style:{width:"100%",padding:"0.75rem",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--bg-primary)",color:"var(--text-primary)"}})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:500},children:"Slug *"}),(0,r.jsx)("input",{type:"text",required:!0,value:U.slug,onChange:e=>q({...U,slug:e.target.value}),pattern:"[a-z0-9-]+",style:{width:"100%",padding:"0.75rem",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--bg-primary)",color:"var(--text-primary)"}})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:500},children:"Description"}),(0,r.jsx)("textarea",{value:U.description,onChange:e=>q({...U,description:e.target.value}),rows:4,style:{width:"100%",padding:"0.75rem",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--bg-primary)",color:"var(--text-primary)"}})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:500},children:"Logo"}),(0,r.jsx)("input",{ref:l,type:"file",accept:"image/jpeg,image/jpg,image/png,image/gif,image/webp",onChange:J,disabled:h,style:{width:"100%",padding:"0.75rem",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--bg-primary)",color:"var(--text-primary)",cursor:h?"not-allowed":"pointer",opacity:h?.6:1}}),(0,r.jsx)("p",{style:{fontSize:"0.75rem",color:"var(--text-secondary)",marginTop:"0.25rem"},children:"Upload an image file (JPEG, PNG, GIF, WebP). Max size: 5MB"}),v&&(0,r.jsxs)("div",{style:{marginTop:"1rem",position:"relative",display:"inline-block"},children:[(0,r.jsx)("img",{src:v,alt:"Logo preview",style:{maxWidth:"200px",maxHeight:"200px",borderRadius:"8px",border:"1px solid var(--border-color)",padding:"0.5rem",backgroundColor:"var(--bg-secondary)"}}),(0,r.jsx)("button",{type:"button",onClick:()=>{j(null),q({...U,logo:""}),l.current&&(l.current.value="")},style:{position:"absolute",top:"0.5rem",right:"0.5rem",padding:"0.25rem 0.5rem",backgroundColor:"rgba(239, 68, 68, 0.9)",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"0.75rem"},children:"Remove"})]})]}),(0,r.jsx)("div",{style:{display:"flex",gap:"2rem"},children:(0,r.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer"},children:[(0,r.jsx)("input",{type:"checkbox",checked:U.requiresLogin,onChange:e=>q({...U,requiresLogin:e.target.checked}),style:{width:"18px",height:"18px"}}),(0,r.jsx)("span",{children:"Require login to submit tickets"})]})}),(0,r.jsx)("div",{style:{display:"flex",gap:"2rem"},children:(0,r.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer"},children:[(0,r.jsx)("input",{type:"checkbox",checked:U.isActive,onChange:e=>q({...U,isActive:e.target.checked}),style:{width:"18px",height:"18px"}}),(0,r.jsx)("span",{children:"Active"})]})}),(0,r.jsx)("div",{style:{display:"flex",gap:"1rem",marginTop:"1rem"},children:(0,r.jsx)("button",{type:"submit",disabled:m,style:{padding:"0.75rem 1.5rem",backgroundColor:"var(--accent-primary)",color:"white",border:"none",borderRadius:"8px",cursor:m?"not-allowed":"pointer",fontSize:"0.875rem",fontWeight:600,opacity:m?.6:1},children:m?"Saving...":"Save Changes"})})]}),"categories"===f&&(0,r.jsxs)("div",{style:{display:"grid",gap:"1.5rem"},children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:500},children:"Add Category"}),(0,r.jsxs)("div",{style:{display:"flex",gap:"0.5rem"},children:[(0,r.jsx)("input",{type:"text",value:A,onChange:e=>I(e.target.value),onKeyPress:e=>{"Enter"===e.key&&(e.preventDefault(),_())},placeholder:"Category name",style:{flex:1,padding:"0.75rem",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--bg-primary)",color:"var(--text-primary)"}}),(0,r.jsx)("button",{type:"button",onClick:_,style:{padding:"0.75rem 1.5rem",backgroundColor:"var(--accent-primary)",color:"white",border:"none",borderRadius:"8px",cursor:"pointer"},children:"Add"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{style:{marginBottom:"1rem"},children:"Categories"}),0===B.length?(0,r.jsx)("p",{style:{color:"var(--text-secondary)"},children:"No categories added yet."}):(0,r.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem"},children:B.map(e=>(0,r.jsxs)("span",{style:{padding:"0.5rem 1rem",backgroundColor:"var(--bg-tertiary)",borderRadius:"8px",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e,(0,r.jsx)("button",{type:"button",onClick:()=>{T(B.filter(r=>r!==e))},style:{background:"none",border:"none",color:"var(--error)",cursor:"pointer",padding:"0",fontSize:"1.25rem"},children:"Ã—"})]},e))})]}),(0,r.jsx)("button",{onClick:async()=>{await V(),b("Categories saved!"),setTimeout(()=>b(""),3e3)},style:{padding:"0.75rem 1.5rem",backgroundColor:"var(--accent-primary)",color:"white",border:"none",borderRadius:"8px",cursor:"pointer"},children:"Save Categories"})]}),"kb"===f&&(0,r.jsxs)("div",{style:{display:"grid",gap:"1.5rem"},children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{style:{marginBottom:"1rem"},children:"Select Knowledge Base Articles"}),(0,r.jsx)("div",{style:{maxHeight:"400px",overflowY:"auto",border:"1px solid var(--border-color)",borderRadius:"8px",padding:"1rem"},children:w.map(e=>(0,r.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem",cursor:"pointer"},children:[(0,r.jsx)("input",{type:"checkbox",checked:z.includes(e.id),onChange:r=>{r.target.checked?$([...z,e.id]):$(z.filter(r=>r!==e.id))}}),(0,r.jsx)("span",{children:e.title})]},e.id))})]}),(0,r.jsx)("button",{onClick:async()=>{await Y(),b("KB articles saved!"),setTimeout(()=>b(""),3e3)},style:{padding:"0.75rem 1.5rem",backgroundColor:"var(--accent-primary)",color:"white",border:"none",borderRadius:"8px",cursor:"pointer"},children:"Save KB Articles"})]}),"fields"===f&&(0,r.jsx)("div",{children:(0,r.jsx)("p",{style:{color:"var(--text-secondary)"},children:"Custom fields management coming soon..."})}),"assignments"===f&&(0,r.jsxs)("div",{style:{display:"grid",gap:"1.5rem"},children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{style:{marginBottom:"1rem"},children:"Add Assignment"}),(0,r.jsxs)("div",{style:{display:"grid",gap:"1rem",padding:"1rem",backgroundColor:"var(--bg-secondary)",borderRadius:"8px"},children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:500},children:"User"}),(0,r.jsxs)("select",{value:W,onChange:e=>N(e.target.value),style:{width:"100%",padding:"0.75rem",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--bg-primary)",color:"var(--text-primary)"},children:[(0,r.jsx)("option",{value:"",children:"Select a user..."}),S.map(e=>(0,r.jsx)("option",{value:e.id,children:e.firstName&&e.lastName?`${e.firstName} ${e.lastName}`:e.email},e.id))]})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer",marginBottom:"0.5rem"},children:[(0,r.jsx)("input",{type:"checkbox",checked:L,onChange:e=>{O(e.target.checked),e.target.checked&&F("")}}),(0,r.jsx)("span",{children:"Assign to all categories"})]}),!L&&(0,r.jsxs)("select",{value:P,onChange:e=>F(e.target.value),style:{width:"100%",padding:"0.75rem",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--bg-primary)",color:"var(--text-primary)"},children:[(0,r.jsx)("option",{value:"",children:"All categories"}),B.map(e=>(0,r.jsx)("option",{value:e,children:e},e))]})]}),(0,r.jsx)("button",{onClick:Z,disabled:!W,style:{padding:"0.75rem 1.5rem",backgroundColor:"var(--accent-primary)",color:"white",border:"none",borderRadius:"8px",cursor:W?"pointer":"not-allowed",opacity:W?1:.6},children:"Add Assignment"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{style:{marginBottom:"1rem"},children:"Current Assignments"}),0===d.assignments.length?(0,r.jsx)("p",{style:{color:"var(--text-secondary)"},children:"No assignments yet."}):(0,r.jsx)("div",{style:{display:"grid",gap:"0.5rem"},children:d.assignments.map(e=>(0,r.jsxs)("div",{style:{padding:"1rem",backgroundColor:"var(--bg-secondary)",borderRadius:"8px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{style:{fontWeight:500},children:e.user.firstName&&e.user.lastName?`${e.user.firstName} ${e.user.lastName}`:e.user.email}),(0,r.jsx)("div",{style:{fontSize:"0.875rem",color:"var(--text-secondary)"},children:e.category||"All categories"})]}),(0,r.jsx)("button",{onClick:()=>ee(e.id),style:{padding:"0.5rem 1rem",backgroundColor:"rgba(239, 68, 68, 0.1)",color:"var(--error)",border:"none",borderRadius:"6px",cursor:"pointer"},children:"Remove"})]},e.id))})]})]})]}):(0,r.jsxs)("div",{style:{padding:"2rem"},children:[(0,r.jsx)("p",{children:"Tenant not found"}),(0,r.jsx)(i.default,{href:"/admin/tenants",children:"Back to Tenants"})]})}e.s(["default",()=>n])}]);