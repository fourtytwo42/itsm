module.exports=[25398,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(29173);function f(){(0,d.useRouter)();let[a,f]=(0,c.useState)(null),[g,h]=(0,c.useState)(!0),[i,j]=(0,c.useState)(!1),[k,l]=(0,c.useState)(""),[m,n]=(0,c.useState)(""),[o,p]=(0,c.useState)(null),[q,r]=(0,c.useState)(null),[s,t]=(0,c.useState)("details"),[u,v]=(0,c.useState)(null),[w,x]=(0,c.useState)(!1),[y,z]=(0,c.useState)(""),[A,B]=(0,c.useState)(""),[C,D]=(0,c.useState)({providerName:"",protocol:e.EmailProtocol.SMTP,host:"",port:587,username:"",password:"",encryption:e.EmailEncryption.TLS,pollingIntervalMinutes:5});(0,c.useEffect)(()=>{E(),"email"===s&&F()},[s]);let E=async()=>{try{let a=localStorage.getItem("accessToken"),b=await fetch("/api/v1/organizations/me",{headers:{Authorization:`Bearer ${a}`}});if(!b.ok)throw Error("Failed to fetch organization");let c=await b.json();f(c.organization),c.organization?.logo&&r(c.organization.logo)}catch(a){l(a.message)}finally{h(!1)}},F=async()=>{try{let a=localStorage.getItem("accessToken"),b=await fetch("/api/v1/organizations/email-config",{headers:{Authorization:`Bearer ${a}`}});if(!b.ok){if(404===b.status)return void v(null);throw Error("Failed to fetch email configuration")}let c=await b.json();c.success&&c.data?(v(c.data),D({providerName:c.data.providerName||"",protocol:c.data.protocol,host:c.data.host||"",port:c.data.port||587,username:c.data.username||"",password:"",encryption:c.data.encryption||e.EmailEncryption.TLS,pollingIntervalMinutes:c.data.pollingIntervalMinutes||5})):v(null)}catch(a){console.error("Error fetching email config:",a),v(null)}},G=async a=>{a.preventDefault(),x(!0),z(""),B("");try{let a=localStorage.getItem("accessToken"),b=await fetch("/api/v1/organizations/email-config",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify(C)}),c=await b.json();if(!b.ok)throw Error(c.error?.message||"Failed to save email configuration");B("Email configuration saved successfully"),v(c.data)}catch(a){z(a.message)}finally{x(!1)}},H=async()=>{if(o&&a){j(!0),l(""),n("");try{let b=localStorage.getItem("accessToken"),c=new FormData;c.append("file",o),c.append("organizationId",a.id);let d=await fetch("/api/v1/organizations/upload-logo",{method:"POST",headers:{Authorization:`Bearer ${b}`},body:c}),e=await d.json();if(!d.ok)throw Error(e.error||"Failed to upload logo");n("Logo uploaded successfully"),p(null),e.logoUrl&&(r(e.logoUrl),f({...a,logo:e.logoUrl}))}catch(a){l(a.message)}finally{j(!1)}}},I=async b=>{if(b.preventDefault(),a){j(!0),l(""),n("");try{let b=localStorage.getItem("accessToken"),c=await fetch("/api/v1/organizations/me",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${b}`},body:JSON.stringify({name:a.name,description:a.description})}),d=await c.json();if(!c.ok)throw Error(d.error||"Failed to update organization");n("Organization updated successfully"),f(d.organization||d)}catch(a){l(a.message)}finally{j(!1)}}};return g?(0,b.jsx)("div",{children:"Loading organization settings..."}):a?(0,b.jsxs)("div",{style:{padding:"2rem",maxWidth:"1000px",margin:"0 auto"},children:[(0,b.jsx)("h1",{style:{marginBottom:"2rem"},children:"Organization Settings"}),(0,b.jsxs)("div",{style:{display:"flex",gap:"1rem",borderBottom:"1px solid var(--border-color)",marginBottom:"2rem"},children:[(0,b.jsx)("button",{onClick:()=>t("details"),style:{padding:"0.75rem 1.5rem",border:"none",background:"none",borderBottom:"details"===s?"2px solid var(--accent-primary)":"2px solid transparent",cursor:"pointer",color:"details"===s?"var(--accent-primary)":"var(--text-secondary)",fontWeight:"details"===s?600:400},children:"Details"}),(0,b.jsx)("button",{onClick:()=>t("email"),style:{padding:"0.75rem 1.5rem",border:"none",background:"none",borderBottom:"email"===s?"2px solid var(--accent-primary)":"2px solid transparent",cursor:"pointer",color:"email"===s?"var(--accent-primary)":"var(--text-secondary)",fontWeight:"email"===s?600:400},children:"Email (SMTP)"})]}),k&&(0,b.jsx)("div",{style:{padding:"0.75rem",backgroundColor:"rgba(239, 68, 68, 0.1)",border:"1px solid var(--error)",borderRadius:"0.5rem",marginBottom:"1rem",color:"var(--error)"},children:k}),m&&(0,b.jsx)("div",{style:{padding:"0.75rem",backgroundColor:"rgba(34, 197, 94, 0.1)",border:"1px solid var(--success)",borderRadius:"0.5rem",marginBottom:"1rem",color:"var(--success)"},children:m}),"details"===s&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"card",style:{padding:"2rem",marginBottom:"2rem"},children:[(0,b.jsx)("h2",{style:{marginBottom:"1.5rem"},children:"Logo"}),(0,b.jsxs)("div",{style:{display:"flex",gap:"1.5rem",alignItems:"flex-start"},children:[q&&(0,b.jsx)("img",{src:q,alt:"Organization logo",style:{width:"120px",height:"120px",objectFit:"contain",borderRadius:"0.5rem",border:"1px solid var(--border)"}}),(0,b.jsxs)("div",{style:{flex:1},children:[(0,b.jsx)("input",{type:"file",accept:"image/*",onChange:a=>{let b=a.target.files?.[0];if(b){p(b);let a=new FileReader;a.onloadend=()=>{r(a.result)},a.readAsDataURL(b)}},style:{marginBottom:"1rem"},disabled:i}),o&&(0,b.jsx)("button",{type:"button",className:"btn btn-primary",onClick:H,disabled:i,children:i?"Uploading...":"Upload Logo"})]})]})]}),(0,b.jsxs)("div",{className:"card",style:{padding:"2rem"},children:[(0,b.jsx)("h2",{style:{marginBottom:"1.5rem"},children:"Organization Details"}),(0,b.jsxs)("form",{onSubmit:I,children:[(0,b.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,b.jsx)("label",{className:"label",htmlFor:"name",children:"Organization Name"}),(0,b.jsx)("input",{id:"name",type:"text",className:"input",value:a.name,onChange:b=>f({...a,name:b.target.value}),required:!0,disabled:i})]}),(0,b.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,b.jsx)("label",{className:"label",htmlFor:"slug",children:"Slug"}),(0,b.jsx)("input",{id:"slug",type:"text",className:"input",value:a.slug,disabled:!0,style:{backgroundColor:"var(--bg-secondary)",color:"var(--text-secondary)"}}),(0,b.jsx)("p",{style:{fontSize:"0.875rem",color:"var(--text-secondary)",marginTop:"0.25rem"},children:"Slug cannot be changed after creation"})]}),(0,b.jsxs)("div",{style:{marginBottom:"1.5rem"},children:[(0,b.jsx)("label",{className:"label",htmlFor:"description",children:"Description"}),(0,b.jsx)("textarea",{id:"description",className:"input",value:a.description||"",onChange:b=>f({...a,description:b.target.value}),rows:4,disabled:i})]}),(0,b.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:i,children:i?"Saving...":"Save Changes"})]})]})]}),"email"===s&&(0,b.jsxs)("div",{className:"card",style:{padding:"2rem"},children:[(0,b.jsx)("h2",{style:{marginBottom:"1.5rem"},children:"SMTP Email Configuration"}),y&&(0,b.jsx)("div",{style:{padding:"0.75rem",backgroundColor:"rgba(239, 68, 68, 0.1)",border:"1px solid var(--error)",borderRadius:"0.5rem",marginBottom:"1rem",color:"var(--error)"},children:y}),A&&(0,b.jsx)("div",{style:{padding:"0.75rem",backgroundColor:"rgba(34, 197, 94, 0.1)",border:"1px solid var(--success)",borderRadius:"0.5rem",marginBottom:"1rem",color:"var(--success)"},children:A}),(0,b.jsxs)("form",{onSubmit:G,children:[(0,b.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,b.jsx)("label",{className:"label",htmlFor:"providerName",children:"Provider Name (Optional)"}),(0,b.jsx)("input",{id:"providerName",type:"text",className:"input",value:C.providerName,onChange:a=>D({...C,providerName:a.target.value}),placeholder:"e.g., Gmail, SendGrid, AWS SES",disabled:w})]}),(0,b.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,b.jsx)("label",{className:"label",htmlFor:"protocol",children:"Protocol *"}),(0,b.jsxs)("select",{id:"protocol",className:"input",value:C.protocol,onChange:a=>D({...C,protocol:a.target.value}),required:!0,disabled:w,children:[(0,b.jsx)("option",{value:e.EmailProtocol.SMTP,children:"SMTP"}),(0,b.jsx)("option",{value:e.EmailProtocol.IMAP,children:"IMAP"}),(0,b.jsx)("option",{value:e.EmailProtocol.POP3,children:"POP3"})]})]}),(0,b.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,b.jsx)("label",{className:"label",htmlFor:"host",children:"SMTP Host *"}),(0,b.jsx)("input",{id:"host",type:"text",className:"input",value:C.host,onChange:a=>D({...C,host:a.target.value}),placeholder:"e.g., smtp.gmail.com, smtp.sendgrid.net",required:!0,disabled:w})]}),(0,b.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,b.jsx)("label",{className:"label",htmlFor:"port",children:"Port *"}),(0,b.jsx)("input",{id:"port",type:"number",className:"input",value:C.port,onChange:a=>D({...C,port:parseInt(a.target.value)||587}),min:"1",max:"65535",required:!0,disabled:w}),(0,b.jsx)("small",{style:{color:"var(--text-secondary)",fontSize:"0.875rem",marginTop:"0.25rem",display:"block"},children:"Common ports: 587 (TLS), 465 (SSL), 25 (unencrypted)"})]}),(0,b.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,b.jsx)("label",{className:"label",htmlFor:"username",children:"Username / Email *"}),(0,b.jsx)("input",{id:"username",type:"text",className:"input",value:C.username,onChange:a=>D({...C,username:a.target.value}),placeholder:"your-email@example.com",required:!0,disabled:w})]}),(0,b.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,b.jsx)("label",{className:"label",htmlFor:"password",children:"Password *"}),(0,b.jsx)("input",{id:"password",type:"password",className:"input",value:C.password,onChange:a=>D({...C,password:a.target.value}),placeholder:u?"Leave blank to keep current password":"Enter SMTP password",required:!u,disabled:w}),u&&(0,b.jsx)("small",{style:{color:"var(--text-secondary)",fontSize:"0.875rem",marginTop:"0.25rem",display:"block"},children:"Leave blank to keep the current password"})]}),(0,b.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,b.jsx)("label",{className:"label",htmlFor:"encryption",children:"Encryption *"}),(0,b.jsxs)("select",{id:"encryption",className:"input",value:C.encryption,onChange:a=>D({...C,encryption:a.target.value}),required:!0,disabled:w,children:[(0,b.jsx)("option",{value:e.EmailEncryption.NONE,children:"None"}),(0,b.jsx)("option",{value:e.EmailEncryption.SSL,children:"SSL"}),(0,b.jsx)("option",{value:e.EmailEncryption.TLS,children:"TLS"})]}),(0,b.jsx)("small",{style:{color:"var(--text-secondary)",fontSize:"0.875rem",marginTop:"0.25rem",display:"block"},children:"Recommended: TLS (port 587) or SSL (port 465)"})]}),(0,b.jsxs)("div",{style:{marginBottom:"1.5rem"},children:[(0,b.jsx)("label",{className:"label",htmlFor:"pollingIntervalMinutes",children:"Polling Interval (Minutes)"}),(0,b.jsx)("input",{id:"pollingIntervalMinutes",type:"number",className:"input",value:C.pollingIntervalMinutes,onChange:a=>D({...C,pollingIntervalMinutes:parseInt(a.target.value)||5}),min:"1",max:"60",disabled:w}),(0,b.jsx)("small",{style:{color:"var(--text-secondary)",fontSize:"0.875rem",marginTop:"0.25rem",display:"block"},children:"How often to check for new emails (for IMAP/POP3)"})]}),(0,b.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:w,children:w?"Saving...":u?"Update Configuration":"Save Configuration"})]})]})]}):(0,b.jsx)("div",{children:"Organization not found"})}a.s(["default",()=>f])}];

//# sourceMappingURL=app_organization_settings_page_tsx_0a0ea5e4._.js.map