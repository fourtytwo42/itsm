(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,1749,e=>{"use strict";var t=e.i(43476),a=e.i(71645),r=e.i(18566),s=e.i(22016);function l(){let e=(0,r.useRouter)(),[l,i]=(0,a.useState)(!1),[n,o]=(0,a.useState)(""),[d,c]=(0,a.useState)([]),[u,m]=(0,a.useState)(null),[p,h]=(0,a.useState)([]),[g,y]=(0,a.useState)([]),[x,f]=(0,a.useState)({}),[v,b]=(0,a.useState)({name:"",tenantId:"",customAssetTypeId:"",assignedToId:"",status:"ACTIVE"}),[j,N]=(0,a.useState)(""),[T,I]=(0,a.useState)(!1),[C,A]=(0,a.useState)(null);(0,a.useEffect)(()=>{S(),k(),w()},[]),(0,a.useEffect)(()=>{if(v.customAssetTypeId){let e=d.find(e=>e.id===v.customAssetTypeId);if(m(e||null),e&&e.customFields){let t={};e.customFields.forEach(e=>{e.defaultValue&&(t[e.fieldName]=e.defaultValue)}),f(t)}}else m(null),f({})},[v.customAssetTypeId,d]);let S=async()=>{try{let e=localStorage.getItem("accessToken"),t=await fetch("/api/v1/admin/tenants",{headers:e?{Authorization:`Bearer ${e}`}:{}}),a=await t.json();if(a.success){let e=a.data?.tenants||a.data||[];h(e)}}catch(e){console.error("Failed to load tenants:",e)}},k=async()=>{try{let e=localStorage.getItem("accessToken"),t=await fetch("/api/v1/admin/asset-types?isActive=true",{headers:e?{Authorization:`Bearer ${e}`}:{}}),a=await t.json();a.success&&c(a.data.assetTypes)}catch(e){console.error("Failed to load asset types:",e)}},w=async()=>{try{let e=localStorage.getItem("accessToken"),t=await fetch("/api/v1/admin/users?limit=1000",{headers:e?{Authorization:`Bearer ${e}`}:{}}),a=await t.json();if(a.success){let e=(a.data?.users||a.data||[]).filter(e=>"END_USER"===e.role||e.roles?.includes("END_USER"));y(e)}}catch(e){console.error("Failed to load users:",e)}};(0,a.useEffect)(()=>{if(v.assignedToId&&g.length>0){let e=g.find(e=>e.id===v.assignedToId);e&&(A(e),N(e.firstName||e.lastName?`${e.firstName||""} ${e.lastName||""}`.trim():e.email))}else v.assignedToId||(A(null),N(""))},[v.assignedToId,g]);let B=g.filter(e=>{if(!j)return!1;let t=j.toLowerCase(),a=`${e.firstName||""} ${e.lastName||""}`.trim().toLowerCase(),r=e.email.toLowerCase();return a.includes(t)||r.includes(t)}),E=async t=>{if(t.preventDefault(),o(""),i(!0),!v.customAssetTypeId){o("Please select an asset type"),i(!1);return}try{let t=localStorage.getItem("accessToken"),a=await fetch("/api/v1/assets",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({name:v.name,tenantId:v.tenantId||void 0,customAssetTypeId:v.customAssetTypeId,assignedToId:v.assignedToId||void 0,status:v.status,customFields:Object.keys(x).length>0?x:void 0})}),r=await a.json();r.success?e.push(`/assets/${r.data.asset.id}`):(o(r.error?.message||"Failed to create asset"),i(!1))}catch(e){o("An unexpected error occurred"),i(!1)}};return(0,t.jsxs)("div",{style:{padding:"2rem",maxWidth:"800px",margin:"0 auto"},children:[(0,t.jsx)("div",{style:{marginBottom:"2rem"},children:(0,t.jsx)(s.default,{href:"/assets",style:{color:"var(--accent-primary)",textDecoration:"none"},children:"← Back to Assets"})}),(0,t.jsx)("h1",{style:{marginBottom:"2rem"},children:"Create New Asset"}),n&&(0,t.jsx)("div",{style:{padding:"0.75rem",backgroundColor:"rgba(239, 68, 68, 0.1)",border:"1px solid var(--error)",borderRadius:"0.5rem",marginBottom:"1rem",color:"var(--error)"},children:n}),0===d.length&&(0,t.jsx)("div",{style:{padding:"1.5rem",backgroundColor:"rgba(59, 130, 246, 0.1)",border:"1px solid var(--accent-primary)",borderRadius:"0.5rem",marginBottom:"1.5rem"},children:(0,t.jsxs)("p",{style:{margin:0,color:"var(--text-primary)"},children:["No asset types found. Please"," ",(0,t.jsx)(s.default,{href:"/admin/asset-types",style:{color:"var(--accent-primary)",textDecoration:"underline"},children:"create an asset type"})," ","first before creating assets."]})}),(0,t.jsxs)("form",{onSubmit:E,style:{display:"grid",gap:"1.5rem"},children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:500},children:"Tenant (Optional)"}),(0,t.jsxs)("select",{className:"input",value:v.tenantId,onChange:e=>b({...v,tenantId:e.target.value}),disabled:l,children:[(0,t.jsx)("option",{value:"",children:"No tenant"}),p.map(e=>(0,t.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:500},children:["Asset Type ",(0,t.jsx)("span",{style:{color:"var(--error)"},children:"*"})]}),(0,t.jsxs)("select",{className:"input",value:v.customAssetTypeId,onChange:e=>b({...v,customAssetTypeId:e.target.value}),required:!0,disabled:l||0===d.length,children:[(0,t.jsx)("option",{value:"",children:"Select an asset type..."}),d.map(e=>(0,t.jsx)("option",{value:e.id,children:e.name},e.id))]}),u?.description&&(0,t.jsx)("p",{style:{marginTop:"0.5rem",fontSize:"0.875rem",color:"var(--text-secondary)"},children:u.description})]}),u&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:500},children:["Name ",(0,t.jsx)("span",{style:{color:"var(--error)"},children:"*"})]}),(0,t.jsx)("input",{type:"text",className:"input",value:v.name,onChange:e=>b({...v,name:e.target.value}),required:!0,disabled:l})]}),(0,t.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:500},children:"Status"}),(0,t.jsxs)("select",{className:"input",value:v.status,onChange:e=>b({...v,status:e.target.value}),disabled:l,children:[(0,t.jsx)("option",{value:"ACTIVE",children:"Active"}),(0,t.jsx)("option",{value:"INACTIVE",children:"Inactive"}),(0,t.jsx)("option",{value:"RETIRED",children:"Retired"}),(0,t.jsx)("option",{value:"MAINTENANCE",children:"Maintenance"})]})]}),(0,t.jsxs)("div",{style:{position:"relative"},"data-user-search":!0,children:[(0,t.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:500},children:"Assign To User (Optional)"}),C?(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem 0.75rem",border:"1px solid var(--border-color)",borderRadius:"6px",backgroundColor:"var(--bg-primary)"},children:[(0,t.jsx)("span",{children:C.firstName||C.lastName?`${C.firstName||""} ${C.lastName||""}`.trim():C.email}),(0,t.jsx)("button",{type:"button",onClick:()=>{A(null),b({...v,assignedToId:""}),N(""),I(!1)},disabled:l,style:{marginLeft:"auto",padding:"0.25rem 0.5rem",backgroundColor:"transparent",border:"none",color:"var(--text-secondary)",cursor:l?"not-allowed":"pointer",fontSize:"1.25rem",lineHeight:1,display:"flex",alignItems:"center",justifyContent:"center"},title:"Remove user",children:"×"})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("input",{type:"text",className:"input",value:j,onChange:e=>{N(e.target.value),I(!0),b({...v,assignedToId:""})},onFocus:()=>I(!0),placeholder:"Type to search for a user...",disabled:l}),T&&j&&B.length>0&&(0,t.jsx)("div",{style:{position:"absolute",top:"100%",left:0,right:0,marginTop:"0.25rem",backgroundColor:"var(--bg-primary)",border:"1px solid var(--border-color)",borderRadius:"6px",maxHeight:"200px",overflowY:"auto",zIndex:1e3,boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)"},children:B.map(e=>(0,t.jsxs)("div",{onClick:()=>{A(e),b({...v,assignedToId:e.id}),N(e.firstName||e.lastName?`${e.firstName||""} ${e.lastName||""}`.trim():e.email),I(!1)},style:{padding:"0.75rem",cursor:"pointer",borderBottom:"1px solid var(--border-color)"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="var(--bg-secondary)"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="transparent"},children:[(0,t.jsx)("div",{style:{fontWeight:500},children:e.firstName||e.lastName?`${e.firstName||""} ${e.lastName||""}`.trim():e.email}),(e.firstName||e.lastName)&&(0,t.jsx)("div",{style:{fontSize:"0.875rem",color:"var(--text-secondary)"},children:e.email})]},e.id))})]})]})]}),u.customFields&&u.customFields.length>0&&(0,t.jsx)("div",{style:{display:"grid",gap:"1rem"},children:u.customFields.sort((e,t)=>e.order-t.order).map(e=>(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:500},children:[e.label,e.required&&(0,t.jsx)("span",{style:{color:"var(--error)"},children:" *"})]}),(e=>{let a=x[e.fieldName]||e.defaultValue||"";switch(e.fieldType){case"textarea":return(0,t.jsx)("textarea",{className:"input",value:a,onChange:t=>f({...x,[e.fieldName]:t.target.value}),required:e.required,placeholder:e.placeholder,disabled:l,rows:4});case"select":let r=Array.isArray(e.options)?e.options:[];return(0,t.jsxs)("select",{className:"input",value:a,onChange:t=>f({...x,[e.fieldName]:t.target.value}),required:e.required,disabled:l,children:[(0,t.jsx)("option",{value:"",children:"Select..."}),r.map((e,a)=>(0,t.jsx)("option",{value:e,children:e},a))]});case"checkbox":let s=Array.isArray(e.options)?e.options:[];return(0,t.jsx)("div",{children:s.map((a,r)=>(0,t.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.5rem"},children:[(0,t.jsx)("input",{type:"checkbox",checked:!!Array.isArray(x[e.fieldName])&&x[e.fieldName].includes(a),onChange:t=>{let r=Array.isArray(x[e.fieldName])?x[e.fieldName]:[],s=t.target.checked?[...r,a]:r.filter(e=>e!==a);f({...x,[e.fieldName]:s})},disabled:l}),a]},r))});case"date":return(0,t.jsx)("input",{type:"date",className:"input",value:a?new Date(a).toISOString().split("T")[0]:"",onChange:t=>f({...x,[e.fieldName]:t.target.value?new Date(t.target.value).toISOString():""}),required:e.required,disabled:l});case"number":return(0,t.jsx)("input",{type:"number",className:"input",value:a,onChange:t=>f({...x,[e.fieldName]:t.target.value}),required:e.required,placeholder:e.placeholder,disabled:l});default:return(0,t.jsx)("input",{type:"text",className:"input",value:a,onChange:t=>f({...x,[e.fieldName]:t.target.value}),required:e.required,placeholder:e.placeholder,disabled:l})}})(e)]},e.id))})]}),(0,t.jsxs)("div",{style:{display:"flex",gap:"1rem",justifyContent:"flex-end"},children:[(0,t.jsx)(s.default,{href:"/assets",style:{padding:"0.75rem 1.5rem",backgroundColor:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"6px",textDecoration:"none",color:"var(--text-primary)"},children:"Cancel"}),(0,t.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:l||!u,children:l?"Creating...":"Create Asset"})]})]})]})}e.s(["default",()=>l])}]);