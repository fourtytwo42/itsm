module.exports=[44822,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(38246);function f(){let a=(0,d.useRouter)(),[f,g]=(0,c.useState)(!1),[h,i]=(0,c.useState)(""),[j,k]=(0,c.useState)([]),[l,m]=(0,c.useState)(null),[n,o]=(0,c.useState)([]),[p,q]=(0,c.useState)([]),[r,s]=(0,c.useState)({}),[t,u]=(0,c.useState)({name:"",tenantId:"",customAssetTypeId:"",assignedToId:"",status:"ACTIVE"}),[v,w]=(0,c.useState)(""),[x,y]=(0,c.useState)(!1),[z,A]=(0,c.useState)(null);(0,c.useEffect)(()=>{B(),C(),D()},[]),(0,c.useEffect)(()=>{if(t.customAssetTypeId){let a=j.find(a=>a.id===t.customAssetTypeId);if(m(a||null),a&&a.customFields){let b={};a.customFields.forEach(a=>{a.defaultValue&&(b[a.fieldName]=a.defaultValue)}),s(b)}}else m(null),s({})},[t.customAssetTypeId,j]);let B=async()=>{try{let a=localStorage.getItem("accessToken"),b=await fetch("/api/v1/admin/tenants",{headers:a?{Authorization:`Bearer ${a}`}:{}}),c=await b.json();if(c.success){let a=c.data?.tenants||c.data||[];o(a)}}catch(a){console.error("Failed to load tenants:",a)}},C=async()=>{try{let a=localStorage.getItem("accessToken"),b=await fetch("/api/v1/admin/asset-types?isActive=true",{headers:a?{Authorization:`Bearer ${a}`}:{}}),c=await b.json();c.success&&k(c.data.assetTypes)}catch(a){console.error("Failed to load asset types:",a)}},D=async()=>{try{let a=localStorage.getItem("accessToken"),b=await fetch("/api/v1/admin/users?limit=1000",{headers:a?{Authorization:`Bearer ${a}`}:{}}),c=await b.json();if(c.success){let a=(c.data?.users||c.data||[]).filter(a=>"END_USER"===a.role||a.roles?.includes("END_USER"));q(a)}}catch(a){console.error("Failed to load users:",a)}};(0,c.useEffect)(()=>{if(t.assignedToId&&p.length>0){let a=p.find(a=>a.id===t.assignedToId);a&&(A(a),w(a.firstName||a.lastName?`${a.firstName||""} ${a.lastName||""}`.trim():a.email))}else t.assignedToId||(A(null),w(""))},[t.assignedToId,p]);let E=p.filter(a=>{if(!v)return!1;let b=v.toLowerCase(),c=`${a.firstName||""} ${a.lastName||""}`.trim().toLowerCase(),d=a.email.toLowerCase();return c.includes(b)||d.includes(b)}),F=async b=>{if(b.preventDefault(),i(""),g(!0),!t.customAssetTypeId){i("Please select an asset type"),g(!1);return}try{let b=localStorage.getItem("accessToken"),c=await fetch("/api/v1/assets",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${b}`},body:JSON.stringify({name:t.name,tenantId:t.tenantId||void 0,customAssetTypeId:t.customAssetTypeId,assignedToId:t.assignedToId||void 0,status:t.status,customFields:Object.keys(r).length>0?r:void 0})}),d=await c.json();d.success?a.push(`/assets/${d.data.asset.id}`):(i(d.error?.message||"Failed to create asset"),g(!1))}catch(a){i("An unexpected error occurred"),g(!1)}};return(0,b.jsxs)("div",{style:{padding:"2rem",maxWidth:"800px",margin:"0 auto"},children:[(0,b.jsx)("div",{style:{marginBottom:"2rem"},children:(0,b.jsx)(e.default,{href:"/assets",style:{color:"var(--accent-primary)",textDecoration:"none"},children:"← Back to Assets"})}),(0,b.jsx)("h1",{style:{marginBottom:"2rem"},children:"Create New Asset"}),h&&(0,b.jsx)("div",{style:{padding:"0.75rem",backgroundColor:"rgba(239, 68, 68, 0.1)",border:"1px solid var(--error)",borderRadius:"0.5rem",marginBottom:"1rem",color:"var(--error)"},children:h}),0===j.length&&(0,b.jsx)("div",{style:{padding:"1.5rem",backgroundColor:"rgba(59, 130, 246, 0.1)",border:"1px solid var(--accent-primary)",borderRadius:"0.5rem",marginBottom:"1.5rem"},children:(0,b.jsxs)("p",{style:{margin:0,color:"var(--text-primary)"},children:["No asset types found. Please"," ",(0,b.jsx)(e.default,{href:"/admin/asset-types",style:{color:"var(--accent-primary)",textDecoration:"underline"},children:"create an asset type"})," ","first before creating assets."]})}),(0,b.jsxs)("form",{onSubmit:F,style:{display:"grid",gap:"1.5rem"},children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:500},children:"Tenant (Optional)"}),(0,b.jsxs)("select",{className:"input",value:t.tenantId,onChange:a=>u({...t,tenantId:a.target.value}),disabled:f,children:[(0,b.jsx)("option",{value:"",children:"No tenant"}),n.map(a=>(0,b.jsx)("option",{value:a.id,children:a.name},a.id))]})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:500},children:["Asset Type ",(0,b.jsx)("span",{style:{color:"var(--error)"},children:"*"})]}),(0,b.jsxs)("select",{className:"input",value:t.customAssetTypeId,onChange:a=>u({...t,customAssetTypeId:a.target.value}),required:!0,disabled:f||0===j.length,children:[(0,b.jsx)("option",{value:"",children:"Select an asset type..."}),j.map(a=>(0,b.jsx)("option",{value:a.id,children:a.name},a.id))]}),l?.description&&(0,b.jsx)("p",{style:{marginTop:"0.5rem",fontSize:"0.875rem",color:"var(--text-secondary)"},children:l.description})]}),l&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:500},children:["Name ",(0,b.jsx)("span",{style:{color:"var(--error)"},children:"*"})]}),(0,b.jsx)("input",{type:"text",className:"input",value:t.name,onChange:a=>u({...t,name:a.target.value}),required:!0,disabled:f})]}),(0,b.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:500},children:"Status"}),(0,b.jsxs)("select",{className:"input",value:t.status,onChange:a=>u({...t,status:a.target.value}),disabled:f,children:[(0,b.jsx)("option",{value:"ACTIVE",children:"Active"}),(0,b.jsx)("option",{value:"INACTIVE",children:"Inactive"}),(0,b.jsx)("option",{value:"RETIRED",children:"Retired"}),(0,b.jsx)("option",{value:"MAINTENANCE",children:"Maintenance"})]})]}),(0,b.jsxs)("div",{style:{position:"relative"},"data-user-search":!0,children:[(0,b.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:500},children:"Assign To User (Optional)"}),z?(0,b.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem 0.75rem",border:"1px solid var(--border-color)",borderRadius:"6px",backgroundColor:"var(--bg-primary)"},children:[(0,b.jsx)("span",{children:z.firstName||z.lastName?`${z.firstName||""} ${z.lastName||""}`.trim():z.email}),(0,b.jsx)("button",{type:"button",onClick:()=>{A(null),u({...t,assignedToId:""}),w(""),y(!1)},disabled:f,style:{marginLeft:"auto",padding:"0.25rem 0.5rem",backgroundColor:"transparent",border:"none",color:"var(--text-secondary)",cursor:f?"not-allowed":"pointer",fontSize:"1.25rem",lineHeight:1,display:"flex",alignItems:"center",justifyContent:"center"},title:"Remove user",children:"×"})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("input",{type:"text",className:"input",value:v,onChange:a=>{w(a.target.value),y(!0),u({...t,assignedToId:""})},onFocus:()=>y(!0),placeholder:"Type to search for a user...",disabled:f}),x&&v&&E.length>0&&(0,b.jsx)("div",{style:{position:"absolute",top:"100%",left:0,right:0,marginTop:"0.25rem",backgroundColor:"var(--bg-primary)",border:"1px solid var(--border-color)",borderRadius:"6px",maxHeight:"200px",overflowY:"auto",zIndex:1e3,boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)"},children:E.map(a=>(0,b.jsxs)("div",{onClick:()=>{A(a),u({...t,assignedToId:a.id}),w(a.firstName||a.lastName?`${a.firstName||""} ${a.lastName||""}`.trim():a.email),y(!1)},style:{padding:"0.75rem",cursor:"pointer",borderBottom:"1px solid var(--border-color)"},onMouseEnter:a=>{a.currentTarget.style.backgroundColor="var(--bg-secondary)"},onMouseLeave:a=>{a.currentTarget.style.backgroundColor="transparent"},children:[(0,b.jsx)("div",{style:{fontWeight:500},children:a.firstName||a.lastName?`${a.firstName||""} ${a.lastName||""}`.trim():a.email}),(a.firstName||a.lastName)&&(0,b.jsx)("div",{style:{fontSize:"0.875rem",color:"var(--text-secondary)"},children:a.email})]},a.id))})]})]})]}),l.customFields&&l.customFields.length>0&&(0,b.jsx)("div",{style:{display:"grid",gap:"1rem"},children:l.customFields.sort((a,b)=>a.order-b.order).map(a=>(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:500},children:[a.label,a.required&&(0,b.jsx)("span",{style:{color:"var(--error)"},children:" *"})]}),(a=>{let c=r[a.fieldName]||a.defaultValue||"";switch(a.fieldType){case"textarea":return(0,b.jsx)("textarea",{className:"input",value:c,onChange:b=>s({...r,[a.fieldName]:b.target.value}),required:a.required,placeholder:a.placeholder,disabled:f,rows:4});case"select":let d=Array.isArray(a.options)?a.options:[];return(0,b.jsxs)("select",{className:"input",value:c,onChange:b=>s({...r,[a.fieldName]:b.target.value}),required:a.required,disabled:f,children:[(0,b.jsx)("option",{value:"",children:"Select..."}),d.map((a,c)=>(0,b.jsx)("option",{value:a,children:a},c))]});case"checkbox":let e=Array.isArray(a.options)?a.options:[];return(0,b.jsx)("div",{children:e.map((c,d)=>(0,b.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.5rem"},children:[(0,b.jsx)("input",{type:"checkbox",checked:!!Array.isArray(r[a.fieldName])&&r[a.fieldName].includes(c),onChange:b=>{let d=Array.isArray(r[a.fieldName])?r[a.fieldName]:[],e=b.target.checked?[...d,c]:d.filter(a=>a!==c);s({...r,[a.fieldName]:e})},disabled:f}),c]},d))});case"date":return(0,b.jsx)("input",{type:"date",className:"input",value:c?new Date(c).toISOString().split("T")[0]:"",onChange:b=>s({...r,[a.fieldName]:b.target.value?new Date(b.target.value).toISOString():""}),required:a.required,disabled:f});case"number":return(0,b.jsx)("input",{type:"number",className:"input",value:c,onChange:b=>s({...r,[a.fieldName]:b.target.value}),required:a.required,placeholder:a.placeholder,disabled:f});default:return(0,b.jsx)("input",{type:"text",className:"input",value:c,onChange:b=>s({...r,[a.fieldName]:b.target.value}),required:a.required,placeholder:a.placeholder,disabled:f})}})(a)]},a.id))})]}),(0,b.jsxs)("div",{style:{display:"flex",gap:"1rem",justifyContent:"flex-end"},children:[(0,b.jsx)(e.default,{href:"/assets",style:{padding:"0.75rem 1.5rem",backgroundColor:"var(--bg-secondary)",border:"1px solid var(--border-color)",borderRadius:"6px",textDecoration:"none",color:"var(--text-primary)"},children:"Cancel"}),(0,b.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:f||!l,children:f?"Creating...":"Create Asset"})]})]})]})}a.s(["default",()=>f])}];

//# sourceMappingURL=app_assets_new_page_tsx_d0d690f9._.js.map