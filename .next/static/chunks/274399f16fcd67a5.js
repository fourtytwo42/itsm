(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,67409,e=>{"use strict";var t=e.i(18050),r=e.i(71645),s=e.i(18566),a=e.i(22016);function i(){let e=(0,s.useParams)();(0,s.useRouter)();let[i,l]=(0,r.useState)(null),[n,o]=(0,r.useState)(!0),[d,c]=(0,r.useState)(!1),[m,p]=(0,r.useState)([]),[g,u]=(0,r.useState)([]),[y,x]=(0,r.useState)([]),[h,f]=(0,r.useState)(!1),[b,v]=(0,r.useState)(null),[j,S]=(0,r.useState)({});(0,r.useEffect)(()=>{e.id&&(N(e.id),T(),A(e.id),C(e.id))},[e.id]);let N=async e=>{try{o(!0);let t=localStorage.getItem("accessToken"),r=await fetch(`/api/v1/assets/${e}`,{headers:t?{Authorization:`Bearer ${t}`}:{}}),s=await r.json();s.success&&(l(s.data.asset),S({assignedToId:s.data.asset.assignedTo?.id||""}))}catch(e){console.error("Failed to load asset:",e)}finally{o(!1)}},T=async()=>{try{let e=localStorage.getItem("accessToken"),t=await fetch("/api/v1/admin/users?limit=1000",{headers:e?{Authorization:`Bearer ${e}`}:{}}),r=await t.json();if(r.success){let e=r.data?.users||r.data||[];p(e)}}catch(e){console.error("Failed to load users:",e)}},A=async e=>{try{f(!0);let t=localStorage.getItem("accessToken"),r=await fetch(`/api/v1/organizations/audit?entityType=Asset&entityId=${e}&limit=100`,{headers:t?{Authorization:`Bearer ${t}`}:{}}),s=await r.json();s.logs&&u(s.logs)}catch(e){console.error("Failed to load history:",e)}finally{f(!1)}},C=async e=>{try{let t=localStorage.getItem("accessToken"),r=await fetch(`/api/v1/assets/${e}/tickets`,{headers:t?{Authorization:`Bearer ${t}`}:{}}),s=await r.json();s.success&&s.data&&x(s.data)}catch(e){console.error("Failed to load tickets:",e)}},z=async e=>{if(i)try{c(!0);let t=localStorage.getItem("accessToken"),r={};if("assignedToId"===e)r.assignedToId=j[e]||null;else if("name"===e)r.name=j[e];else if("status"===e)r.status=j[e];else if(e.startsWith("customField_")){let t=e.replace("customField_","");r.customFields={...i.customFields||{},[t]:j[e]}}let s=await fetch(`/api/v1/assets/${i.id}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify(r)}),a=await s.json();a.success?(await N(i.id),await A(i.id),v(null)):alert(a.error?.message||"Failed to update asset")}catch(e){alert("An unexpected error occurred")}finally{c(!1)}},$=(e,t)=>{v(e),S({...j,[e]:t})},w=()=>{v(null)},I=({label:e,field:r,value:s,type:a="text",options:i,readOnly:l=!1})=>{let n=b===r,o=s||("date"===a?"":"Not set");return l?(0,t.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"150px 1fr",gap:"1rem",alignItems:"center",padding:"0.75rem 0",borderBottom:"1px solid var(--border-color)"},children:[(0,t.jsxs)("strong",{style:{fontSize:"0.875rem",color:"var(--text-secondary)"},children:[e,":"]}),(0,t.jsx)("span",{style:{fontSize:"0.875rem"},children:o})]}):(0,t.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"150px 1fr auto",gap:"1rem",alignItems:"center",padding:"0.75rem 0",borderBottom:"1px solid var(--border-color)"},children:[(0,t.jsxs)("strong",{style:{fontSize:"0.875rem",color:"var(--text-secondary)"},children:[e,":"]}),n?(0,t.jsxs)("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:["select"===a&&i?(0,t.jsx)("select",{className:"input",value:j[r]||"",onChange:e=>S({...j,[r]:e.target.value}),disabled:d,style:{flex:1,fontSize:"0.875rem",padding:"0.5rem"},children:i.map(e=>(0,t.jsx)("option",{value:e.value,children:e.label},e.value))}):"date"===a?(0,t.jsx)("input",{type:"date",className:"input",value:j[r]?new Date(j[r]).toISOString().split("T")[0]:"",onChange:e=>S({...j,[r]:e.target.value?new Date(e.target.value).toISOString():null}),disabled:d,style:{flex:1,fontSize:"0.875rem",padding:"0.5rem"}}):"number"===a?(0,t.jsx)("input",{type:"number",step:"0.01",className:"input",value:j[r]||"",onChange:e=>S({...j,[r]:e.target.value}),disabled:d,style:{flex:1,fontSize:"0.875rem",padding:"0.5rem"}}):(0,t.jsx)("input",{type:"text",className:"input",value:j[r]||"",onChange:e=>S({...j,[r]:e.target.value}),disabled:d,style:{flex:1,fontSize:"0.875rem",padding:"0.5rem"}}),(0,t.jsx)("button",{className:"btn btn-primary",onClick:()=>z(r),disabled:d,style:{fontSize:"0.75rem",padding:"0.375rem 0.75rem",whiteSpace:"nowrap"},children:d?"Saving...":"Save"}),(0,t.jsx)("button",{className:"btn btn-secondary",onClick:w,disabled:d,style:{fontSize:"0.75rem",padding:"0.375rem 0.75rem",whiteSpace:"nowrap"},children:"Cancel"})]}):(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,t.jsx)("span",{style:{fontSize:"0.875rem",flex:1},children:o}),(0,t.jsx)("button",{onClick:()=>$(r,s),style:{padding:"0.25rem 0.5rem",fontSize:"0.75rem",backgroundColor:"transparent",border:"1px solid var(--border-color)",borderRadius:"4px",color:"var(--accent-primary)",cursor:"pointer"},children:"Edit"})]})]})};if(n)return(0,t.jsx)("div",{style:{padding:"2rem"},children:"Loading asset..."});if(!i)return(0,t.jsxs)("div",{style:{padding:"2rem"},children:[(0,t.jsx)("p",{children:"Asset not found"}),(0,t.jsx)(a.default,{href:"/assets",children:"Back to Assets"})]});let k=i.customFields||{},B=i.customAssetType?.fields||[];return(0,t.jsxs)("div",{style:{padding:"2rem",maxWidth:"1400px",margin:"0 auto"},children:[(0,t.jsxs)("div",{style:{marginBottom:"2rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,t.jsx)(a.default,{href:"/assets",style:{color:"var(--accent-primary)",textDecoration:"none",fontSize:"0.875rem"},children:"← Back to Assets"}),(0,t.jsxs)("div",{style:{fontSize:"0.875rem",color:"var(--text-secondary)"},children:["Asset Number: ",(0,t.jsx)("strong",{children:i.assetNumber})]})]}),(0,t.jsx)("h1",{style:{marginBottom:"2rem",fontSize:"2rem",fontWeight:"bold"},children:i.name}),(0,t.jsxs)("div",{style:{padding:"1.5rem",border:"1px solid var(--border-color)",borderRadius:"8px",backgroundColor:"var(--bg-secondary)",marginBottom:"2rem"},children:[(0,t.jsx)("h2",{style:{marginTop:0,marginBottom:"1.5rem",fontSize:"1.25rem",fontWeight:600},children:"Asset Information"}),(0,t.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:0},children:[(0,t.jsx)(I,{label:"Asset Number",field:"assetNumber",value:i.assetNumber,readOnly:!0}),(0,t.jsx)(I,{label:"Name",field:"name",value:i.name}),(0,t.jsx)(I,{label:"Type",field:"type",value:i.customAssetType?.name||i.type||"N/A",readOnly:!0}),(0,t.jsx)(I,{label:"Status",field:"status",value:i.status,type:"select",options:[{value:"ACTIVE",label:"Active"},{value:"INACTIVE",label:"Inactive"},{value:"RETIRED",label:"Retired"},{value:"MAINTENANCE",label:"Maintenance"}]}),(0,t.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"150px 1fr auto",gap:"1rem",alignItems:"center",padding:"0.75rem 0",borderBottom:"1px solid var(--border-color)"},children:[(0,t.jsx)("strong",{style:{fontSize:"0.875rem",color:"var(--text-secondary)"},children:"Assigned To:"}),"assignedToId"===b?(0,t.jsxs)("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[(0,t.jsxs)("select",{className:"input",value:j.assignedToId||"",onChange:e=>S({...j,assignedToId:e.target.value}),disabled:d,style:{flex:1,fontSize:"0.875rem",padding:"0.5rem"},children:[(0,t.jsx)("option",{value:"",children:"Unassigned"}),m.filter(e=>"END_USER"===e.role||e.roles?.includes("END_USER")).map(e=>(0,t.jsx)("option",{value:e.id,children:e.firstName||e.lastName?`${e.firstName||""} ${e.lastName||""}`.trim():e.email},e.id))]}),(0,t.jsx)("button",{className:"btn btn-primary",onClick:()=>z("assignedToId"),disabled:d,style:{fontSize:"0.75rem",padding:"0.375rem 0.75rem",whiteSpace:"nowrap"},children:d?"Saving...":"Save"}),(0,t.jsx)("button",{className:"btn btn-secondary",onClick:w,disabled:d,style:{fontSize:"0.75rem",padding:"0.375rem 0.75rem",whiteSpace:"nowrap"},children:"Cancel"})]}):(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,t.jsx)("span",{style:{fontSize:"0.875rem",flex:1},children:i.assignedTo?`${i.assignedTo.firstName||""} ${i.assignedTo.lastName||""}`.trim()||i.assignedTo.email:"Unassigned"}),(0,t.jsx)("button",{onClick:()=>$("assignedToId",i.assignedTo?.id||""),style:{padding:"0.25rem 0.5rem",fontSize:"0.75rem",backgroundColor:"transparent",border:"1px solid var(--border-color)",borderRadius:"4px",color:"var(--accent-primary)",cursor:"pointer"},children:"Edit"})]})]})]})]}),B.length>0&&(0,t.jsxs)("div",{style:{padding:"1.5rem",border:"1px solid var(--border-color)",borderRadius:"8px",backgroundColor:"var(--bg-secondary)",marginBottom:"2rem"},children:[(0,t.jsxs)("h2",{style:{marginTop:0,marginBottom:"1.5rem",fontSize:"1.25rem",fontWeight:600},children:[i.customAssetType?.name," Fields"]}),(0,t.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:0},children:B.sort((e,t)=>e.order-t.order).map(e=>{let r=`customField_${e.fieldName}`,s=b===r,a=k[e.fieldName];return(0,t.jsx)("div",{style:{padding:"0.75rem 0",borderBottom:"1px solid var(--border-color)"},children:(0,t.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"150px 1fr auto",gap:"1rem",alignItems:"center"},children:[(0,t.jsxs)("strong",{style:{fontSize:"0.875rem",color:"var(--text-secondary)"},children:[e.label,e.required&&(0,t.jsx)("span",{style:{color:"var(--error)"},children:" *"})]}),s?(0,t.jsxs)("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[(0,t.jsx)("div",{style:{flex:1},children:((e,r,s)=>{if(!s)return null;switch(e.fieldType){case"textarea":return(0,t.jsx)("textarea",{className:"input",value:j[`customField_${e.fieldName}`]||r||"",onChange:t=>S({...j,[`customField_${e.fieldName}`]:t.target.value}),disabled:d,rows:4,style:{fontSize:"0.875rem",padding:"0.5rem"}});case"select":let a=Array.isArray(e.options)?e.options:[];return(0,t.jsxs)("select",{className:"input",value:j[`customField_${e.fieldName}`]||r||"",onChange:t=>S({...j,[`customField_${e.fieldName}`]:t.target.value}),disabled:d,style:{fontSize:"0.875rem",padding:"0.5rem"},children:[(0,t.jsx)("option",{value:"",children:"Select..."}),a.map((e,r)=>(0,t.jsx)("option",{value:e,children:e},r))]});case"checkbox":let i=Array.isArray(e.options)?e.options:[],l=Array.isArray(j[`customField_${e.fieldName}`]||r)?j[`customField_${e.fieldName}`]||r:[];return(0,t.jsx)("div",{children:i.map((r,s)=>(0,t.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.5rem"},children:[(0,t.jsx)("input",{type:"checkbox",checked:l.includes(r),onChange:t=>{let s=t.target.checked?[...l,r]:l.filter(e=>e!==r);S({...j,[`customField_${e.fieldName}`]:s})},disabled:d}),r]},s))});case"date":return(0,t.jsx)("input",{type:"date",className:"input",value:j[`customField_${e.fieldName}`]||(r?new Date(r).toISOString().split("T")[0]:""),onChange:t=>S({...j,[`customField_${e.fieldName}`]:t.target.value?new Date(t.target.value).toISOString():""}),disabled:d,style:{fontSize:"0.875rem",padding:"0.5rem"}});case"number":return(0,t.jsx)("input",{type:"number",className:"input",value:j[`customField_${e.fieldName}`]||r||"",onChange:t=>S({...j,[`customField_${e.fieldName}`]:t.target.value}),disabled:d,style:{fontSize:"0.875rem",padding:"0.5rem"}});default:return(0,t.jsx)("input",{type:"text",className:"input",value:j[`customField_${e.fieldName}`]||r||"",onChange:t=>S({...j,[`customField_${e.fieldName}`]:t.target.value}),disabled:d,style:{fontSize:"0.875rem",padding:"0.5rem"}})}})(e,a,!0)}),(0,t.jsx)("button",{className:"btn btn-primary",onClick:()=>z(r),disabled:d,style:{fontSize:"0.75rem",padding:"0.375rem 0.75rem",whiteSpace:"nowrap"},children:d?"Saving...":"Save"}),(0,t.jsx)("button",{className:"btn btn-secondary",onClick:w,disabled:d,style:{fontSize:"0.75rem",padding:"0.375rem 0.75rem",whiteSpace:"nowrap"},children:"Cancel"})]}):(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,t.jsx)("span",{style:{fontSize:"0.875rem",flex:1},children:"checkbox"===e.fieldType&&Array.isArray(a)?a.join(", "):"date"===e.fieldType&&a?new Date(a).toLocaleDateString():a||"Not set"}),(0,t.jsx)("button",{onClick:()=>$(r,a),style:{padding:"0.25rem 0.5rem",fontSize:"0.75rem",backgroundColor:"transparent",border:"1px solid var(--border-color)",borderRadius:"4px",color:"var(--accent-primary)",cursor:"pointer"},children:"Edit"})]})]})},e.id)})})]}),i.relationships&&i.relationships.length>0||i.relatedAssets&&i.relatedAssets.length>0?(0,t.jsxs)("div",{style:{padding:"1.5rem",border:"1px solid var(--border-color)",borderRadius:"8px",backgroundColor:"var(--bg-secondary)",marginBottom:"2rem"},children:[(0,t.jsx)("h2",{style:{marginTop:0,marginBottom:"1rem",fontSize:"1.25rem",fontWeight:600},children:"Relationships"}),(0,t.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[i.relationships?.map(e=>(0,t.jsxs)("div",{style:{padding:"0.75rem",backgroundColor:"var(--bg-primary)",borderRadius:"4px"},children:[(0,t.jsxs)("strong",{style:{fontSize:"0.875rem"},children:[e.relationshipType,":"]})," ",(0,t.jsxs)(a.default,{href:`/assets/${e.targetAsset.id}`,style:{color:"var(--accent-primary)",textDecoration:"none"},children:[e.targetAsset.assetNumber," - ",e.targetAsset.name]})]},e.id)),i.relatedAssets?.map(e=>(0,t.jsxs)("div",{style:{padding:"0.75rem",backgroundColor:"var(--bg-primary)",borderRadius:"4px"},children:[(0,t.jsxs)("strong",{style:{fontSize:"0.875rem"},children:[e.relationshipType,":"]})," ",(0,t.jsxs)(a.default,{href:`/assets/${e.sourceAsset.id}`,style:{color:"var(--accent-primary)",textDecoration:"none"},children:[e.sourceAsset.assetNumber," - ",e.sourceAsset.name]})]},e.id))]})]}):null,y.length>0&&(0,t.jsxs)("div",{style:{padding:"1.5rem",border:"1px solid var(--border-color)",borderRadius:"8px",backgroundColor:"var(--bg-secondary)",marginBottom:"2rem"},children:[(0,t.jsx)("h2",{style:{marginTop:0,marginBottom:"1rem",fontSize:"1.25rem",fontWeight:600},children:"Related Tickets"}),(0,t.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:y.map(e=>(0,t.jsxs)("div",{style:{padding:"0.75rem",border:"1px solid var(--border-color)",borderRadius:"4px",backgroundColor:"var(--bg-primary)"},children:[(0,t.jsxs)(a.default,{href:`/tickets/${e.id}`,style:{color:"var(--accent-primary)",textDecoration:"none",fontWeight:500},children:[e.ticketNumber," - ",e.subject]}),(0,t.jsxs)("div",{style:{fontSize:"0.8125rem",color:"var(--text-secondary)",marginTop:"0.25rem"},children:["Status: ",e.status," | Priority: ",e.priority," | Created: ",new Date(e.createdAt).toLocaleDateString()]})]},e.id))})]}),(0,t.jsxs)("div",{style:{padding:"1.5rem",border:"1px solid var(--border-color)",borderRadius:"8px",backgroundColor:"var(--bg-secondary)",marginBottom:"2rem"},children:[(0,t.jsx)("h2",{style:{marginTop:0,marginBottom:"1.5rem",fontSize:"1.25rem",fontWeight:600},children:"Change History"}),h?(0,t.jsx)("div",{style:{padding:"2rem",textAlign:"center",color:"var(--text-secondary)"},children:"Loading history..."}):g.length>0?(0,t.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:g.map(e=>(0,t.jsxs)("div",{style:{padding:"1rem",border:"1px solid var(--border-color)",borderRadius:"6px",backgroundColor:"var(--bg-primary)"},children:[(0,t.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start",marginBottom:"0.5rem"},children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("strong",{style:{fontSize:"0.9375rem",color:"var(--text-primary)"},children:e.eventType.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())}),(0,t.jsxs)("div",{style:{fontSize:"0.8125rem",color:"var(--text-secondary)",marginTop:"0.25rem"},children:["By: ",e.user?.firstName||e.user?.lastName?`${e.user.firstName||""} ${e.user.lastName||""}`.trim():e.userEmail]})]}),(0,t.jsx)("span",{style:{fontSize:"0.8125rem",color:"var(--text-secondary)",whiteSpace:"nowrap"},children:new Date(e.createdAt).toLocaleString()})]}),(0,t.jsx)("div",{style:{fontSize:"0.875rem",color:"var(--text-primary)",marginTop:"0.5rem",padding:"0.75rem",backgroundColor:"var(--bg-secondary)",borderRadius:"4px"},children:(e=>{if(!e.metadata)return e.description;let t=e.metadata;if("ASSET_ASSIGNED"===e.eventType&&(t.oldAssigneeId||t.newAssigneeId)){let e=t.oldAssigneeId?m.find(e=>e.id===t.oldAssigneeId):null,r=t.newAssigneeId?m.find(e=>e.id===t.newAssigneeId):null,s=e?e.firstName||e.lastName?`${e.firstName||""} ${e.lastName||""}`.trim():e.email:"Unassigned",a=r?r.firstName||r.lastName?`${r.firstName||""} ${r.lastName||""}`.trim():r.email:"Unassigned";return`Assignment changed from "${s}" to "${a}"`}if(t.changes&&"object"==typeof t.changes){let e=[];if(Object.keys(t.changes).forEach(r=>{let s=t.changes[r];if(s&&"object"==typeof s&&"old"in s&&"new"in s){let t=null===s.old||void 0===s.old?"empty":String(s.old),a=null===s.new||void 0===s.new?"empty":String(s.new),i=r.replace(/([A-Z])/g," $1").replace(/^./,e=>e.toUpperCase()).trim();e.push(`${i}: "${t}" → "${a}"`)}else if(null!=s){let t=i&&void 0!==i[r]?String(i[r]):"empty",a=String(s),l=r.replace(/([A-Z])/g," $1").replace(/^./,e=>e.toUpperCase()).trim();t!==a&&e.push(`${l}: "${t}" → "${a}"`)}}),e.length>0)return e.join(" | ")}return e.description})(e)})]},e.id))}):(0,t.jsx)("div",{style:{padding:"2rem",textAlign:"center",color:"var(--text-secondary)"},children:"No history available"})]})]})}e.s(["default",()=>i])}]);