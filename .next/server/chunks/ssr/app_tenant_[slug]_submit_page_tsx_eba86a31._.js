module.exports=[70158,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(38246);function f(){let a=(0,d.useParams)(),f=(0,d.useRouter)(),g=a?.slug,[h,i]=(0,c.useState)(null),[j,k]=(0,c.useState)(!0),[l,m]=(0,c.useState)(!1),[n,o]=(0,c.useState)(""),[p,q]=(0,c.useState)(!1),[r,s]=(0,c.useState)(""),[t,u]=(0,c.useState)(!1),[v,w]=(0,c.useState)(null),[x,y]=(0,c.useState)({name:"",email:"",category:"",subject:"",description:"",customFields:{}});(0,c.useEffect)(()=>{let a=localStorage.getItem("accessToken"),b=localStorage.getItem("user");if(u(!!a),b)try{let a=JSON.parse(b);w(a),y(b=>({...b,name:a.firstName&&a.lastName?`${a.firstName} ${a.lastName}`:a.email?.split("@")[0]||"",email:a.email||""}))}catch(a){}z()},[g]);let z=async()=>{try{k(!0);let a=await fetch(`/api/v1/tenants/${g}`),b=await a.json();b.success?(i(b.data),b.data.requiresLogin&&!t&&f.push(`/login?redirect=/tenant/${g}/submit`)):o(b.error?.message||"Tenant not found")}catch(a){o("Failed to load tenant")}finally{k(!1)}},A=async a=>{a.preventDefault(),m(!0),o("");try{let a=localStorage.getItem("accessToken"),b=localStorage.getItem("publicToken"),c={"Content-Type":"application/json"};if(a)c.Authorization=`Bearer ${a}`;else if(b)c.Authorization=`Bearer ${b}`;else{let a=await fetch("/api/v1/public/token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tenantId:h?.id})}),b=await a.json();b.success&&(localStorage.setItem("publicToken",b.data.token),localStorage.setItem("publicTokenId",b.data.publicId),c.Authorization=`Bearer ${b.data.token}`)}let d=await fetch(`/api/v1/tenants/${g}/tickets`,{method:"POST",headers:c,body:JSON.stringify({subject:x.subject,description:x.description,category:x.category,name:x.name,email:x.email,customFields:x.customFields})}),e=await d.json();e.success?(s(e.data.ticketNumber),q(!0)):o(e.error?.message||"Failed to submit ticket")}catch(a){o("An unexpected error occurred")}finally{m(!1)}};return j?(0,b.jsx)("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,b.jsx)("p",{children:"Loading..."})}):n&&!h?(0,b.jsx)("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,b.jsxs)("div",{style:{textAlign:"center"},children:[(0,b.jsx)("h1",{style:{fontSize:"2rem",marginBottom:"1rem"},children:"Tenant Not Found"}),(0,b.jsx)("p",{style:{color:"var(--text-secondary)"},children:n})]})}):p?(0,b.jsx)("div",{style:{minHeight:"100vh",backgroundColor:"var(--bg-primary)",color:"var(--text-primary)"},children:(0,b.jsx)("div",{style:{maxWidth:"800px",margin:"0 auto",padding:"4rem 2rem",textAlign:"center"},children:(0,b.jsxs)("div",{style:{padding:"2rem",backgroundColor:"var(--bg-secondary)",borderRadius:"12px",border:"1px solid var(--border-color)"},children:[(0,b.jsx)("h1",{style:{fontSize:"2rem",marginBottom:"1rem",color:"var(--success)"},children:"Ticket Submitted!"}),(0,b.jsx)("p",{style:{fontSize:"1.25rem",marginBottom:"0.5rem"},children:"Your ticket number is:"}),(0,b.jsx)("p",{style:{fontSize:"1.5rem",fontWeight:600,color:"var(--accent-primary)",marginBottom:"2rem"},children:r}),(0,b.jsx)("p",{style:{color:"var(--text-secondary)",marginBottom:"2rem"},children:"We've received your request and will get back to you soon."}),(0,b.jsx)("div",{style:{display:"flex",gap:"1rem",justifyContent:"center"},children:(0,b.jsx)(e.default,{href:`/tenant/${g}`,style:{padding:"0.75rem 1.5rem",backgroundColor:"var(--accent-primary)",color:"white",textDecoration:"none",borderRadius:"8px",fontWeight:600},children:"Back to Home"})})]})})}):(0,b.jsx)("div",{style:{minHeight:"100vh",backgroundColor:"var(--bg-primary)",color:"var(--text-primary)"},children:(0,b.jsxs)("div",{style:{maxWidth:"800px",margin:"0 auto",padding:"2rem"},children:[(0,b.jsx)(e.default,{href:`/tenant/${g}`,style:{color:"var(--text-secondary)",textDecoration:"none",marginBottom:"2rem",display:"inline-block"},children:"â† Back"}),(0,b.jsx)("h1",{style:{fontSize:"2rem",marginBottom:"2rem"},children:"Submit a Support Ticket"}),n&&(0,b.jsx)("div",{style:{padding:"1rem",backgroundColor:"rgba(239, 68, 68, 0.1)",color:"var(--error)",borderRadius:"8px",marginBottom:"1.5rem"},children:n}),(0,b.jsxs)("form",{onSubmit:A,style:{display:"grid",gap:"1.5rem"},children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:500},children:"Name *"}),(0,b.jsx)("input",{type:"text",required:!0,value:x.name,onChange:a=>y({...x,name:a.target.value}),disabled:t,style:{width:"100%",padding:"0.75rem",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--bg-primary)",color:"var(--text-primary)",opacity:t?.6:1}})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:500},children:"Email *"}),(0,b.jsx)("input",{type:"email",required:!0,value:x.email,onChange:a=>y({...x,email:a.target.value}),disabled:t,style:{width:"100%",padding:"0.75rem",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--bg-primary)",color:"var(--text-primary)",opacity:t?.6:1}})]}),h&&h.categories.length>0&&(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:500},children:"Category *"}),(0,b.jsxs)("select",{required:!0,value:x.category,onChange:a=>y({...x,category:a.target.value}),style:{width:"100%",padding:"0.75rem",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--bg-primary)",color:"var(--text-primary)"},children:[(0,b.jsx)("option",{value:"",children:"Select a category..."}),h.categories.map(a=>(0,b.jsx)("option",{value:a,children:a},a))]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:500},children:"Subject *"}),(0,b.jsx)("input",{type:"text",required:!0,value:x.subject,onChange:a=>y({...x,subject:a.target.value}),placeholder:"Brief description of your issue",style:{width:"100%",padding:"0.75rem",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--bg-primary)",color:"var(--text-primary)"}})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:500},children:"Description *"}),(0,b.jsx)("textarea",{required:!0,value:x.description,onChange:a=>y({...x,description:a.target.value}),placeholder:"Please provide details about your issue...",rows:6,style:{width:"100%",padding:"0.75rem",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--bg-primary)",color:"var(--text-primary)"}})]}),h&&h.customFields.map(a=>(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:500},children:[a.label," ",a.required&&"*"]}),(a=>{switch(a.fieldType){case"TEXT":case"EMAIL":case"PHONE":return(0,b.jsx)("input",{type:"EMAIL"===a.fieldType?"email":"PHONE"===a.fieldType?"tel":"text",required:a.required,value:x.customFields[a.id]||"",onChange:b=>y({...x,customFields:{...x.customFields,[a.id]:b.target.value}}),placeholder:a.placeholder,style:{width:"100%",padding:"0.75rem",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--bg-primary)",color:"var(--text-primary)"}});case"TEXTAREA":return(0,b.jsx)("textarea",{required:a.required,value:x.customFields[a.id]||"",onChange:b=>y({...x,customFields:{...x.customFields,[a.id]:b.target.value}}),placeholder:a.placeholder,rows:4,style:{width:"100%",padding:"0.75rem",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--bg-primary)",color:"var(--text-primary)"}});case"NUMBER":return(0,b.jsx)("input",{type:"number",required:a.required,value:x.customFields[a.id]||"",onChange:b=>y({...x,customFields:{...x.customFields,[a.id]:b.target.value}}),placeholder:a.placeholder,style:{width:"100%",padding:"0.75rem",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--bg-primary)",color:"var(--text-primary)"}});case"DATE":return(0,b.jsx)("input",{type:"date",required:a.required,value:x.customFields[a.id]||"",onChange:b=>y({...x,customFields:{...x.customFields,[a.id]:b.target.value}}),style:{width:"100%",padding:"0.75rem",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--bg-primary)",color:"var(--text-primary)"}});case"SELECT":return(0,b.jsxs)("select",{required:a.required,value:x.customFields[a.id]||"",onChange:b=>y({...x,customFields:{...x.customFields,[a.id]:b.target.value}}),style:{width:"100%",padding:"0.75rem",borderRadius:"8px",border:"1px solid var(--border-color)",backgroundColor:"var(--bg-primary)",color:"var(--text-primary)"},children:[(0,b.jsx)("option",{value:"",children:"Select an option..."}),a.options?.map(a=>(0,b.jsx)("option",{value:a,children:a},a))]});case"CHECKBOX":return(0,b.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer"},children:[(0,b.jsx)("input",{type:"checkbox",checked:x.customFields[a.id]||!1,onChange:b=>y({...x,customFields:{...x.customFields,[a.id]:b.target.checked}}),style:{width:"18px",height:"18px"}}),(0,b.jsx)("span",{children:a.placeholder||"Yes"})]});default:return null}})(a)]},a.id)),(0,b.jsxs)("div",{style:{display:"flex",gap:"1rem",marginTop:"1rem"},children:[(0,b.jsx)("button",{type:"submit",disabled:l,style:{padding:"0.75rem 1.5rem",backgroundColor:"var(--accent-primary)",color:"white",border:"none",borderRadius:"8px",cursor:l?"not-allowed":"pointer",fontSize:"0.875rem",fontWeight:600,opacity:l?.6:1},children:l?"Submitting...":"Submit Ticket"}),(0,b.jsx)(e.default,{href:`/tenant/${g}`,style:{padding:"0.75rem 1.5rem",backgroundColor:"var(--bg-tertiary)",color:"var(--text-primary)",textDecoration:"none",borderRadius:"8px",fontSize:"0.875rem",display:"inline-block"},children:"Cancel"})]})]})]})})}a.s(["default",()=>f])}];

//# sourceMappingURL=app_tenant_%5Bslug%5D_submit_page_tsx_eba86a31._.js.map