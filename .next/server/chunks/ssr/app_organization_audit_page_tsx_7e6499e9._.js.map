{"version":3,"sources":["../../../../app/organization/audit/page.tsx"],"sourcesContent":["'use client'\n\nimport { useEffect, useState, Suspense } from 'react'\nimport { useSearchParams } from 'next/navigation'\n\ninterface AuditLog {\n  id: string\n  eventType: string\n  entityType: string\n  entityId?: string\n  userId: string\n  userEmail: string\n  description: string\n  metadata?: any\n  ipAddress?: string\n  userAgent?: string\n  createdAt: string\n  user: {\n    id: string\n    email: string\n    firstName?: string\n    lastName?: string\n  }\n  organization?: {\n    id: string\n    name: string\n  }\n}\n\nfunction AuditLogPageContent() {\n  const searchParams = useSearchParams()\n  const organizationId = searchParams.get('organizationId')\n\n  const [logs, setLogs] = useState<AuditLog[]>([])\n  const [loading, setLoading] = useState(true)\n  const [error, setError] = useState('')\n  const [page, setPage] = useState(1)\n  const [totalPages, setTotalPages] = useState(1)\n  const [filters, setFilters] = useState({\n    eventType: '',\n    entityType: '',\n    startDate: '',\n    endDate: '',\n  })\n\n  useEffect(() => {\n    fetchLogs()\n  }, [page, filters, organizationId])\n\n  const fetchLogs = async () => {\n    try {\n      const token = localStorage.getItem('accessToken')\n      const params = new URLSearchParams({\n        page: page.toString(),\n        limit: '50',\n      })\n\n      if (organizationId) {\n        params.append('organizationId', organizationId)\n      }\n      if (filters.eventType) {\n        params.append('eventType', filters.eventType)\n      }\n      if (filters.entityType) {\n        params.append('entityType', filters.entityType)\n      }\n      if (filters.startDate) {\n        params.append('startDate', filters.startDate)\n      }\n      if (filters.endDate) {\n        params.append('endDate', filters.endDate)\n      }\n\n      const response = await fetch(`/api/v1/organizations/audit?${params.toString()}`, {\n        headers: {\n          Authorization: `Bearer ${token}`,\n        },\n      })\n\n      if (!response.ok) {\n        throw new Error('Failed to fetch audit logs')\n      }\n\n      const data = await response.json()\n      setLogs(data.logs)\n      setTotalPages(data.pagination.totalPages)\n    } catch (err: any) {\n      setError(err.message)\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const handleFilterChange = (key: string, value: string) => {\n    setFilters({ ...filters, [key]: value })\n    setPage(1)\n  }\n\n  if (loading) {\n    return <div>Loading audit logs...</div>\n  }\n\n  return (\n    <div style={{ padding: '2rem' }}>\n      <h1 style={{ marginBottom: '2rem' }}>Audit Logs</h1>\n\n      {error && (\n        <div\n          style={{\n            padding: '0.75rem',\n            backgroundColor: 'rgba(239, 68, 68, 0.1)',\n            border: '1px solid var(--error)',\n            borderRadius: '0.5rem',\n            marginBottom: '1rem',\n            color: 'var(--error)',\n          }}\n        >\n          {error}\n        </div>\n      )}\n\n      <div className=\"card\" style={{ padding: '1.5rem', marginBottom: '1.5rem' }}>\n        <h3 style={{ marginBottom: '1rem' }}>Filters</h3>\n        <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: '1rem' }}>\n          <div>\n            <label className=\"label\" htmlFor=\"eventType\">\n              Event Type\n            </label>\n            <input\n              id=\"eventType\"\n              type=\"text\"\n              className=\"input\"\n              value={filters.eventType}\n              onChange={(e) => handleFilterChange('eventType', e.target.value)}\n              placeholder=\"e.g., USER_CREATED\"\n            />\n          </div>\n          <div>\n            <label className=\"label\" htmlFor=\"entityType\">\n              Entity Type\n            </label>\n            <input\n              id=\"entityType\"\n              type=\"text\"\n              className=\"input\"\n              value={filters.entityType}\n              onChange={(e) => handleFilterChange('entityType', e.target.value)}\n              placeholder=\"e.g., User, Ticket\"\n            />\n          </div>\n          <div>\n            <label className=\"label\" htmlFor=\"startDate\">\n              Start Date\n            </label>\n            <input\n              id=\"startDate\"\n              type=\"date\"\n              className=\"input\"\n              value={filters.startDate}\n              onChange={(e) => handleFilterChange('startDate', e.target.value)}\n            />\n          </div>\n          <div>\n            <label className=\"label\" htmlFor=\"endDate\">\n              End Date\n            </label>\n            <input\n              id=\"endDate\"\n              type=\"date\"\n              className=\"input\"\n              value={filters.endDate}\n              onChange={(e) => handleFilterChange('endDate', e.target.value)}\n            />\n          </div>\n        </div>\n      </div>\n\n      <div className=\"card\" style={{ padding: '1.5rem' }}>\n        <div style={{ overflowX: 'auto' }}>\n          <table style={{ width: '100%', borderCollapse: 'collapse' }}>\n            <thead>\n              <tr style={{ borderBottom: '1px solid var(--border)' }}>\n                <th style={{ padding: '0.75rem', textAlign: 'left' }}>Date</th>\n                <th style={{ padding: '0.75rem', textAlign: 'left' }}>Event</th>\n                <th style={{ padding: '0.75rem', textAlign: 'left' }}>Entity</th>\n                <th style={{ padding: '0.75rem', textAlign: 'left' }}>User</th>\n                <th style={{ padding: '0.75rem', textAlign: 'left' }}>Description</th>\n                <th style={{ padding: '0.75rem', textAlign: 'left' }}>IP Address</th>\n              </tr>\n            </thead>\n            <tbody>\n              {logs.map((log) => (\n                <tr key={log.id} style={{ borderBottom: '1px solid var(--border)' }}>\n                  <td style={{ padding: '0.75rem', fontSize: '0.875rem' }}>\n                    {new Date(log.createdAt).toLocaleString()}\n                  </td>\n                  <td style={{ padding: '0.75rem', fontSize: '0.875rem' }}>\n                    <code style={{ fontSize: '0.75rem' }}>{log.eventType}</code>\n                  </td>\n                  <td style={{ padding: '0.75rem', fontSize: '0.875rem' }}>\n                    {log.entityType}\n                    {log.entityId && (\n                      <span style={{ color: 'var(--text-secondary)', marginLeft: '0.5rem' }}>\n                        ({log.entityId.slice(0, 8)}...)\n                      </span>\n                    )}\n                  </td>\n                  <td style={{ padding: '0.75rem', fontSize: '0.875rem' }}>\n                    {log.user.firstName} {log.user.lastName}\n                    <div style={{ fontSize: '0.75rem', color: 'var(--text-secondary)' }}>\n                      {log.userEmail}\n                    </div>\n                  </td>\n                  <td style={{ padding: '0.75rem', fontSize: '0.875rem' }}>{log.description}</td>\n                  <td style={{ padding: '0.75rem', fontSize: '0.875rem', fontFamily: 'monospace' }}>\n                    {log.ipAddress || '-'}\n                  </td>\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        </div>\n\n        {logs.length === 0 && (\n          <div style={{ textAlign: 'center', padding: '3rem', color: 'var(--text-secondary)' }}>\n            No audit logs found\n          </div>\n        )}\n\n        {totalPages > 1 && (\n          <div style={{ display: 'flex', justifyContent: 'center', gap: '0.5rem', marginTop: '1.5rem' }}>\n            <button\n              className=\"btn\"\n              onClick={() => setPage((p) => Math.max(1, p - 1))}\n              disabled={page === 1}\n            >\n              Previous\n            </button>\n            <span style={{ display: 'flex', alignItems: 'center', padding: '0 1rem' }}>\n              Page {page} of {totalPages}\n            </span>\n            <button\n              className=\"btn\"\n              onClick={() => setPage((p) => Math.min(totalPages, p + 1))}\n              disabled={page === totalPages}\n            >\n              Next\n            </button>\n          </div>\n        )}\n      </div>\n    </div>\n  )\n}\n\nexport default function AuditLogPage() {\n  return (\n    <Suspense fallback={<div>Loading audit logs...</div>}>\n      <AuditLogPageContent />\n    </Suspense>\n  )\n}\n\n"],"names":[],"mappings":"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"}